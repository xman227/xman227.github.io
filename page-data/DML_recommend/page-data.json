{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/DML_recommend/",
    "result": {"data":{"cur":{"id":"90600ba1-cdb3-50fe-ae9b-1fd1818b5dac","html":"<h1 id=\"-deep-learning-ì´ìš©-ë¶„ì•¼----ì¶”ì²œ-ì‹œìŠ¤í…œ\" style=\"position:relative;\"><a href=\"#-deep-learning-%EC%9D%B4%EC%9A%A9-%EB%B6%84%EC%95%BC----%EC%B6%94%EC%B2%9C-%EC%8B%9C%EC%8A%A4%ED%85%9C\" aria-label=\" deep learning ì´ìš© ë¶„ì•¼    ì¶”ì²œ ì‹œìŠ¤í…œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ¤´ Deep Learning ì´ìš© ë¶„ì•¼  - ì¶”ì²œ ì‹œìŠ¤í…œ</h1>\n<p>ë‚´ êµ¬ê¸€ ì•„ì´ë””ë¡œ ë¡œê·¸ì¸ í•œ ë‹¤ìŒ ìœ íŠœë¸Œì— ë“¤ì–´ê°€ë©´<br>\në‚´ê°€ ë³´ê³ ì‹¶ì€ ì˜ìƒë“¤ì„ ë„ˆë¬´ ëˆ„ë¥´ê³  ì‹¶ê²Œ ë³´ì—¬ì¤€ë‹¤</p>\n<p><img src=\"/c143663df037eb752f1d697589210631/youtube.png\" alt=\"youtube.PNG\"></p>\n<p>ë‹¨ìˆœí•˜ê²Œ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤.</p>\n<p><strong>ì•„, ë‚´ê°€ ì§€ê¸ˆê¹Œì§€ ë´¤ë˜ ì˜ìƒë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ë‚´ê°€ ë³´ê³ ì‹¶ì–´í•  ì˜ìƒì„ ë„ì›Œì£¼ëŠ”êµ¬ë‚˜.</strong></p>\n<p>ì—¬ê¸°ì„œ</p>\n<blockquote>\n<p>ë´¤ë˜ ì˜ìƒë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ</p>\n</blockquote>\n<p>ì—ì„œ ë”¥ëŸ¬ë‹ ê¸°ë²•ì´ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.</p>\n<hr>\n<h1 id=\"1-ì¶”ì²œì‹œìŠ¤í…œì´ë€\" style=\"position:relative;\"><a href=\"#1-%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%B4%EB%9E%80\" aria-label=\"1 ì¶”ì²œì‹œìŠ¤í…œì´ë€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ì¶”ì²œì‹œìŠ¤í…œì´ë€?</h1>\n<p>ì—…ê³„ ë‚´ ìš©ì–´ë¥¼ ë¹Œë¦¬ìë©´</p>\n<p><code class=\"language-text\">user</code> ì—ê²Œ <code class=\"language-text\">item</code> ì„ ì œê³µí•˜ëŠ” ì‹œìŠ¤í…œ.</p>\n<p>ìš°ë¦¬ëŠ” <code class=\"language-text\">user</code> ì˜ ì •ë³´ì™€  <code class=\"language-text\">item</code> ì˜ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤</p>\n<p>ì˜ˆë¥¼ ë“¤ì–´ user ì„±ë¯¼ ì´ ìˆë‹¤ê³  í•œë‹¤ë©´</p>\n<blockquote>\n<p>ì„±ë¯¼ : 25ì‚´ / ë‚¨ì„± / ì¸ì²œ / í•™ìƒ / ì¸ë””ìŒì•…ì„ í˜¸</p>\n</blockquote>\n<p>ì•„ë¬´ë¦¬ ê°„ë‹¨í•´ë„ ë‚˜ì´, ì„±ë³„, ì§€ì—­ ë“± ì—¬ëŸ¬ ê°œì˜ ì •ë³´ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.</p>\n<p>item â€˜Star is Bornâ€™ ì´ë¼ëŠ” ì˜í™”ê°€ ìˆë‹¤ê³  í•œë‹¤ë©´</p>\n<blockquote>\n<p>â€˜Star is Bornâ€™ : ì¸ê¸°ë„ 5 / ì•¡ì…˜ë„ 5 / ë¡œë§¨ìŠ¤ 8 / ìŒì•… 10 / ë¦¬ë·°í‰ì   4.5 /</p>\n</blockquote>\n<p>ë“±ì˜ ì •ë³´ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.</p>\n<p>ì´ user ì™€ item ì˜ ì •ë³´ë¥¼ ìˆ˜ì¹˜í™”(vectorize) ì‹œì¼œ ìœ ì‚¬ë„(similarity) ë¥¼ íŒë‹¨í•œ í›„<br>\nìœ ì‚¬ë„ê°€ ë†’ì€ ê²ƒì„ ì œê³µí•˜ëŠ” ê²ƒ.</p>\n<p>ì´ê²ƒì´ ë°”ë¡œ ì¶”ì²œì‹œìŠ¤í…œì´ë‹¤.</p>\n<p>ì—? ë„ˆë¬´ ì‰½ì§€ ì•Šëƒê³ ? ì´ê²Œ êµ³ì´ ë”¥ëŸ¬ë‹ì´ í•„ìš”í•˜ëƒê³ ?<br>\nì´ê±´ ì •ë§ì •ë§ ë‹¨ìˆœí•˜ê²Œ ë§í•œê±°ë‹¤.</p>\n<p>ìš°ë¦¬ëŠ” 2ì°¨ì› í‰ë©´ ìƒì—ì„œ ë‘ ì  ê°„ì˜ ê±°ë¦¬ë¥¼ êµ¬í•˜ëŠ” ë°©ë²•ì„ ì•Œê³  ìˆë‹¤.<br>\nì‰½ì–ì•„.</p>\n<p>$x = (a_1,a_2)$ ,  $y = (b_1,b_2)$\nì¼ ë•Œ,</p>\n<p>$\\sqrt{(b_1-a_1)^2 +(b_2-b_1)^2}$</p>\n<p>ì ê·¸ë ‡ë‹¤ë©´ 3ì°¨ì›ì€? 4ì°¨ì›ì€?\nì ì´ë˜ì„œ ë”¥ëŸ¬ë‹ì´ í•„ìš”í•œ ê²ƒì´ë‹¤.</p>\n<h2 id=\"1-1-ìœ ì‚¬ë„-similarity-ì¸¡ì •-ë°©ë²•\" style=\"position:relative;\"><a href=\"#1-1-%EC%9C%A0%EC%82%AC%EB%8F%84-similarity-%EC%B8%A1%EC%A0%95-%EB%B0%A9%EB%B2%95\" aria-label=\"1 1 ìœ ì‚¬ë„ similarity ì¸¡ì • ë°©ë²• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1-1. ìœ ì‚¬ë„ Similarity ì¸¡ì • ë°©ë²•</h2>\n<p>ë‹¤ì–‘í•œ ìœ ì‚¬ë„ ì¸¡ì • ë°©ë²•ì´ ì¡´ì¬í•œë‹¤.</p>\n<ol>\n<li>ìœ í´ë¦¬ë“œ ê±°ë¦¬ ê³„ì‚°ë²•</li>\n<li>ìì¹´ë“œ ìœ ì‚¬ë„</li>\n<li>í”¼ì–´ìŠ¨ ìƒê´€ê³„ìˆ˜</li>\n<li>ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ì¸¡ì •ë²•</li>\n</ol>\n<p>ê·¸ ì¤‘ í•˜ë‚˜ì¸ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ì¸¡ì •ë²•ì„ ê°„ë‹¨íˆ ì„¤ëª…í•´ ë³¸ë‹¤.</p>\n<p>ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ì¸¡ì •ë²•ì€ ìˆ˜í•™ì‹œê°„ì— ë°°ìš´ ì½”ì‚¬ì¸ì„ í†µí•´\në²¡í„° ê°„ ë‚´ì ìœ¼ë¡œ ë‘ ì  ê°„ì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤.\n<img src=\"/d8784b6fb17a521cad3fc070adc7a943/cos.png\" alt=\"cos.PNG\"></p>\n<p>ë‘ ì  ê°„ì˜ ë²¡í„°ê°’ì„ êµ¬í•œ ë’¤</p>\n<p>ë°©í–¥ì´ ì™„ì „íˆ ë™ì¼í•œ ê²½ìš°ëŠ” 1,<br>\n90ë„ì¸ ê²½ìš°ëŠ” 0.<br>\nì •ë°˜ëŒ€ ë°©í–¥ì¸ ê²½ìš°ëŠ” -1 ì¸ ì ì—ì„œ ì°©ì•ˆí•´</p>\n<p>-1 ì—ì„œ 1 ì‚¬ì´ì˜ ê°’ì„ êµ¬í•´ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.</p>\n<p>ì˜ˆë¥¼ ë“¤ì–´</p>\n<p>$ a=(1,1,1)$ $b=(2,0,1)$<br>\nì´ë¼ í•  ë•Œ,</p>\n<p>ë²¡í„°ê°„ ë‚´ì ì„ í†µí•´ ìœ ì‚¬ë„ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</p>\n<p><img scr=\"./similarity.PNG\"></img></p>\n<p><img src=\"/832a27657055531c63b295a011d26b31/similarity.gif\" alt=\"similarity.gif\"></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">from</span> numpy <span class=\"token keyword\">import</span> dot\n<span class=\"token keyword\">from</span> numpy<span class=\"token punctuation\">.</span>linalg <span class=\"token keyword\">import</span> norm\n\na <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nb <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">cos_sim</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\">#cos simmilarlity</span>\n    <span class=\"token keyword\">return</span> dot<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> B<span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token punctuation\">(</span>norm<span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span><span class=\"token operator\">*</span>norm<span class=\"token punctuation\">(</span>B<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ncos_sim<span class=\"token punctuation\">(</span>t1<span class=\"token punctuation\">,</span> t2<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">0.7745966692414834</code></pre></div>\n<p>ì´ì²˜ëŸ¼ ì´ ë‘ ê±°ë¦¬ì˜ ìœ ì‚¬ë„ëŠ” 0.77ì„ì„ ë³´ì—¬ì¤€ë‹¤</p>\n<h1 id=\"2-ì¶”ì²œì‹œìŠ¤í…œì˜-ì¢…ë¥˜\" style=\"position:relative;\"><a href=\"#2-%EC%B6%94%EC%B2%9C%EC%8B%9C%EC%8A%A4%ED%85%9C%EC%9D%98-%EC%A2%85%EB%A5%98\" aria-label=\"2 ì¶”ì²œì‹œìŠ¤í…œì˜ ì¢…ë¥˜ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ì¶”ì²œì‹œìŠ¤í…œì˜ ì¢…ë¥˜</h1>\n<p>ì¶”ì²œì‹œìŠ¤í…œì˜ ì¢…ë¥˜ëŠ” ì¶”ì²œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë‚˜ëˆˆë‹¤.</p>\n<ol>\n<li>ì½˜í…ì¸  ê¸°ë°˜ í•„í„°ë§ ; Content Based Filtering</li>\n<li>í˜‘ì—… í•„í„°ë§ ; Collaborative Filtering\n<ol>\n<li>ì‚¬ìš©ìê¸°ë°˜</li>\n<li>ì•„ì´í…œê¸°ë°˜</li>\n<li>ì ì¬ìš”ì¸ ê¸°ë°˜</li>\n</ol>\n</li>\n<li>Deep Learing ì ìš© ë°©ì‹</li>\n</ol>\n<p>Content based Filtering ì€ ë§ ê·¸ëŒ€ë¡œ<br>\nê·¸ ë‚´ìš© ë§Œì˜ ìœ ì‚¬ì„±ì„ í† ëŒ€ë¡œ ì¶”ì²œí•´ì¤€ë‹¤.</p>\n<p>ì•„ë°”íƒ€ ë¥¼ ë´¤ë‹¤ë©´ ê·¸ì™€ ë¹„ìŠ·í•œ íŠ¹ì§•(ê°ë…, ë°°ìš°, ìŠ¤í† ë¦¬, ì¥ë¥´) ë“±ì„ ê³ ë ¤í•´\nì•„ì´ì–¸ë§¨, ê°€ë””ì–¸ì¦ˆ ì˜¤ë¸Œ ê°¤ëŸ­ì‹œ ë“±ì„ ì¶”ì²œí•´ì£¼ëŠ” ê²ƒì´ë‹¤.</p>\n<p>Collaborative Filtering ì€ ì‚¬ìš©ì ê³¼ê±° í–‰ë™ì„ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œí•˜ëŠ” ë°©ì‹ì´ë‹¤.</p>\n<p>ì‚¬ìš©ì ê¸°ë°˜ : â€ ë‹¹ì‹ ê³¼ ë¹„ìŠ·í•œ ì‚¬ëŒë“¤ì€ ì´ëŸ° ì˜ìƒì„ ë´…ë‹ˆë‹¤  â€<br>\nì•„ì´í…œ ê¸°ë°˜ : â€ ì´ ì˜ìƒì„ ë³¸ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì€ ì´ ì˜ìƒë„ ë´¤ìŠµë‹ˆë‹¤ â€\nì ì¬ìš”ì¸ ê¸°ë°˜ : â€ ë‹¹ì‹ ì´ ì´ ì˜ìƒë“¤ì„ ì´ë ‡ê²Œ í‰ê°€í•œê±¸ ë³´ë‹ˆ ì´ ì˜ìƒì€ ë†’ê²Œ í‰ê°€í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤ â€</p>\n<p>ì ì¬ìš”ì¸ ê¸°ë°˜ì€ í–‰ë ¬ ì¸ìˆ˜ë¶„í•´ (Matrix Factorization) ë¥¼ í†µí•´ ì‚¬ìš©ìê°€ í‰ì ì„ ë§¤ê¸°ëŠ” ìš”ì¸(ì ì¬ìš”ì¸)ì„ ìš°ë¦¬ëŠ” ëª¨ë¥´ëŠ” ë³€ìˆ˜ë¼ê³  ê°€ì •í•˜ê³  ìˆ˜ì¹˜í™”(ë²¡í„°í™”) í•˜ì—¬ ìƒˆë¡œìš´ ì˜ìƒë“¤ì— ì–´ë–¤ í‰ì ì„ ë§¤ê¸¸ì§€ ì˜ˆì¸¡í•˜ëŠ” ë°©ì‹ì´ë‹¤.</p>\n<p>ì´ ë‹¤ì–‘í•œ ìˆ˜í•™ì—°ì‚° í˜¹ì€ ê³„ì‚°ì„ ìœ„í•´ ë‹¤ì–‘í•œ íŒŒë¼ë¯¸í„°ë¥¼ ì„¤ì •í•´ ê³„ì‚°ì„ ë„ì¶œí•  ìˆ˜ ìˆê³ ,<br>\nì´ ë•Œ ì‹ ê²½ë§ê²Œì¸µ ì—°ì‚°ë§, ì¦‰, Deep Learning model ì„ ì ‘ëª©í•  ìˆ˜ ìˆë‹¤.</p>\n<h1 id=\"3-ì‹¤ì œ-ì¶”ì²œ-ì‹œìŠ¤í…œ\" style=\"position:relative;\"><a href=\"#3-%EC%8B%A4%EC%A0%9C-%EC%B6%94%EC%B2%9C-%EC%8B%9C%EC%8A%A4%ED%85%9C\" aria-label=\"3 ì‹¤ì œ ì¶”ì²œ ì‹œìŠ¤í…œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. ì‹¤ì œ ì¶”ì²œ ì‹œìŠ¤í…œ</h1>\n<p>Youtube ë‚˜ Netflix ëŠ” ì¶”ì²œì— ì•„ì£¼ ë§ì€ ê²ƒë“¤ì„ ê³ ë ¤í•œë‹¤.</p>\n<p>ì‚¬ìš©ìì˜ êµ¬ë§¤ ì—¬ë¶€ë¿ë§Œ ì•„ë‹ˆë¼\nì‹œì²­ ì‹œê°„, ì›¹ì‚¬ì´íŠ¸ ì²´ë¥˜ ì‹œê°„, ì‚¬ì´íŠ¸ ìœ ì… ê²½ë¡œ, ì‹œì²­ê³¼ êµ¬ë§¤ê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„ ë“± ..</p>\n<p>ì¢‹ì€ ì¶”ì²œ ì‹œìŠ¤í…œì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ”</p>\n<p>ì–´ë–¤ ë°ì´í„°ë¥¼ ì¨ì•¼ í•  ì§€,\në°ì´í„° ê°„ ìš°ì„ ë„ì™€ ê°€ì¤‘ì¹˜ëŠ” ì–´ë–»ê²Œ ë‘ì–´ì•¼ í•˜ëŠ”ì§€</p>\n<p>í‰ê°€ì™€ ìˆ˜ì •ì„ ë°˜ë³µí•´ì•¼ í•œë‹¤.\nì¶”ì²œì‹œìŠ¤í…œì— ë¨¸ì‹ ëŸ¬ë‹ ë”¥ëŸ¬ë‹ì´ ì ìš©ë  ìˆ˜ë„ ìˆëŠ” ê²ƒì´ì§€ í•„ìˆ˜ëŠ” ì•„ë‹ˆê¸° ë•Œë¬¸ì—<br>\nêµ³ì´ ì¶”ì²œì‹œìŠ¤í…œì„ ìœ„í•´ ë¨¸ì‹ ëŸ¬ë‹ë¶€í„° ë°°ì›Œë‚˜ê°ˆ í•„ìš”ëŠ” ì—†ë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#1-1-%EC%9C%A0%EC%82%AC%EB%8F%84-similarity-%EC%B8%A1%EC%A0%95-%EB%B0%A9%EB%B2%95\">1-1. ìœ ì‚¬ë„ Similarity ì¸¡ì • ë°©ë²•</a></li>\n</ul>\n</div>","excerpt":"ğŸ¤´ Deep Learning ì´ìš© ë¶„ì•¼  - ì¶”ì²œ ì‹œìŠ¤í…œ ë‚´ êµ¬ê¸€ ì•„ì´ë””ë¡œ ë¡œê·¸ì¸ í•œ ë‹¤ìŒ ìœ íŠœë¸Œì— ë“¤ì–´ê°€ë©´ ë‚´ê°€ ë³´ê³ ì‹¶ì€ ì˜ìƒë“¤ì„ ë„ˆë¬´ ëˆ„ë¥´ê³  ì‹¶ê²Œ ë³´ì—¬ì¤€ë‹¤ youtube.PNG ë‹¨ìˆœí•˜ê²Œ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤. ì•„, ë‚´ê°€ ì§€ê¸ˆê¹Œì§€ ë´¤ë˜ ì˜ìƒë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ë‚´ê°€ ë³´ê³ ì‹¶ì–´í•  ì˜ìƒì„ ë„ì›Œì£¼ëŠ”êµ¬ë‚˜. ì—¬ê¸°ì„œ ë´¤ë˜ ì˜ìƒë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ì—ì„œ ë”¥ëŸ¬ë‹ ê¸°ë²•ì´ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. 1. ì¶”ì²œì‹œìŠ¤í…œì´ë€? ì—…ê³„ ë‚´ ìš©ì–´ë¥¼ ë¹Œë¦¬ìë©´  ì—ê²Œ  ì„ ì œê³µí•˜ëŠ” ì‹œìŠ¤í…œ. ìš°ë¦¬ëŠ”  ì˜ ì •ë³´ì™€   ì˜ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤ ì˜ˆë¥¼ ë“¤ì–´ user ì„±ë¯¼ ì´ ìˆë‹¤ê³  í•œë‹¤ë©´ ì„±ë¯¼ : 25ì‚´ / ë‚¨ì„± / ì¸ì²œ / í•™ìƒ / ì¸ë””ìŒì•…ì„ í˜¸ ì•„ë¬´ë¦¬ ê°„ë‹¨í•´ë„ ë‚˜ì´, ì„±ë³„, ì§€ì—­ ë“± ì—¬ëŸ¬ ê°œì˜ ì •ë³´ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. item â€˜Star is Bornâ€™ ì´ë¼ëŠ” ì˜í™”ê°€ ìˆë‹¤ê³  í•œë‹¤ë©´ â€˜Star is Bornâ€™ : ì¸ê¸°ë„ 5 / ì•¡ì…˜ë„ 5 / ë¡œë§¨ìŠ¤ 8 / ìŒì•… 10 / ë¦¬ë·°í‰ì   4.5 / ë“±ì˜ ì •ë³´ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. ì´ user ì™€ item ì˜ ì •ë³´ë¥¼â€¦","frontmatter":{"date":"February 21, 2022","title":"ì¶”ì²œì‹œìŠ¤í…œ","categories":"DeepML","author":"í•˜ì„±ë¯¼","emoji":"ğŸ—º"},"fields":{"slug":"/DML_recommend/"}},"next":{"id":"e44faddb-8403-51d4-abe0-da4ac049329a","html":"<h1 id=\"-tensor-flow-v2-ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼-ì´ìš©í•´-ë”¥ëŸ¬ë‹-ëª¨ë¸-ìƒì„±í•˜ê¸°\" style=\"position:relative;\"><a href=\"#-tensor-flow-v2-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4-%EB%94%A5%EB%9F%AC%EB%8B%9D-%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\" tensor flow v2 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ ë”¥ëŸ¬ë‹ ëª¨ë¸ ìƒì„±í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸŒ  Tensor flow V2 ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ ë”¥ëŸ¬ë‹ ëª¨ë¸ ìƒì„±í•˜ê¸°</h1>\n<p>Tensor flow V2 ë²„ì „ì—ì„œ ë”¥ëŸ¬ë‹ ëª¨ë¸ ì‘ì„± ë°©ë²•ì—ëŠ” í¬ê²Œ 3ê°€ì§€ê°€ ìˆë‹¤.</p>\n<ul>\n<li>Sequential</li>\n<li>Functional : sequential ì˜ ì¼ë°˜í™”ëœ ê°œë…</li>\n<li>Model Subclassing : í´ë˜ìŠ¤ë¡œ êµ¬í˜„ëœ ê¸°ì¡´ ëª¨ë¸ì„ ìƒì†ë°›ì•„ ìê¸° ëª¨ë¸ ë§Œë“¤ê¸°</li>\n</ul>\n<p>ìˆœì°¨ì ìœ¼ë¡œ ì–´ë–¤ ì°¨ì´ê°€ ìˆê³ ,<br>\nì–´ë–¤ ì‹ìœ¼ë¡œ ì œì‘í•˜ëŠ”ì§€ ì•Œì•„ê°€ë³´ì.</p>\n<hr>\n<h2 id=\"1-sequential-model\" style=\"position:relative;\"><a href=\"#1-sequential-model\" aria-label=\"1 sequential model permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Sequential Model</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">from</span> tensorflow <span class=\"token keyword\">import</span> keras\n\nmodel <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>__ë„£ê³ ì‹¶ì€ ë ˆì´ì–´__<span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>__ë„£ê³ ì‹¶ì€ ë ˆì´ì–´__<span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>__ë„£ê³ ì‹¶ì€ ë ˆì´ì–´__<span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> batch_size<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>epochs : ëª¨ë¸ë¡œ ë°ì´í„°ë¥¼ í•™ìŠµí•  íšŸìˆ˜<br>\nbatch_size : ë°ì´í„°ë¥¼ ì†Œë¶„í•´ ë„£ì„ ì–‘</p>\n<p>model = keras.Sequential() ì„ í™œìš©í•˜ë©´<br>\në”¥ëŸ¬ë‹ ëª¨ë¸ì„ ìŒ“ì•„ ë‚˜ê°ˆ ìˆ˜ ìˆë‹¤.</p>\n<p>ì…ë ¥ë¶€í„° ì¶œë ¥ê¹Œì§€ ìˆœì°¨ì (ì‹œí€€ì…œ) ìœ¼ë¡œ add í•˜ë©´ ëœë‹¤.</p>\n<h4 id=\"but\" style=\"position:relative;\"><a href=\"#but\" aria-label=\"but permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>but,</h4>\n<p>ëª¨ë¸ì˜ ì…ë ¥ê³¼ ì¶œë ¥ì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš°ì—ëŠ” ì í•©í•˜ì§€ ì•Šë‹¤.<br>\n(ë°˜ë“œì‹œ ì…ë ¥ 1ê°œ ì¶œë ¥ 1ê°€ì§€ ì—¬ì•¼ í•¨)</p>\n<h2 id=\"2-functional-api\" style=\"position:relative;\"><a href=\"#2-functional-api\" aria-label=\"2 functional api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Functional API</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">from</span> tensorflow <span class=\"token keyword\">import</span> keras\n\ninputs <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>__ì›í•˜ëŠ” ì…ë ¥ê°’ ëª¨ì–‘__<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>__ë„£ê³ ì‹¶ì€ ë ˆì´ì–´__<span class=\"token punctuation\">(</span>ê´€ë ¨ íŒŒë¼ë¯¸í„°<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">input</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>__ë„£ê³ ì‹¶ì€ ë ˆì´ì–´__<span class=\"token punctuation\">(</span>ê´€ë ¨ íŒŒë¼ë¯¸í„°<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\noutputs <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>__ë„£ê³ ì‹¶ì€ ë ˆì´ì–´__<span class=\"token punctuation\">(</span>ê´€ë ¨ íŒŒë¼ë¯¸í„°<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nmodel <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">(</span>inputs<span class=\"token operator\">=</span>inputs<span class=\"token punctuation\">,</span> outputs<span class=\"token operator\">=</span>outputs<span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> batch_size<span class=\"token operator\">=</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>model ì— ketas.Model ì´ ë“¤ì–´ê°„ë‹¤.<br>\nì´ê²ƒì€ ìš°ë¦¬ê°€ danse ë‚˜ Flatten ê°™ì€ ì§œì—¬ì ¸ ìˆëŠ” ì‹ ê²½ë§ì„ ì“°ëŠ” ê²Œ ì•„ë‹ˆë¼<br>\nì§ì ‘ input ê³¼ output ì„ êµ¬ì„±í•œë‹¤.</p>\n<p>ë•Œë¬¸ì— ì…ë ¥ê³¼ ì¶œë ¥ê°’ì´ ììœ ë¡­ë‹¤</p>\n<hr>\n<p>ë”¥ ëŸ¬ë‹ ëª¨ë¸ì€ ì¼ë°˜ì ìœ¼ë¡œ ë ˆì´ì–´ì˜ DAG Directed Acyclic graph ì´ë‹¤.<br>\në ˆì´ì–´ì˜ ê·¸ë˜í”„ë¥¼ bulid í•œë‹¤ëŠ” ëœ»ì´ë‹¤.</p>\n<h2 id=\"3-subclassing\" style=\"position:relative;\"><a href=\"#3-subclassing\" aria-label=\"3 subclassing permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Subclassing</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">from</span> tensorflow <span class=\"token keyword\">import</span> keras\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomModel</span><span class=\"token punctuation\">(</span>keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span>CustomModel<span class=\"token punctuation\">,</span> self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>__ì •ì˜í•˜ê³ ì í•˜ëŠ” ë ˆì´ì–´__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>__ì •ì˜í•˜ê³ ì í•˜ëŠ” ë ˆì´ì–´__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>__ì •ì˜í•˜ê³ ì í•˜ëŠ” ë ˆì´ì–´__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">def</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>__ì •ì˜í•˜ê³ ì í•˜ëŠ” ë ˆì´ì–´__<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>__ì •ì˜í•˜ê³ ì í•˜ëŠ” ë ˆì´ì–´__<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>__ì •ì˜í•˜ê³ ì í•˜ëŠ” ë ˆì´ì–´__<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">return</span> x\n    \nmodel <span class=\"token operator\">=</span> CustomModel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> batch_size<span class=\"token operator\">=</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì œì¼ ììœ ë¡œìš´ ëª¨ë¸ë§ì´ ê°€ëŠ¥í•œ subclassing</p>\n<h1 id=\"ì´ë¥¼-ë°”íƒ•ìœ¼ë¡œ-ì§ì ‘-êµ¬í˜„í•´ë³´ì\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EB%A5%BC-%EB%B0%94%ED%83%95%EC%9C%BC%EB%A1%9C-%EC%A7%81%EC%A0%91-%EA%B5%AC%ED%98%84%ED%95%B4%EB%B3%B4%EC%9E%90\" aria-label=\"ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì§ì ‘ êµ¬í˜„í•´ë³´ì permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì§ì ‘ êµ¬í˜„í•´ë³´ì</h1>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">from</span> tensorflow <span class=\"token keyword\">import</span> keras\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># ë°ì´í„° êµ¬ì„±ë¶€ë¶„</span>\nmnist <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>mnist\n\n<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> y_test<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> mnist<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nx_train<span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">=</span> x_train <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\n\nx_train<span class=\"token operator\">=</span>x_train<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>np<span class=\"token punctuation\">.</span>newaxis<span class=\"token punctuation\">]</span>\nx_test<span class=\"token operator\">=</span>x_test<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>np<span class=\"token punctuation\">.</span>newaxis<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz\n11493376/11490434 [==============================] - 0s 0us/step\n11501568/11490434 [==============================] - 0s 0us/step\n60000 10000</code></pre></div>\n<h2 id=\"1-sequential-model-1\" style=\"position:relative;\"><a href=\"#1-sequential-model-1\" aria-label=\"1 sequential model 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Sequential model</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Sequential Modelì„ êµ¬ì„±í•´ì£¼ì„¸ìš”.</span>\n<span class=\"token triple-quoted-string string\">\"\"\"\nSpec:\n1. 32ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n2. 64ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n3. Flatten ë ˆì´ì–´\n4. 128ê°œì˜ ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ reluì¸ Fully-Connected Layer(Dense)\n5. ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤ ê°œìˆ˜ì— ë§ëŠ” ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ softmaxì¸ Fully-Connected Layer(Dense)\n\"\"\"</span>\n\n\nmodel <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>models<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n                           <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token triple-quoted-string string\">\"\"\"\nmodel.add.Conv2D(32, 3, activation=\"relu\")\nmodel.add.Conv2D(64, 3, activation=\"relu\")\nmodel.add.Flatten()\nmodel.add.Dense(128, activation='relu')\nmodel.add.Dense(10, activation='softmax')\n\"\"\"</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'\\nmodel.add.Conv2D(32, 3, activation=\"relu\")\\nmodel.add.Conv2D(64, 3, activation=\"relu\")\\nmodel.add.Flatten()\\nmodel.add.Dense(128, activation=\\'relu\\')\\nmodel.add.Dense(10, activation=\\'softmax\\')\\n'</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># ëª¨ë¸ í•™ìŠµ ì„¤ì •</span>\n\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n              loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span>  y_test<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/5\n1875/1875 [==============================] - 31s 3ms/step - loss: 0.1118 - accuracy: 0.9654\nEpoch 2/5\n1875/1875 [==============================] - 5s 3ms/step - loss: 0.0368 - accuracy: 0.9882\nEpoch 3/5\n1875/1875 [==============================] - 5s 3ms/step - loss: 0.0211 - accuracy: 0.9933\nEpoch 4/5\n1875/1875 [==============================] - 5s 3ms/step - loss: 0.0131 - accuracy: 0.9956\nEpoch 5/5\n1875/1875 [==============================] - 5s 3ms/step - loss: 0.0100 - accuracy: 0.9968\n313/313 - 1s - loss: 0.0516 - accuracy: 0.9878\n\n\n\n\n\n[0.051644984632730484, 0.9878000020980835]</code></pre></div>\n<h2 id=\"2-functional-api-1\" style=\"position:relative;\"><a href=\"#2-functional-api-1\" aria-label=\"2 functional api 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Functional API</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">mnist <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>mnist\n\n<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> y_test<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> mnist<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nx_train<span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">=</span> x_train <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\n\nx_train<span class=\"token operator\">=</span>x_train<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>np<span class=\"token punctuation\">.</span>newaxis<span class=\"token punctuation\">]</span>\nx_test<span class=\"token operator\">=</span>x_test<span class=\"token punctuation\">[</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">,</span>np<span class=\"token punctuation\">.</span>newaxis<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">60000 10000</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\nSpec:\n0. (28X28X1) ì°¨ì›ìœ¼ë¡œ ì •ì˜ëœ Input\n1. 32ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n2. 64ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n3. Flatten ë ˆì´ì–´\n4. 128ê°œì˜ ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ reluì¸ Fully-Connected Layer(Dense)\n5. ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤ ê°œìˆ˜ì— ë§ëŠ” ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ softmaxì¸ Fully-Connected Layer(Dense)\n\"\"\"</span>\n\ninputs <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">28</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>inputs<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\noutputs <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nmodel <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">(</span>inputs<span class=\"token operator\">=</span>inputs<span class=\"token punctuation\">,</span> outputs<span class=\"token operator\">=</span>outputs<span class=\"token punctuation\">)</span>\n\n\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n              loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span>  y_test<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/5\n1875/1875 [==============================] - 7s 3ms/step - loss: 0.1039 - accuracy: 0.9679\nEpoch 2/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0339 - accuracy: 0.9895\nEpoch 3/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0204 - accuracy: 0.9931\nEpoch 4/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0130 - accuracy: 0.9959\nEpoch 5/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0093 - accuracy: 0.9972\n313/313 - 1s - loss: 0.0522 - accuracy: 0.9868\n\n\n\n\n\n[0.05223735421895981, 0.9868000149726868]</code></pre></div>\n<h2 id=\"3-subclassing-api\" style=\"position:relative;\"><a href=\"#3-subclassing-api\" aria-label=\"3 subclassing api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Subclassing API</h2>\n<p>keras.models ë¥¼ ìƒì†ë°›ëŠ” í´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ” ê²ƒ</p>\n<ol>\n<li><strong>init</strong> ë©”ì„œë“œì— ë ˆì´ì–´ ì„ ì–¸</li>\n<li>call() ë©”ì„œë“œì— forward propagation ë°©ì‹ ì²´ê³„ êµ¬í˜„</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\nSpec:\n0. keras.Model ì„ ìƒì†ë°›ì•˜ìœ¼ë©°, __init__()ì™€ call() ë©”ì„œë“œë¥¼ ê°€ì§„ ëª¨ë¸ í´ë˜ìŠ¤\n1. 32ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n2. 64ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n3. Flatten ë ˆì´ì–´\n4. 128ê°œì˜ ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ reluì¸ Fully-Connected Layer(Dense)\n5. ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤ ê°œìˆ˜ì— ë§ëŠ” ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ softmaxì¸ Fully-Connected Layer(Dense)\n6. callì˜ ì…ë ¥ê°’ì´ ëª¨ë¸ì˜ Input, callì˜ ë¦¬í„´ê°’ì´ ëª¨ë¸ì˜ Output\n\"\"\"</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">kerasModel</span><span class=\"token punctuation\">(</span>keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n        self<span class=\"token punctuation\">.</span>Conv2D32 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Conv2D64 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Flatten <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Dense128 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">128</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Dense <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">def</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Conv2D32<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Conv2D64<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Dense128<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        output <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">return</span> output\n    \nmodel <span class=\"token operator\">=</span> kerasModel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n              loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span>  y_test<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/5\n1875/1875 [==============================] - 7s 3ms/step - loss: 0.1011 - accuracy: 0.9689\nEpoch 2/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0339 - accuracy: 0.9893\nEpoch 3/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0184 - accuracy: 0.9938\nEpoch 4/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0136 - accuracy: 0.9954\nEpoch 5/5\n1875/1875 [==============================] - 6s 3ms/step - loss: 0.0078 - accuracy: 0.9973\n313/313 - 1s - loss: 0.0581 - accuracy: 0.9853\n\n\n\n\n\n[0.05812956392765045, 0.9853000044822693]</code></pre></div>\n<p>ì´ê±´ ê²°ë¡ ì ìœ¼ë¡œëŠ” model ì„ ê°–ë‹¤ ì“°ëŠ”ê±°ë¼ì„œ<br>\ninput ì„ ë”°ë¡œ ì„¤ì •ì•ˆí•˜ê³ <br>\nê·¸ë¦¬ê³  call ë©”ì„œë“œë„ fit í• ë•Œ ìë™ìœ¼ë¡œ ì¨ì§€ëŠ” ë“¯ í•˜ë‹¤.</p>\n<hr>\n<h1 id=\"cifar--100-ë°ì´í„°-ì˜ˆì œë¡œ-ë³µìŠµ\" style=\"position:relative;\"><a href=\"#cifar--100-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%98%88%EC%A0%9C%EB%A1%9C-%EB%B3%B5%EC%8A%B5\" aria-label=\"cifar  100 ë°ì´í„° ì˜ˆì œë¡œ ë³µìŠµ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CIFAR -100 ë°ì´í„° ì˜ˆì œë¡œ ë³µìŠµ</h1>\n<h3 id=\"sequential\" style=\"position:relative;\"><a href=\"#sequential\" aria-label=\"sequential permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sequential</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># ë°ì´í„° êµ¬ì„±ë¶€ë¶„</span>\ncifar100 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>cifar100\n\n<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> y_test<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> cifar100<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nx_train<span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">=</span> x_train <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">50000 10000</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\"># Sequential Modelì„ êµ¬ì„±í•´ì£¼ì„¸ìš”.</span>\n<span class=\"token triple-quoted-string string\">\"\"\"\nSpec:\n1. 16ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n2. pool_sizeê°€ 2ì¸ MaxPool ë ˆì´ì–´\n3. 32ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n4. pool_sizeê°€ 2ì¸ MaxPool ë ˆì´ì–´\n5. 256ê°œì˜ ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ reluì¸ Fully-Connected Layer(Dense)\n6. ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤ ê°œìˆ˜ì— ë§ëŠ” ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ softmaxì¸ Fully-Connected Layer(Dense)\n\"\"\"</span>\n\nmodel <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>models<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPool2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPool2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n              loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span>  y_test<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 2/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 3/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 4/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 5/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\n313/313 - 1s - loss: nan - accuracy: 0.0100\n\n\n\n\n\n[nan, 0.009999999776482582]</code></pre></div>\n<h3 id=\"functional\" style=\"position:relative;\"><a href=\"#functional\" aria-label=\"functional permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Functional</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\nSpec:\n0. (32X32X3) ì°¨ì›ìœ¼ë¡œ ì •ì˜ëœ Input\n1. 16ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n2. pool_sizeê°€ 2ì¸ MaxPool ë ˆì´ì–´\n3. 32ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n4. pool_sizeê°€ 2ì¸ MaxPool ë ˆì´ì–´\n5. 256ê°œì˜ ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ reluì¸ Fully-Connected Layer(Dense)\n6. ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤ ê°œìˆ˜ì— ë§ëŠ” ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ softmaxì¸ Fully-Connected Layer(Dense)\n\"\"\"</span>\n\ninputs <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">(</span>shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>inputs<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPool2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPool2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\nx <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\noutputs <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span>activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\nmodel <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">(</span>inputs<span class=\"token operator\">=</span>inputs<span class=\"token punctuation\">,</span> outputs<span class=\"token operator\">=</span>outputs<span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n               loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n               metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> epochs <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> y_test<span class=\"token punctuation\">,</span> verbose <span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 2/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 3/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 4/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 5/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\n313/313 - 1s - loss: nan - accuracy: 0.0100\n\n\n\n\n\n[nan, 0.009999999776482582]</code></pre></div>\n<h3 id=\"subclass-api\" style=\"position:relative;\"><a href=\"#subclass-api\" aria-label=\"subclass api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Subclass API</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token triple-quoted-string string\">\"\"\"\nSpec:\n0. keras.Model ì„ ìƒì†ë°›ì•˜ìœ¼ë©°, __init__()ì™€ call() ë©”ì„œë“œë¥¼ ê°€ì§„ ëª¨ë¸ í´ë˜ìŠ¤\n1. 16ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n2. pool_sizeê°€ 2ì¸ MaxPool ë ˆì´ì–´\n3. 32ê°œì˜ ì±„ë„ì„ ê°€ì§€ê³ , ì»¤ë„ì˜ í¬ê¸°ê°€ 3, activation functionì´ reluì¸ Conv2D ë ˆì´ì–´\n4. pool_sizeê°€ 2ì¸ MaxPool ë ˆì´ì–´\n5. 256ê°œì˜ ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ reluì¸ Fully-Connected Layer(Dense)\n6. ë°ì´í„°ì…‹ì˜ í´ë˜ìŠ¤ ê°œìˆ˜ì— ë§ëŠ” ì•„ì›ƒí’‹ ë…¸ë“œë¥¼ ê°€ì§€ê³ , activation functionì´ softmaxì¸ Fully-Connected Layer(Dense)\n7. callì˜ ì…ë ¥ê°’ì´ ëª¨ë¸ì˜ Input, callì˜ ë¦¬í„´ê°’ì´ ëª¨ë¸ì˜ Output\n\"\"\"</span>\n\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">kerasModel</span><span class=\"token punctuation\">(</span>keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        \n        self<span class=\"token punctuation\">.</span>Conv2D16 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Conv2D32 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Maxpool <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPool2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Flatten <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Dense256 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>Dense <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n    \n    <span class=\"token keyword\">def</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Conv2D16<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Maxpool<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Conv2D32<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Maxpool<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Dense256<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        output <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        \n        <span class=\"token keyword\">return</span> output\n    \nmodel <span class=\"token operator\">=</span> kerasModel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n              loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">,</span> epochs<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmodel<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span>  y_test<span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 2/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 3/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 4/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\nEpoch 5/5\n1563/1563 [==============================] - 5s 3ms/step - loss: nan - accuracy: 0.0100\n313/313 - 1s - loss: nan - accuracy: 0.0100\n\n\n\n\n\n[nan, 0.009999999776482582]</code></pre></div>\n<hr>\n<p>ìš°ë¦¬ëŠ” model.compile ì— ìˆì–´ì„œ ê³„ì† ë™ì¼í•œ êµ¬ì„±ì„ ìœ ì§€í–ˆë‹¤.</p>\n<p>ì ì‹œ ì¸ê³µì§€ëŠ¥ í•™ìŠµ ê³¼ì •ì„ ë³µê¸°í•´ë³´ì.</p>\n<ol>\n<li>Forward Propagation</li>\n<li>Loss ê°’ ê³„ì‚°</li>\n<li>ì¤‘ê°„ ë ˆì´ì–´ ê°’ ë° loss ë¥¼ í™œìš©í•œ chain rule ë°©ì‹ì˜ Back propagation</li>\n<li>parameter update</li>\n<li>repeat</li>\n</ol>\n<p>ì´ëŸ° ê³¼ì •ì´ tf v2 ì—ì„œëŠ” fit ì— ë‹¤ ë‹´ê²¨ìˆë‹¤.</p>\n<p>tf.gredient tape ëŠ” propagation ë™ì•ˆ ì§„í–‰ë˜ëŠ” ëª¨ë“  ì—°ì‚°ì˜ ì¤‘ê°„ ë ˆì´ì–´ ê°’ì„<br>\ntape ì— ê¸°ë¡í•œë‹¤.</p>\n<p>ì´ë¥¼ ì´ìš©í•´ gredient ë¥¼ ê³„ì‚°í•˜ê³  tape ë¥¼ íê¸°í•œë‹¤.</p>\n<p>ìš°ë¦¬ëŠ” ì´ tape ê°’ì„ ì´ìš©í•´ ê³ ê¸‰ê¸°ë²•ì„ ì´ìš©í•  ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">from</span> tensorflow <span class=\"token keyword\">import</span> keras\n\n<span class=\"token comment\"># ë°ì´í„° êµ¬ì„±ë¶€ë¶„</span>\ncifar100 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>datasets<span class=\"token punctuation\">.</span>cifar100\n\n<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> y_test<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> cifar100<span class=\"token punctuation\">.</span>load_data<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nx_train<span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">=</span> x_train <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span><span class=\"token punctuation\">,</span> x_test <span class=\"token operator\">/</span> <span class=\"token number\">255.0</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># ëª¨ë¸ êµ¬ì„±ë¶€ë¶„</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">CustomModel</span><span class=\"token punctuation\">(</span>keras<span class=\"token punctuation\">.</span>Model<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token builtin\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>__init__<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>conv1 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>maxpool1 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPool2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>conv2 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Conv2D<span class=\"token punctuation\">(</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>maxpool2 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>MaxPool2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>flatten <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>fc1 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">256</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\n        self<span class=\"token punctuation\">.</span>fc2 <span class=\"token operator\">=</span> keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">def</span> <span class=\"token function\">call</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>conv1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>maxpool1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>conv2<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>maxpool2<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>flatten<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>fc1<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n        x <span class=\"token operator\">=</span> self<span class=\"token punctuation\">.</span>fc2<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">return</span> x\n\nmodel <span class=\"token operator\">=</span> CustomModel<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">50000 10000</code></pre></div>\n<p>ì§€ê¸ˆê¹Œì§€ëŠ”</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span><span class=\"token string\">'adam'</span><span class=\"token punctuation\">,</span>\n              loss<span class=\"token operator\">=</span><span class=\"token string\">'sparse_categorical_crossentropy'</span><span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì—ì„œ ì•Œì•„ì„œ loss ë¥¼ í†µí•´ í•™ìŠµ íŒŒë¼ë¯¸í„°ë¥¼ ìˆ˜ì •í•  ìˆ˜ ìˆê²Œ í•´ì£¼ì—ˆë‹¤.</p>\n<p>ì´ë²ˆì—ëŠ” tape.gradient() ë¥¼ í†µí•´ì„œ<br>\në§¤ ìŠ¤í… ë§ˆë‹¤ ë°œìƒí•˜ëŠ” gredient ë¥¼ export,<br>\noptimizer.apply_grediens() ë¥¼ í†µí•´ ë°œìƒí•œ gredient ê°€<br>\nmodel.trainable_variables ë¥¼ í†µí•´ íŒŒë¼ë¯¸í„°ë¥¼ ì—…ë°ì´í„° í•˜ë„ë¡ í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">loss_func <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>losses<span class=\"token punctuation\">.</span>SparseCategoricalCrossentropy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\noptimizer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>optimizers<span class=\"token punctuation\">.</span>Adam<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># tf.GradientTape()ë¥¼ í™œìš©í•œ train_step</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">train_step</span><span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">with</span> tf<span class=\"token punctuation\">.</span>GradientTape<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> tape<span class=\"token punctuation\">:</span>\n        predictions <span class=\"token operator\">=</span> model<span class=\"token punctuation\">(</span>features<span class=\"token punctuation\">)</span>\n        loss <span class=\"token operator\">=</span> loss_func<span class=\"token punctuation\">(</span>labels<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">)</span>\n        gradients <span class=\"token operator\">=</span> tape<span class=\"token punctuation\">.</span>gradient<span class=\"token punctuation\">(</span>loss<span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>trainable_variables<span class=\"token punctuation\">)</span>\n    optimizer<span class=\"token punctuation\">.</span>apply_gradients<span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>gradients<span class=\"token punctuation\">,</span> model<span class=\"token punctuation\">.</span>trainable_variables<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> loss</code></pre></div>\n<p>ìœ„ì˜ train_step ë©”ì„œë“œê°€ ë°”ë¡œ<br>\nfit ì„ í†µí•´ 1ë²ˆ epoch í•˜ëŠ” ë™ì•ˆì˜ ì•ˆì—ì„œ ì´ë£¨ì–´ì§€ëŠ” steps ë“¤ì˜ ì§„í–‰ë°©ì‹ì„ ë‚˜íƒ€ë‚¸ê²ƒ.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">def</span> <span class=\"token function\">train_model</span><span class=\"token punctuation\">(</span>batch_size<span class=\"token operator\">=</span><span class=\"token number\">32</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    start <span class=\"token operator\">=</span> time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> epoch <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        x_batch <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        y_batch <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">for</span> step<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span> y_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            x_batch<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span>\n            y_batch<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span> step <span class=\"token operator\">%</span> batch_size <span class=\"token operator\">==</span> batch_size<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">:</span>\n                loss <span class=\"token operator\">=</span> train_step<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>x_batch<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span>y_batch<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                x_batch <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n                y_batch <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Epoch %d: last batch loss = %.4f'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>epoch<span class=\"token punctuation\">,</span> <span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span>loss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"It took {} seconds\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>time<span class=\"token punctuation\">.</span>time<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> start<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\ntrain_model<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 0: last batch loss = 3.2522\nEpoch 1: last batch loss = 2.6932\nEpoch 2: last batch loss = 2.4441\nEpoch 3: last batch loss = 2.3071\nEpoch 4: last batch loss = 2.2136\nIt took 85.202951669693 seconds</code></pre></div>\n<p>ìœ„ ë‘ í•¨ìˆ˜ì˜ ì—°ê³„ì‚¬ìš©ì´\nfit ë©”ì„œë“œë¥¼ í’€ì–´ ì“´ ê²ƒì´ë‹¤.</p>\n<p>ì‰½ê²Œ ë§í•˜ë©´</p>\n<p>ë°ì´í„°ë“¤ì„ batch_size ë§Œí¼ ëŠì–´ì„œ<br>\nê·¸ ëŠì€ ë§Œí¼ì˜ x_train(feature) ë¥¼ ë„£ì–´ ëª¨ë¸ ì‹ ê²½ë§ì— ë„£ê³  ëŒë ¤\nì˜ˆì¸¡í•œ y_train ê°’ì„ ë°˜í™˜í•˜ê³ </p>\n<p>ì‹¤ì œ y_trian(label) ê°’ê³¼ ì˜ˆì¸¡í•œ y_trian ê°’ì„ ì†ì‹¤í•¨ìˆ˜(loss) ë¥¼ ëŒë ¤<br>\nê·¸ ì¶œë ¥ ê°’ìœ¼ë¡œ Back propagation ì„ í†µí•´ ëª¨ë¸ ë‚´ë¶€ ê°€ì¤‘ì¹˜ë¥¼ ìƒˆë¡œìš´ ê°€ì¤‘ì¹˜ë¡œ update</p>\n<p>ì ê·¸ëŸ¼ ì†ì‹¤ê°’ì€ í•œ 1epochs ì— ë°°ì¹˜ì‚¬ì´ì¦ˆ ëŒë¦°ë§Œí¼ ë‚˜ì˜¤ê² ì§€?<br>\n(ìœ„ì˜ ê²½ìš° 32ë°°ì¹˜ì‚¬ì´ì¦ˆ ì´ë¯€ë¡œ ë°ì´í„°ê°€ 100ê°œë©´ í•œ epochs ë‹¹ loss ê°€ 3ê°œ ë‚˜ì˜¤ì§€)\ní•˜ì§€ë§Œ ì¶œë ¥ë˜ëŠ” loss ëŠ” ë§¨ ë§ˆì§€ë§‰ ë°°ì¹˜ì˜ loss ì´ë‹¤.</p>\n<p>ì´ ê³¼ì •ì„ epoch íšŸìˆ˜ ë§Œí¼ ë°˜ë³µí•˜ëŠ” ê²ƒì´ë‹¤.</p>\n<p>ì´ê²Œ fit ë©”ì„œë“œê°€ í•˜ëŠ” ì¼.</p>\n<hr>\n<p>ì´ê±¸ êµ³ì´ ë„ì§‘ì–´ë‚´ì„œ ë³´ëŠ” ì´ìœ ëŠ”</p>\n<p>ìš°ë¦¬ê°€ ê°•í™”í•™ìŠµ ë˜ëŠ” GAN ì„ ì‹œí–‰í•  ë•Œ\nì´ ë‚´ë¶€ train_step ì˜ ì¬êµ¬ì„±ì„ í•´ì•¼ í•˜ë¯€ë¡œ!!!!!</p>\n<hr>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">prediction <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span> batch_size<span class=\"token operator\">=</span>x_test<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> verbose<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\ntemp <span class=\"token operator\">=</span> <span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span>squeeze<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>prediction<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\ntemp<span class=\"token operator\">/</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># Accuracy</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">1/1 [==============================] - 1s 822ms/step\n\n\n\n\n\n0.346</code></pre></div>\n<p>ì¼ë‹¨ epoch í•´ë´£ìœ¼ë‹ˆ ê²°ê³¼ê°’ë„ ì´ë ‡ê²Œ ë„ì¶œì´ ëœë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#1-sequential-model\">1. Sequential Model</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#but\">but,</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-functional-api\">2. Functional API</a></p>\n</li>\n<li>\n<p><a href=\"#3-subclassing\">3. Subclassing</a></p>\n</li>\n<li>\n<p><a href=\"#1-sequential-model-1\">1. Sequential model</a></p>\n</li>\n<li>\n<p><a href=\"#2-functional-api-1\">2. Functional API</a></p>\n</li>\n<li>\n<p><a href=\"#3-subclassing-api\">3. Subclassing API</a></p>\n<ul>\n<li><a href=\"#sequential\">Sequential</a></li>\n<li><a href=\"#functional\">Functional</a></li>\n<li><a href=\"#subclass-api\">Subclass API</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"February 19, 2022","title":"íŒŒì´ì¬ìœ¼ë¡œ ë”¥ëŸ¬ë‹ ëª¨ë¸ ì œì‘í•˜ê¸°","categories":"DeepML","author":"í•˜ì„±ë¯¼","emoji":"ğŸ§™â€â™‚ï¸"},"fields":{"slug":"/DML_keras/"}},"prev":{"id":"164e3337-bd6f-55fb-8feb-932bec92dc93","html":"<h1 id=\"ë¹…ë°ì´í„°-í•¸ë“¤ë§ì˜-í•„ìˆ˜-ë³‘ë ¬-ì»´í“¨íŒ…\" style=\"position:relative;\"><a href=\"#%EB%B9%85%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%95%B8%EB%93%A4%EB%A7%81%EC%9D%98-%ED%95%84%EC%88%98-%EB%B3%91%EB%A0%AC-%EC%BB%B4%ED%93%A8%ED%8C%85\" aria-label=\"ë¹…ë°ì´í„° í•¸ë“¤ë§ì˜ í•„ìˆ˜ ë³‘ë ¬ ì»´í“¨íŒ… permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¹…ë°ì´í„° í•¸ë“¤ë§ì˜ í•„ìˆ˜, ë³‘ë ¬ ì»´í“¨íŒ…</h1>\n<h2 id=\"ë™ì‹œì„±ê³¼-ë³‘ë ¬ì„±\" style=\"position:relative;\"><a href=\"#%EB%8F%99%EC%8B%9C%EC%84%B1%EA%B3%BC-%EB%B3%91%EB%A0%AC%EC%84%B1\" aria-label=\"ë™ì‹œì„±ê³¼ ë³‘ë ¬ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë™ì‹œì„±ê³¼ ë³‘ë ¬ì„±</h2>\n<p>ë™ì‹œì„± : Concurrency</p>\n<p>ë³‘ë ¬ì„± : Parallelism</p>\n<p>ë©€í‹° íƒœìŠ¤í‚¹ì—ëŠ” ìœ„ì˜ 2ê°€ì§€ ë°©ì‹ìˆë‹¤.</p>\n<p>ë™ì‹œì„± : í•˜ë‚˜ì˜ processor ê°€ ë‚¨ëŠ” ì‹œê°„ë™ì•ˆ ë‹¤ë¥¸ task ë¥¼ ë™ì‹œì— ìˆ˜í–‰</p>\n<p>ë‹¤ì‹œë§í•´, íŠ¹ì • ìˆœê°„ì—ëŠ” 1ê°€ì§€ task ë¥¼ í•˜ê² ì§€ë§Œ, ë‹¤ìŒ task ë¡œ ë„˜ì–´ê°€ëŠ”ë° ì‹œê°„ì´ ê±¸ë¦¬ê²Œ ë˜ë©´ ë‹¤ë¥¸ task ë¥¼ ìˆ˜í–‰í•˜ë„ë¡ í•œë‹¤.</p>\n<p>ë³‘ë ¬ì„± : ì—¬ëŸ¬ processor ê°€ ê°ì task ë¥¼ ë™ì‹œì— ìˆ˜í–‰</p>\n<blockquote>\n<p>ë‹¤ì‹œ ë§í•´, ë³‘ë ¬ì„±ì„ ê°€ì§„ processor ê°€ ë™ì‹œì„±ì„ ê°€ì§€ê³  ì¼í•  ìˆ˜ ìˆë‹¤.</p>\n</blockquote>\n<p>ì˜ˆë¥¼ ë“¤ì–´, ë¼ë©´ì„ ì¡°ë¦¬í•˜ë ¤ë©´ ë¬¼ì„ ë“ì—¬ì•¼ í•˜ëŠ”ë°.<br>\nprocessor ëŠ” ë¶ˆì„ ì¼œê³  ë¬¼ì´ ë“ê¸°ë¥¼ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤.</p>\n<p>ì´ì²˜ëŸ¼ ëŒ€ê¸°í•´ì•¼ í•˜ëŠ” ìƒí™©ì„ â€˜boundâ€™ ìƒíƒœ ë¼ê³  í•œë‹¤.</p>\n<p>bound ìƒíƒœì— ê·¸ì € ëŒ€ê¸°ë§Œ í•˜ê³  ìˆëŠ” ë°©ì‹ì„ Syncronzized, ë™ê¸° ë°©ì‹ì´ë¼ê³  í•œë‹¤.<br>\nbound ìƒíƒœì— ë‹¤ë¥¸ ì¼ì„ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì„ Asynchronous ë¹„ë™ê¸° ë°©ì‹ì´ë¼ê³  í•œë‹¤.</p>\n<hr>\n<h2 id=\"process-thread--profiling\" style=\"position:relative;\"><a href=\"#process-thread--profiling\" aria-label=\"process thread  profiling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>process, thread , profiling</h2>\n<h3 id=\"process\" style=\"position:relative;\"><a href=\"#process\" aria-label=\"process permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Process</h3>\n<p>í•˜ë‚˜ì˜ í”„ë¡œê·¸ë¨ì„ ìƒì„±í•  ë•Œ, ìš´ì˜ì²´ì œëŠ” í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ ë¥¼ ìƒì„±í•œë‹¤.</p>\n<p>í”„ë¡œì„¸ìŠ¤ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ë™ì‹œí‚¤ë©´ì„œ ì¼ì–´ë‚˜ëŠ” ë©”ëª¨ë¦¬ìƒì˜ ì‘ì—… ë‹¨ìœ„ë¥¼ ì˜ë¯¸í•œë‹¤.</p>\n<p>í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ëŠ” CPU , ë©”ëª¨ë¦¬(Ram), ë””ìŠ¤í¬ ë° ìë£Œêµ¬ì¡°ë¥¼ ì´ìš©í•˜ëŠ”ë°,\nê·¸ ê³¼ì •ì—ì„œ ë©”ëª¨ë¦¬ëŠ” ì—¬ëŸ¬ ë²ˆ ì“°ì´ê²Œ ëœë‹¤.</p>\n<h3 id=\"thread\" style=\"position:relative;\"><a href=\"#thread\" aria-label=\"thread permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Thread</h3>\n<p>thread ëŠ” process ë‚´ë¶€ì— ìˆëŠ” ë˜ ê°ê°ì˜ ì‘ì—…ë‹¨ìœ„ë¥¼ ì˜ë¯¸í•œë‹¤</p>\n<p>í—¬ìŠ¤ë¥¼ í•˜ëŠ” <code class=\"language-text\">program</code> ì—ì„œ, ìš´ë™ì„ ìˆ˜ë¼ëŠ” <code class=\"language-text\">processor</code> ëŠ” ìŠ¤ì¿¼íŠ¸, ë ˆê·¸í”„ë ˆìŠ¤, ë ˆê·¸ ì»¬ ë“±ì˜ <code class=\"language-text\">thread</code> ë¥¼ ìˆ˜í–‰í•œë‹¤.</p>\n<p>í—¬ìŠ¤ë¡œ ê³„ì† ë¹„ìœ ë¥¼ ë“¤ì–´ ë³´ê² ë‹¤.</p>\n<p>ìš´ë™ì„ ìˆ˜ë“¤ë¼ë¦¬ í—¬ìŠ¤ì¥ ìì²´ë¥¼ ê³µìœ í•  ìˆ˜ëŠ” ìˆì§€ë§Œ, í•˜ë‚˜ì˜ ë ‰ ì„ ê³µìœ í•  ìˆ˜ëŠ” ì—†ë‹¤.</p>\n<blockquote>\n<p>ë‹¤ì‹œë§í•´, <code class=\"language-text\">thraed</code> ë§ˆë‹¤ ì „ìš© ë©”ëª¨ë¦¬ ê³µê°„ <code class=\"language-text\">head</code> ì„ ê°€ì§„ë‹¤.</p>\n</blockquote>\n<h3 id=\"profiling\" style=\"position:relative;\"><a href=\"#profiling\" aria-label=\"profiling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>profiling</h3>\n<p>ì‚¬ê±´ìˆ˜ì‚¬ í”„ë¡œíŒŒì¼ë§. ë“¤ì–´ë³¸ì  ìˆì„ ê²ƒì´ë‹¤.<br>\nê·¸ ì‚¬ê±´ì˜ ì¼ê±°ìˆ˜ ì¼íˆ¬ì¡±ì„ ë“¤ì—¬ë‹¤ë³´ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.</p>\n<p>ì»´í“¨í„° ë‚´ë¶€ì˜ í”„ë¡œíŒŒì¼ë§ë„ ë˜‘ê°™ë‹¤.</p>\n<p>í”„ë¡œê·¸ë¨ ì½”ë“œ ë‚´ë¶€ì—ì„œ</p>\n<ol>\n<li>ì–´ëŠ ë¶€ë¶„ì´ ëŠë¦°ì§€</li>\n<li>ì–´ë””ì„œ RAMì„ ë§ì´ ì‚¬ìš©í•˜ëŠ”ì§€</li>\n</ol>\n<p>í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>\n<p>íŒŒì´ì¬ì—ì„œë„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> timeit <span class=\"token comment\"># í”„ë¡œíŒŒì¼ë§ ë¼ì´ë¸ŒëŸ¬ë¦¬</span>\n        \n<span class=\"token keyword\">def</span> <span class=\"token function\">f1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    s <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    \n<span class=\"token keyword\">def</span> <span class=\"token function\">f2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    l <span class=\"token operator\">=</span> <span class=\"token builtin\">list</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    \n<span class=\"token keyword\">def</span> <span class=\"token function\">f3</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    t <span class=\"token operator\">=</span> <span class=\"token builtin\">tuple</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">f4</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    s <span class=\"token operator\">=</span> <span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    \n<span class=\"token keyword\">def</span> <span class=\"token function\">f5</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    s <span class=\"token operator\">=</span> <span class=\"token builtin\">set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        s<span class=\"token punctuation\">.</span>add<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">f6</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    l <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        l<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n    \n<span class=\"token keyword\">def</span> <span class=\"token function\">f7</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    s_comp <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\n\n    \n<span class=\"token keyword\">def</span> <span class=\"token function\">f8</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    l_comp <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    \n\nt1 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f1()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f1\"</span><span class=\"token punctuation\">)</span>\nt2 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f2()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f2\"</span><span class=\"token punctuation\">)</span>\nt3 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f3()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f3\"</span><span class=\"token punctuation\">)</span>\nt4 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f4()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f4\"</span><span class=\"token punctuation\">)</span>\nt5 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f5()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f5\"</span><span class=\"token punctuation\">)</span>\nt6 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f6()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f6\"</span><span class=\"token punctuation\">)</span>\nt7 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f7()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f7\"</span><span class=\"token punctuation\">)</span>\nt8 <span class=\"token operator\">=</span> timeit<span class=\"token punctuation\">.</span>Timer<span class=\"token punctuation\">(</span><span class=\"token string\">\"f8()\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"from __main__ import f8\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"set               :\"</span><span class=\"token punctuation\">,</span> t1<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list              :\"</span><span class=\"token punctuation\">,</span> t2<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tuple             :\"</span><span class=\"token punctuation\">,</span> t3<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"string            :\"</span><span class=\"token punctuation\">,</span> t4<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"set_add           :\"</span><span class=\"token punctuation\">,</span> t5<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list_append       :\"</span><span class=\"token punctuation\">,</span> t6<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"set_comprehension :\"</span><span class=\"token punctuation\">,</span> t5<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"list_comprehension:\"</span><span class=\"token punctuation\">,</span> t6<span class=\"token punctuation\">.</span>timeit<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">set               : 1.690346003999366\nlist              : 0.7587415179996242\ntuple             : 0.7320455680001032\nstring            : 0.4020238100001734\nset_add           : 5.726110922999396\nlist_append       : 5.244985264999741\nset_comprehension : 5.7903866610004116\nlist_comprehension: 5.160655052999573</code></pre></div>\n<p>0ë¶€í„° 100ê¹Œì§€ì˜ ìˆ˜ë¥¼ ê° ìë£Œêµ¬ì¡°ì— ë‹´ëŠ” ì‹œê°„ì„ ì„¸ì–´ ë³´ì•˜ë‹¤.</p>\n<p>ì´ë ‡ê²Œ í•¨ìˆ˜ì˜ ì„±ëŠ¥ì„ ì¸¡ì •í•  ìˆ˜ ìˆë‹¤.\në‹¤ë§Œ ì´ê±´ í”„ë¡œíŒŒì¼ë§ì„ ìµœ ë‹¨ìˆœí™” í•œ ê²ƒì´ë‹¤.</p>\n<p>ì›ë˜ëŠ” ì½”ë“œë³„ ë“¤ì–´ê°€ëŠ” Ram ì˜ í¬ê¸°ë‚˜ ì„±ëŠ¥ê¹Œì§€ ì¸¡ì •í•œë‹¤.</p>\n<h2 id=\"multi-tasking\" style=\"position:relative;\"><a href=\"#multi-tasking\" aria-label=\"multi tasking permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Multi-tasking</h2>\n<p>ë‹¨ìˆœíˆ ë§í•´ ìš°ë¦¬ëŠ” ë³‘ë ¬í™”, ë˜ëŠ” ë™ì‹œí™” í•˜ê¸° ìœ„í•´ì„œ ìì›ì„ up í•  ìˆ˜ë„ ìˆê³ ,<br>\nìì›ì„ out (í™•ì¥) í•  ìˆ˜ë„ ìˆë‹¤.</p>\n<p>Scale up - í•œ ëŒ€ì˜ ì»´í“¨í„° ì„±ëŠ¥ í–¥ìƒ\nScale out - í•œ ëŒ€ì—ì„œ ì—¬ëŸ¬ëŒ€ë¡œ ì»´í“¨í„° ê°œìˆ˜ë¥¼ ëŠ˜ë ¤ í•œëŒ€ì²˜ëŸ¼ ì‚¬ìš©</p>\n<h2 id=\"ì‹¤ìŠµ\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%8A%B5\" aria-label=\"ì‹¤ìŠµ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‹¤ìŠµ</h2>\n<h3 id=\"thread-1\" style=\"position:relative;\"><a href=\"#thread-1\" aria-label=\"thread 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>thread</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> threading <span class=\"token keyword\">import</span> <span class=\"token operator\">*</span>\n<span class=\"token keyword\">from</span> time <span class=\"token keyword\">import</span> sleep\n\nStopped <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">worker</span><span class=\"token punctuation\">(</span>work<span class=\"token punctuation\">,</span> sleep_sec<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n    \n    <span class=\"token keyword\">while</span> <span class=\"token keyword\">not</span> Stopped<span class=\"token punctuation\">:</span>          \n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'do '</span><span class=\"token punctuation\">,</span> work<span class=\"token punctuation\">)</span>      \n        sleep<span class=\"token punctuation\">(</span>sleep_sec<span class=\"token punctuation\">)</span> \n        \n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'retired..'</span><span class=\"token punctuation\">)</span>         \n        \n        \nt <span class=\"token operator\">=</span> Thread<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>worker<span class=\"token punctuation\">,</span> args<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'work'</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>    \nt<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>    </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">do  work\ndo  work\ndo  work</code></pre></div>\n<p>ì›ë˜ëŠ” í•˜ë‚˜ì˜ ì½”ë“œê°€ ìˆìœ¼ë©´ ì‘ë™ì¤‘ì— ë‹¤ë¥¸ ê²ƒì— ì˜í–¥ì„ ë°›ì§€ ì•ŠëŠ”ë‹¤.<br>\në‹¤ë§Œ í˜„ì¬ <code class=\"language-text\">Thread</code> ë©”ì„œë“œë¥¼ í†µí•´ í•¨ìˆ˜ë¥¼ ì‹œì‘í–ˆë‹¤.</p>\n<p><code class=\"language-text\">Thread</code> ì—ì„œ worker ë©”ì„œë“œë¥¼ ì‹œì‘ì‹œì¼°ê³ , í•¨ìˆ˜ì˜ ì¸ìëŠ” work, 2 ê°€ ë“¤ì–´ê°”ë‹¤.</p>\n<p>ì´ ì‘ì—…ì´ ëë‚˜ë ¤ë©´ <code class=\"language-text\">Stopped = True</code> ê°€ ë˜ì–´ì•¼ í•œë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">Stopped <span class=\"token operator\">=</span> <span class=\"token boolean\">True</span>    \n\nt<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>          \n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'finish'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">retired..\nfinish</code></pre></div>\n<p>ì´ì™€ ê°™ì´ <code class=\"language-text\">join</code> ë©”ì„œë“œë¥¼ í†µí•´ ê°™ì€ <code class=\"language-text\">thread</code> ì—ì„œ ì‘ì—…ì„ ì§„í–‰ì‹œì¼°ê³ \nìƒë‹¨ì˜ ë¬´í•œë£¨í”„ë¥¼ ì¤‘ë‹¨ ì‹œí‚¬ ìˆ˜ê°€ ìˆë‹¤.</p>\n<h3 id=\"multi---process\" style=\"position:relative;\"><a href=\"#multi---process\" aria-label=\"multi   process permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>multi - process</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> multiprocessing <span class=\"token keyword\">as</span> mp\n\np <span class=\"token operator\">=</span> mp<span class=\"token punctuation\">.</span>Process<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span><span class=\"token string\">'ë“¤ì–´ê°ˆ í”„ë¡œê·¸ë¨/í•¨ìˆ˜'</span><span class=\"token punctuation\">,</span> args<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token string\">'í•¨ìˆ˜ì˜ ì¸ì'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\np<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># í”„ë¡œì„¸ìŠ¤ ì‹œì‘</span>\np<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># ì‹¤ì œ ì¢…ë£Œê¹Œì§€ ê¸°ë‹¤ë¦¼ (í•„ìš”ì‹œì—ë§Œ ì‚¬ìš©)</span>\np<span class=\"token punctuation\">.</span>terminate<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">\n<span class=\"token keyword\">def</span> <span class=\"token function\">fitness</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'exercising...'</span><span class=\"token punctuation\">)</span>\n\np <span class=\"token operator\">=</span> mp<span class=\"token punctuation\">.</span>Process<span class=\"token punctuation\">(</span>target<span class=\"token operator\">=</span>fitness<span class=\"token punctuation\">,</span> args<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\np<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">delivering...</code></pre></div>\n<p>ë©€í‹° í”„ë¡œì„¸ìŠ¤ë„ <code class=\"language-text\">thread</code> ì™€ ë™ì¼í•˜ê²Œ êµ¬í˜„ê°€ëŠ¥í•˜ë‹¤</p>\n<hr>\n<h2 id=\"ì‹¤ì œ-ì½”ë”©-ì‹œ-ì ìš©ë°©ë²•\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%EC%A0%9C-%EC%BD%94%EB%94%A9-%EC%8B%9C-%EC%A0%81%EC%9A%A9%EB%B0%A9%EB%B2%95\" aria-label=\"ì‹¤ì œ ì½”ë”© ì‹œ ì ìš©ë°©ë²• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‹¤ì œ ì½”ë”© ì‹œ ì ìš©ë°©ë²•</h2>\n<p>ê²°êµ­ ìš°ë¦¬ê°€ ì´ëŸ° ê±¸ í•˜ëŠ” ì´ìœ ëŠ” ë” íš¨ìœ¨ì ì´ê³  ë¹ ë¥¸ í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.</p>\n<p>ê·¸ëŸ°ë° ëª¨ë“  í•¨ìˆ˜ë§ˆë‹¤ ì´ë ‡ê²Œ ë³‘ë ¬ì²˜ë¦¬ë¥¼ í•´ì£¼ëŠ” ê²Œ ë” ê·€ì°®ê³  ì‹œê°„ì´ ë§ì´ë“ ë‹¤.</p>\n<p>ë•Œë¬¸ì— íŒŒì´ì¬ì—ì„œëŠ” ì´ ë³‘ë ¬ì²˜ë¦¬ ë° multi-tasking ì„ ìë™ìœ¼ë¡œ í•´ì£¼ëŠ” ëª¨ë“ˆì´ ìˆë‹¤.</p>\n<p><code class=\"language-text\">concurrent.futures</code> ì´ê²ƒì´ë‹¤.</p>\n<p><a href=\"https://docs.python.org/ko/3.7/library/concurrent.futures.html\">ê³µì‹ë¬¸ì„œ</a></p>\n<p>ë§Œì•½ ë³‘ë ¬ë¡œ ì²˜ë¦¬í•˜ê³  ì‹¶ì€ ì½”ë“œê°€ ìˆë‹¤ë©´ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œì—</p>\n<p>ë³‘ë ¬ì„ ì›í•˜ëŠ” í•¨ìˆ˜ë¥¼ <code class=\"language-text\">func</code> ì— ë„£ì–´ ì‚¬ìš©í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> concurrent\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">with</span> concurrent<span class=\"token punctuation\">.</span>futures<span class=\"token punctuation\">.</span>ProcessPoolExecutor<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> executor<span class=\"token punctuation\">:</span>\n        \n        <span class=\"token keyword\">for</span> output <span class=\"token keyword\">in</span> executor<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span> func <span class=\"token punctuation\">,</span> data <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># data ë¥¼ func ë¡œ ì²˜ë¦¬.</span>\n            <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">'%d is prime: %s'</span> <span class=\"token operator\">%</span> <span class=\"token punctuation\">(</span>output<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#ëª¨ë“  sequence ë°ì´í„°ê°€ ë™ì‹œì²˜ë¦¬ë¨</span>\n</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%8F%99%EC%8B%9C%EC%84%B1%EA%B3%BC-%EB%B3%91%EB%A0%AC%EC%84%B1\">ë™ì‹œì„±ê³¼ ë³‘ë ¬ì„±</a></p>\n</li>\n<li>\n<p><a href=\"#process-thread--profiling\">process, thread , profiling</a></p>\n<ul>\n<li><a href=\"#process\">Process</a></li>\n<li><a href=\"#thread\">Thread</a></li>\n<li><a href=\"#profiling\">profiling</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#multi-tasking\">Multi-tasking</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%8B%A4%EC%8A%B5\">ì‹¤ìŠµ</a></p>\n<ul>\n<li><a href=\"#thread-1\">thread</a></li>\n<li><a href=\"#multi---process\">multi - process</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%8B%A4%EC%A0%9C-%EC%BD%94%EB%94%A9-%EC%8B%9C-%EC%A0%81%EC%9A%A9%EB%B0%A9%EB%B2%95\">ì‹¤ì œ ì½”ë”© ì‹œ ì ìš©ë°©ë²•</a></p>\n</li>\n</ul>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"></code></pre></div>","frontmatter":{"date":"February 23, 2022","title":"íŒŒì´ì¬ í•¨ìˆ˜ ë³‘ë ¬ ì²˜ë¦¬","categories":"Python","author":"í•˜ì„±ë¯¼","emoji":"ğŸ‘©â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦"},"fields":{"slug":"/python_tasking/"}},"site":{"siteMetadata":{"siteUrl":"https://xman227.github.io","comments":{"utterances":{"repo":"xman227/blog_comments"}}}}},"pageContext":{"slug":"/DML_recommend/","nextSlug":"/DML_keras/","prevSlug":"/python_tasking/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}