{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/DML_AI1/",
    "result": {"data":{"cur":{"id":"178ea2b3-2dfd-599d-86ad-b2669c612f60","html":"<h1 id=\"span-stylebackground-color-fff4f5ì¸ê³µì§€ëŠ¥-ê¸°ì´ˆ-ï¸-ì‚¬ì§„-ë¶„ë¥˜-í”„ë¡œê·¸ë¨-ë§›ë³´ê¸°span\" style=\"position:relative;\"><a href=\"#span-stylebackground-color-fff4f5%EC%9D%B8%EA%B3%B5%EC%A7%80%EB%8A%A5-%EA%B8%B0%EC%B4%88-%EF%B8%8F-%EC%82%AC%EC%A7%84-%EB%B6%84%EB%A5%98-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EB%A7%9B%EB%B3%B4%EA%B8%B0span\" aria-label=\"span stylebackground color fff4f5ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ ï¸ ì‚¬ì§„ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ë§›ë³´ê¸°span permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><span style='background-color: #fff4f5'>ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ ğŸš¶â€â™‚ï¸: ì‚¬ì§„ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ë§›ë³´ê¸°</span></h1>\n<h2 id=\"ê°•ì•„ì§€--ê³ ì–‘ì´-ë¶„ë¥˜-í”„ë¡œê·¸ë¨-ì œì‘-\" style=\"position:relative;\"><a href=\"#%EA%B0%95%EC%95%84%EC%A7%80--%EA%B3%A0%EC%96%91%EC%9D%B4-%EB%B6%84%EB%A5%98-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EC%A0%9C%EC%9E%91-\" aria-label=\"ê°•ì•„ì§€  ê³ ì–‘ì´ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ì œì‘  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê°•ì•„ì§€ &#x26; ê³ ì–‘ì´ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ì œì‘ !</h2>\n<h3 id=\"content\" style=\"position:relative;\"><a href=\"#content\" aria-label=\"content permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Content</h3>\n<ol>\n<li>ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (Tensor Flow)</li>\n<li>ë°ì´í„° ì „ì²˜ë¦¬</li>\n<li>ëª¨ë¸ ìƒì„± (ìì²´ ìƒì„± ëª¨ë¸)</li>\n<li>í•™ìŠµ ë° í‰ê°€</li>\n</ol>\n<p><strong>ì‹œì‘í•˜ê¸°ì— ì•ì„œ, ì´ë²ˆ ê²Œì‹œê¸€ì€<br>\nì „ì²´ì ì¸ ì¸ê³µì§€ëŠ¥ ì ìš©ì— ëŒ€í•œ ë§¥ë½ì„ ì„¤ëª…í•˜ê¸° ìœ„í•œ ê¸€ì…ë‹ˆë‹¤.<br>\nì•„ì£¼ ê°„ë‹¨í•œ Deep Learning Layer ëª‡ ì¢…ë¥˜ë¥¼ ì´ìš©í–ˆìŠµë‹ˆë‹¤.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>tf<span class=\"token punctuation\">.</span>__version__ <span class=\"token punctuation\">,</span> <span class=\"token string\">'ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ì„ ë§Œë“¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ tensor flow ì…ë‹ˆë‹¤'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">2.6.0 ì´ë¯¸ì§€ ë¶„ë¥˜ ëª¨ë¸ì„ ë§Œë“¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ tensor flow ì…ë‹ˆë‹¤</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow_datasets <span class=\"token keyword\">as</span> tfds\n\ntfds<span class=\"token punctuation\">.</span>__version__</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">'4.4.0'</code></pre></div>\n<p>tensor flow ì—ì„œëŠ” ë‹¤ì–‘í•œ ë°ì´í„°ì…‹ì„ ì´ë¯¸ ì œê³µí•˜ê³  ìˆë‹¤.<br>\nê°•ì•„ì§€ê³ ì–‘ì´, ìŒì„±, ì´ë¯¸ì§€, í…ìŠ¤íŠ¸ ë°ì´í„°ì…‹ ë³´ìœ í•˜ê³  ìˆìœ¼ë‹ˆ ì„¸ë¶€ ë‚´ìš© í™•ì¸í•´ë³´ê³  ì‹¶ìŒ í•´ë³´ê¸°</p>\n<p><a href=\"https://www.tensorflow.org/datasets/catalog/overview\">tensor flow link</a></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token punctuation\">(</span>raw_train<span class=\"token punctuation\">,</span> raw_validation<span class=\"token punctuation\">,</span> raw_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> metadata <span class=\"token operator\">=</span> tfds<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'cats_vs_dogs'</span><span class=\"token punctuation\">,</span>\n    split<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'train[:80%]'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'train[80%:90%]'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'train[90%:]'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    with_info<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    as_supervised<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\u001b[1mDownloading and preparing dataset 786.68 MiB (download: 786.68 MiB, generated: Unknown size, total: 786.68 MiB) to /aiffel/tensorflow_datasets/cats_vs_dogs/4.0.0...\u001b[0m\n\n\n\nDl Completed...: 0 url [00:00, ? url/s]\n\n\n\nDl Size...: 0 MiB [00:00, ? MiB/s]\n\n\n\nGenerating splits...:   0%|          | 0/1 [00:00&lt;?, ? splits/s]\n\n\n\nGenerating train examples...:   0%|          | 0/23262 [00:00&lt;?, ? examples/s]\n\n\nWARNING:absl:1738 images were corrupted and were skipped\n\n\n\nShuffling cats_vs_dogs-train.tfrecord...:   0%|          | 0/23262 [00:00&lt;?, ? examples/s]\n\n\n\u001b[1mDataset cats_vs_dogs downloaded and prepared to /aiffel/tensorflow_datasets/cats_vs_dogs/4.0.0. Subsequent calls will reuse this data.\u001b[0m</code></pre></div>\n<hr>\n<p>â€œWARNING:absl:1738 images were corrupted and were skippedâ€ë¼ëŠ” ê²½ê³ ê°€ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ì„  ë¬´ì‹œí•˜ì‹œë©´ ë©ë‹ˆë‹¤.<br>\n1738 ì¥ì˜ ì‚¬ì§„ì€ ì“¸ ìˆ˜ ì—†ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤.<br>\nì´ëŸ° ê²ƒë“¤ì€ tf ì‚¬ì´íŠ¸ ë°ì´í„°ì…‹ ì„¤ëª…ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤</p>\n<p><img src=\"/a0b5d21d105e7623091003cd8f24e715/1.png\" alt=\"PNG\"></p>\n<p>1738ì´ currupted ë˜ì–´ìˆë‹¤ ë˜ì–´ìˆì ¸?<br>\nê·¸ë¦¬ê³  ë°‘ì— Splitì„ ë³´ë©´ 23262 ì¥ì˜ ì‚¬ì§„ì´ ìˆìŒì„ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>raw_train<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>raw_validation<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>raw_test<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;PrefetchDataset shapes: ((None, None, 3), ()), types: (tf.uint8, tf.int64)>\n&lt;PrefetchDataset shapes: ((None, None, 3), ()), types: (tf.uint8, tf.int64)>\n&lt;PrefetchDataset shapes: ((None, None, 3), ()), types: (tf.uint8, tf.int64)></code></pre></div>\n<p>ì˜ ë³€ìˆ˜ë¡œ ì§€ì •ë˜ì–´ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>\n<p>ëª¨ë“  ë°ì´í„°ì…‹ì€ (image, label)ì˜ í˜•íƒœë¥¼ ê°€ì§‘ë‹ˆë‹¤.<br>\n((None, None, 3), ())ê°€ ì´ë¥¼ ë‚˜íƒ€ë‚´ì£ .</p>\n<p>ì—¬ê¸°ì—ì„œ ì•ì— ìˆëŠ” (None, None, 3)ì€ imageì˜ shapeë¥¼,<br>\në’¤ì˜ ()ëŠ” ì •ë‹µ ì¹´í…Œê³ ë¦¬ì¸ labelì˜ shapeë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>\n<p>ì´ë¯¸ì§€ëŠ” (height, width, channel)ë¡œ 3ì°¨ì› ë°ì´í„°ì´ê¸° ë•Œë¬¸ì—<br>\n(None, None, 3)ê³¼ ê°™ì´ ë‚˜íƒ€ë‚¬ìŠµë‹ˆë‹¤.</p>\n<p>ì´ë•Œ heightì™€ widthê°€ Noneìœ¼ë¡œ ë‚˜íƒ€ë‚œ ì´ìœ ëŠ”<br>\nëª¨ë“  ì‚¬ì§„ë“¤ì˜ í¬ê¸°ê°€ ì œê°ê°ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.<br>\ní•˜ë‚˜ì˜ ê°’ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ì—†ìœ¼ë‹ˆ None ìœ¼ë¡œ í‘œê¸°ë©ë‹ˆë‹¤.</p>\n<h2 id=\"1-ë°ì´í„°-ì „ì²˜ë¦¬\" style=\"position:relative;\"><a href=\"#1-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC\" aria-label=\"1 ë°ì´í„° ì „ì²˜ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ë°ì´í„° ì „ì²˜ë¦¬</h2>\n<p>ì ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™”ìœ¼ë‹ˆ ê¹”ë”í•˜ê²Œ ì²˜ë¦¬í•´ì•¼ì§€</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>config InlineBackend<span class=\"token punctuation\">.</span>figure_format <span class=\"token operator\">=</span> <span class=\"token string\">'retina'</span></code></pre></div>\n<p>ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ê³ ë¯¼í•˜ê¸° ìœ„í•´ì„œ ìš°ë¦¬ê°€ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼<br>\nìŠ¤ë¦¬ìŠ¬ì© ë“¤ì—¬ë‹¤ ë³´ì.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#ì „ì²´ ì¹¸ë°”ìŠ¤ í¬ê¸°</span>\n\nget_label_name <span class=\"token operator\">=</span> metadata<span class=\"token punctuation\">.</span>features<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>int2str \n\n<span class=\"token keyword\">for</span> idx<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>raw_train<span class=\"token punctuation\">.</span>take<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>  <span class=\"token comment\"># 10ê°œì˜ ë°ì´í„°ë¥¼ ë”°ë¡œ ê°€ì ¸ ì˜µë‹ˆë‹¤.</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> idx<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">#10ê°œì˜ ì‚¬ì§„ì„ êº¼ë‚´ë³´ê² ìŒ íŒ êº¼ëƒ„</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'label </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>label<span class=\"token punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>get_label_name<span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>axis<span class=\"token punctuation\">(</span><span class=\"token string\">'off'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.222222222222214%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAADNUlEQVQozwEqA9X8AIqJkgD//98A////AMO5kgB3WDdNSEEedTo8GXVNPhk/ZaBgEHmIfyydqbYmQ1NdExwaDgDtw1sA+tJ9AINtQwDq4d4A////APPr5AD+//8AAFRRVXZ3b1uhs6N3pberglF4UzK5Uz8l/084If9nSSKWfZBZlauFYPGwinHwXFdTjxsNAFlZSSOsdWE0qW1YK2GQjItZeXNvqm9rZ6WMi41yAH99cNVdUET/aFQ9/5eHYphRSiCoaDIj/2kxIP9URSCKfn9YrJh7Z/+WdWD/kXdknRgcHalJQC//gXRf/3RnVLJHRUGgOjs3/1FQSf9+cmfIAJGOd6pnWETjVlA16V1YP3hmWy66djUh/2w8Hv9BQxWWmqiFsoKQcP98gWz/vr22p2VQLoNrVTHpkH5k6W1lWY1xa2eBf3t365GKhOeWiIGhAFNcVgs1RDgPP15WEGeUaARIQiCARywXuXBNJrpdVSVojaKGNXuSWVxlc0hbqbCpOUAAAAeWdT0TemUwEkY3CQz///8B////Av///wH///8BAP///wAAAAACAAAAAf/h3wAHDjcdAA4wNgAJJC8NF0YZXmtnAKaqfQCZkWkApKqsAC8ZAwDm3M0Aq6SWAD88NgAREhYsV1NCWi8sGlcqKBk3AGJdTqPPo4nb166a4bl+bHNZUEKsiXZc/3BlVf86NDKUP0hXQntxaYKWf2d5goWQQhwXFEGPjo58amhneywsMz5PTDSRWFI0/1tTMP9EPya3AGhgVcqWemj/hnRq/7mUh5CegU2sqoxe/6KLaP+FZz2MQlBmtaejoP+2nYX/fIGIplZSUaSOhID/cmxo/0xKS6xeVzN/VFE//1ZSPP9KQyypAIh9bs+akob/l5KH/761qpSrmnezvJ9t/6mQav92bmOTW2h/p4OJlP+IhYL/dXyCm15XUZtwZ2H/d3Fq/2xmYaIrKBiEdXRs/3Jya/9CPSqvAIVxX22snYuRs6eWlcO2oUyFgnqOspRn156Se9ZtdHh8e36JEoSJkCuIk5gqp6mqGFZPSRlxb2csfXZtLq2clBBBQDKBmZmT+Lm2svZJRDOf3gpvCUkCLewAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/d16b019357261570c527d6ef9965d80a/37523/output_13_0.png\"\n        srcset=\"/static/d16b019357261570c527d6ef9965d80a/e9ff0/output_13_0.png 180w,\n/static/d16b019357261570c527d6ef9965d80a/f21e7/output_13_0.png 360w,\n/static/d16b019357261570c527d6ef9965d80a/37523/output_13_0.png 720w,\n/static/d16b019357261570c527d6ef9965d80a/302a4/output_13_0.png 1080w,\n/static/d16b019357261570c527d6ef9965d80a/ee3fb/output_13_0.png 1144w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ì ë´ë¼, ì´ë¯¸ì§€ í¬ê¸°ê°€ ë‹¤ ì œê°ê°ì´ë„¤?</p>\n<p>ì˜¬ë°”ë¥¸ í•™ìŠµì„ ìœ„í•´ì„œëŠ” ì´ë¯¸ì§€ ì‚¬ì´ì¦ˆë¶€í„° ì œëŒ€ë¡œ ë§ì¶°ì¤˜ì•¼ í•œë‹¤.</p>\n<p>format_example() í•¨ìˆ˜ë¡œ ì´ë¯¸ì§€ë¥¼ ê°™ì€ í¬ë©§ìœ¼ë¡œ ë§ì¶¥ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">IMG_SIZE <span class=\"token operator\">=</span> <span class=\"token number\">160</span> <span class=\"token comment\"># ë¦¬ì‚¬ì´ì§•í•  ì´ë¯¸ì§€ì˜ í¬ê¸°</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">format_example</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    image <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>cast<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># image=float(image)ê°™ì€ íƒ€ì…ìºìŠ¤íŒ…ì˜  í…ì„œí”Œë¡œìš° ë²„ì „ì…ë‹ˆë‹¤.</span>\n    image <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>image<span class=\"token operator\">/</span><span class=\"token number\">127.5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token comment\"># í”½ì…€ê°’ì˜ scale ìˆ˜ì •</span>\n    image <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>IMG_SIZE<span class=\"token punctuation\">,</span> IMG_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> image<span class=\"token punctuation\">,</span> label</code></pre></div>\n<p>í”½ì…€ê°’ì˜ scale ì„ ìˆ˜ì •í–‡ë‹¤ëŠ” ê²ƒì€ í”½ì…€ê°’ì„ ì •ê·œí™”í–‡ë‹¤ëŠ” ë§ê³¼ ê·¼ì‚¬í•˜ë‹¤.<br>\n0~ 255ì¸ í”½ì…€ê°’ì„ 127.5ë¡œ ë‚˜ëˆ„ë©´ 0~ 2ê°€ëœë‹¤. ê·¸ê±¸ 1ë¡œ ëºìœ¼ë‹ˆ<br>\n-1~1 ì‚¬ì´ì˜ ê°’ìœ¼ë¡œ ë³€í–ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">train <span class=\"token operator\">=</span> raw_train<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>format_example<span class=\"token punctuation\">)</span>\nvalidation <span class=\"token operator\">=</span> raw_validation<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>format_example<span class=\"token punctuation\">)</span>\ntest <span class=\"token operator\">=</span> raw_test<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>format_example<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>train<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>validation<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>test<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;MapDataset shapes: ((160, 160, 3), ()), types: (tf.float32, tf.int64)>\n&lt;MapDataset shapes: ((160, 160, 3), ()), types: (tf.float32, tf.int64)>\n&lt;MapDataset shapes: ((160, 160, 3), ()), types: (tf.float32, tf.int64)></code></pre></div>\n<p>map ë©”ì„œë“œë¡œ ëª¨ë“  raw_** ì˜ ì •ë³´ë¥¼ format_example ì˜ í•¨ìˆ˜ë¡œ ë³€í™˜ì‹œì¼œì£¼ì—ˆë‹¤.<br>\në³€í™˜ëœ í›„ì˜ ë‚´ìš©ë¬¼ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\nget_label_name <span class=\"token operator\">=</span> metadata<span class=\"token punctuation\">.</span>features<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>int2str\n\n<span class=\"token keyword\">for</span> idx<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>train<span class=\"token punctuation\">.</span>take<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> idx<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    image <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>image <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'label </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>label<span class=\"token punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>get_label_name<span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>axis<span class=\"token punctuation\">(</span><span class=\"token string\">'off'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAADNUlEQVQozwEqA9X8AFVQQz6LiGA8iYpjLaqATg9FOB5BLzYROS4uETd1hUwNboNbOLayrzyCiIw9NT09D11FEC1aSiFAXUsbO2dNDRdmZWghR0RBQVdRTzx/fX0uAGdgVf6smnL/uKV8xI1tS2pkSCr/OzQe9l8/IexxgURcioJW6ryGYveWe2j/NjUyZyIZA8toVy/8eWY//29dN4SNiIWhfHhz/29rZ/aVk5PkAF5VS/88Jx7/d2VMyW5vN25kQCP/ayoh/l09IPJgcTtgiHde8p1/b/+Nblf/hndsaxgdIdJPRjj/f3Zp/3FnV4kuLSimGx8Z/zM2Lf1yZFXrAHZnVf9hVTb/ZFtC1WZoNHRiPyX/fzQd/1NFHv9ueklllaKC/3iFaP+PkIL/xsK7cVJELN10Xz3/l4l3/2deUpFmYV2vendz/5GJhP+WiID4AFtURmpUWkFrQkc8UlBPJy48MBxsXDwgZ2lYL2NsdU8oj6N8Ymh/P2d2gWhryMa4LH1SD1WDYitpdmA4blpOMjjPxcJEw7m1brSsqmeqoqFhAP/60AD///cA28a0AElFKAD/4HcA//+xAKeMTgBFTj4A///lAP//kgDb3rYApqefANafTQD//9UA48OPAHRrVQD/+dkA////AP///wDEuKcAALOPdsLovqfCyJR/lkQ4OkxZUEbGbGVavDo2N7EhJTRBZGZtsqOMdr6Xh3m/aHKGSjo0MJqvrq7BW1lWxz4+QWNHRTh4Xlg8yVBJLLxCPSerAJ9/a/+PeW3/uJCB04RsTnSef1D/n4ts/4tzUP8vLTBlbniF/cazoP+oloT/ZHCAcW1nZNyUiYb/Z2Jf/0xLS5BbVTOvT0s0/1tUOP9IQir3AJqQg/94dW//t6uey6OXgW+5nm3/sZNl/52JbPVDRlJganiO9KGbmP+IgXz/X2lxbGVcVtN3bWj/cGtl/19cWYo4NCGofn53/2xtZ/9IQi/tAK+gjuWqoJLmy72nsHl+gGChjnHprZNq3oSGgtReZm1UeX+P032Dit+AhYjlgoWHXVxVT7d1cGnke3Rs7HFqY3hBQjaRmpqV7cvIw91GQTHOUnqDylKzWK4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/1271a3703b5b224b0557b0d74541dd9c/37523/output_19_0.png\"\n        srcset=\"/static/1271a3703b5b224b0557b0d74541dd9c/e9ff0/output_19_0.png 180w,\n/static/1271a3703b5b224b0557b0d74541dd9c/f21e7/output_19_0.png 360w,\n/static/1271a3703b5b224b0557b0d74541dd9c/37523/output_19_0.png 720w,\n/static/1271a3703b5b224b0557b0d74541dd9c/302a4/output_19_0.png 1080w,\n/static/1271a3703b5b224b0557b0d74541dd9c/ee3fb/output_19_0.png 1144w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ë°ì´í„° ì „ì²˜ë¦¬ ë~</p>\n<hr>\n<h2 id=\"2-ëª¨ë¸-ìƒì„±-ë°-í•™ìŠµ\" style=\"position:relative;\"><a href=\"#2-%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%95%99%EC%8A%B5\" aria-label=\"2 ëª¨ë¸ ìƒì„± ë° í•™ìŠµ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2 ëª¨ë¸ ìƒì„± ë° í•™ìŠµ</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>models <span class=\"token keyword\">import</span> Sequential\n<span class=\"token keyword\">from</span> tensorflow<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers <span class=\"token keyword\">import</span> Dense<span class=\"token punctuation\">,</span> Conv2D<span class=\"token punctuation\">,</span> Flatten<span class=\"token punctuation\">,</span> MaxPooling2D\n</code></pre></div>\n<p>models ì—ëŠ” ëª¨ë¸ ìì²´ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•œ í•¨ìˆ˜ê°€ ìˆê³   ê·¸ ì•ˆì˜ Sequential í•¨ìˆ˜ ì•ˆì— ì—¬ëŸ¬ê°€ì§€ layer ë“¤ì´ ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‹¤.<br>\nlayers ì—ëŠ” ëª¨ë¸ì˜ êµ¬ì„± ìš”ì†Œì¸ ì—¬ëŸ¬ê°€ì§€ ì¢…ë¥˜ì˜ layer(ì¸µ) í•¨ìˆ˜ë“¤ì„ ê°€ì§€ê³  ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model <span class=\"token operator\">=</span> Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    Conv2D<span class=\"token punctuation\">(</span>filters<span class=\"token operator\">=</span><span class=\"token number\">16</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">,</span> input_shape<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">,</span> <span class=\"token number\">160</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    MaxPooling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    Conv2D<span class=\"token punctuation\">(</span>filters<span class=\"token operator\">=</span><span class=\"token number\">32</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    MaxPooling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    Conv2D<span class=\"token punctuation\">(</span>filters<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> kernel_size<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">=</span><span class=\"token string\">'same'</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    MaxPooling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    Flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    Dense<span class=\"token punctuation\">(</span>units<span class=\"token operator\">=</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    Dense<span class=\"token punctuation\">(</span>units<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ë”¥ëŸ¬ë‹ì—ì„œëŠ” <strong>ë ˆì´ì–´</strong> ë¼ëŠ” ê°œë…ì„ ìì„¸í•˜ê²Œ ê³µë¶€í•œë‹¤.<br>\nì—¬ê¸°ì„œëŠ”</p>\n<ul>\n<li>Conv2D</li>\n<li>MaxPooling2D</li>\n<li>Flatten</li>\n<li>Dense</li>\n</ul>\n<p>ë¼ëŠ” ë„¤ ë ˆì´ì–´ë¥¼ ì‚¬ìš©í–ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model: \"sequential_1\"\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d_3 (Conv2D)            (None, 160, 160, 16)      448       \n_________________________________________________________________\nmax_pooling2d_3 (MaxPooling2 (None, 80, 80, 16)        0         \n_________________________________________________________________\nconv2d_4 (Conv2D)            (None, 80, 80, 32)        4640      \n_________________________________________________________________\nmax_pooling2d_4 (MaxPooling2 (None, 40, 40, 32)        0         \n_________________________________________________________________\nconv2d_5 (Conv2D)            (None, 40, 40, 64)        18496     \n_________________________________________________________________\nmax_pooling2d_5 (MaxPooling2 (None, 20, 20, 64)        0         \n_________________________________________________________________\nflatten_1 (Flatten)          (None, 25600)             0         \n_________________________________________________________________\ndense_2 (Dense)              (None, 512)               13107712  \n_________________________________________________________________\ndense_3 (Dense)              (None, 2)                 1026      \n=================================================================\nTotal params: 13,132,322\nTrainable params: 13,132,322\nNon-trainable params: 0\n_________________________________________________________________</code></pre></div>\n<p>ëª¨ë¸ì„ ë§Œë“¤ì—ˆìœ¼ë‹ˆ í•™ìŠµì‹œì¼œë³´ì.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">learning_rate <span class=\"token operator\">=</span> <span class=\"token number\">0.0001</span>\nmodel<span class=\"token punctuation\">.</span><span class=\"token builtin\">compile</span><span class=\"token punctuation\">(</span>optimizer<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>optimizers<span class=\"token punctuation\">.</span>RMSprop<span class=\"token punctuation\">(</span>lr<span class=\"token operator\">=</span>learning_rate<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n              loss<span class=\"token operator\">=</span>tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>losses<span class=\"token punctuation\">.</span>sparse_categorical_crossentropy<span class=\"token punctuation\">,</span>\n              metrics<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'accuracy'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>í•™ìŠµì‹œí‚¤ê¸° ìœ„í•´ì„œëŠ” Optimer , Loss, Metrics ê°€ í•„ìš”í•˜ë‹¤.</p>\n<p>opt : í•™ìŠµì„ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì‹œí‚¬ ê²ƒì¸ì§€<br>\nloss : ëª¨ë¸ì´ í•™ìŠµí•´ë‚˜ê°€ì•¼ í•  ë°©í–¥ (ì´ ê²½ìš°ëŠ” í™•ë¥ ë¶„í¬)<br>\nmetrics : [accuracy, precision, recall]</p>\n<p>ì•„ì§ì€ ì‹¤í–‰í•˜ê¸° ì „ì´ë‹¤. ì§€ê¸ˆì€ ì‚¬ì „ ì‘ì—…ë§Œ ê±°ì¹œ ìƒíƒœ</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">BATCH_SIZE <span class=\"token operator\">=</span> <span class=\"token number\">32</span>\nSHUFFLE_BUFFER_SIZE <span class=\"token operator\">=</span> <span class=\"token number\">1000</span>\n\ntrain_batches <span class=\"token operator\">=</span> train<span class=\"token punctuation\">.</span>shuffle<span class=\"token punctuation\">(</span>SHUFFLE_BUFFER_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>batch<span class=\"token punctuation\">(</span>BATCH_SIZE<span class=\"token punctuation\">)</span>\nvalidation_batches <span class=\"token operator\">=</span> validation<span class=\"token punctuation\">.</span>batch<span class=\"token punctuation\">(</span>BATCH_SIZE<span class=\"token punctuation\">)</span>\ntest_batches <span class=\"token operator\">=</span> test<span class=\"token punctuation\">.</span>batch<span class=\"token punctuation\">(</span>BATCH_SIZE<span class=\"token punctuation\">)</span></code></pre></div>\n<p>ì´ë ‡ê²Œ train ë°ì´í„°ë¥¼ í†µìœ¼ë¡œ ë„£ì§€ ì•Šê³  32ê°œì”© ëŠì–´ ë„£ëŠ” ì´ìœ ëŠ”\nëœë¤í•œ 32ê°œì˜ ì‚¬ì§„ë“¤ì„ ë¬¶ì–´ ì—¬ëŸ¬ê°œì˜ Decision Tree ë¥¼ ë§Œë“¤ì–´ ansamble í•˜ê¸° ìœ„í•¨</p>\n<p>train_batches ì˜ ë°ì´í„°ë¥¼ í™•ì¸í•´ë³´ì</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> image_batch<span class=\"token punctuation\">,</span> label_batch <span class=\"token keyword\">in</span> train_batches<span class=\"token punctuation\">.</span>take<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">pass</span>\n\nimage_batch<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">,</span> label_batch<span class=\"token punctuation\">.</span>shape</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(TensorShape([32, 160, 160, 3]), TensorShape([32]))</code></pre></div>\n<p>ëª¨ë¸ í•™ìŠµ ì „ì— ì´ˆê¸° ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•´ë³¼ê¹Œ? validation data ë¡œ ëª¨ë¸ì„ í‰ê°€í•´ë³´ì<br>\n20ë²ˆì˜ ì˜ˆì¸¡ì„ í•´ë³´ê³  loss ì™€ accuracyë¥¼ êµ¬í•´ë³´ì</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">validation_steps <span class=\"token operator\">=</span> <span class=\"token number\">20</span>\nloss0<span class=\"token punctuation\">,</span> accuracy0 <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>evaluate<span class=\"token punctuation\">(</span>validation_batches<span class=\"token punctuation\">,</span> steps<span class=\"token operator\">=</span>validation_steps<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"initial loss: {:.2f}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>loss0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"initial accuracy: {:.2f}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>accuracy0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">10/20 [==============>...............] - ETA: 0s - loss: 0.6924 - accuracy: 0.5156\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\n\n\n20/20 [==============================] - 3s 32ms/step - loss: 0.6919 - accuracy: 0.5172\ninitial loss: 0.69\ninitial accuracy: 0.52\n\n\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9</code></pre></div>\n<p>ë³´ë©´ ì•„ë¬´ê²ƒë„ í•˜ê¸° ì „ì— ëª¨ë¸ evaluate ëŠ” ê± ë­ ì•„ë¬´ê²ƒë„ ëª¨ë¥¸ë‹¤.\nì´ì œ ì´ê±¸ í•™ìŠµì‹œì¼œë³´ì</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">EPOCHS <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\nhistory <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>fit<span class=\"token punctuation\">(</span>train_batches<span class=\"token punctuation\">,</span>\n                    epochs<span class=\"token operator\">=</span>EPOCHS<span class=\"token punctuation\">,</span>\n                    validation_data<span class=\"token operator\">=</span>validation_batches<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Epoch 1/10\n170/582 [=======>......................] - ETA: 18s - loss: 0.5444 - accuracy: 0.7250\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n202/582 [=========>....................] - ETA: 17s - loss: 0.5408 - accuracy: 0.7274\n\nWarning: unknown JFIF revision number 0.00\n\n\n212/582 [=========>....................] - ETA: 16s - loss: 0.5427 - accuracy: 0.7258\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n284/582 [=============>................] - ETA: 13s - loss: 0.5408 - accuracy: 0.7272\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n492/582 [========================>.....] - ETA: 3s - loss: 0.5280 - accuracy: 0.7363\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n504/582 [========================>.....] - ETA: 3s - loss: 0.5277 - accuracy: 0.7360\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n516/582 [=========================>....] - ETA: 2s - loss: 0.5271 - accuracy: 0.7372\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n542/582 [==========================>...] - ETA: 1s - loss: 0.5269 - accuracy: 0.7374\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n550/582 [===========================>..] - ETA: 1s - loss: 0.5271 - accuracy: 0.7372\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - ETA: 0s - loss: 0.5259 - accuracy: 0.7389\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 29s 48ms/step - loss: 0.5259 - accuracy: 0.7389 - val_loss: 0.5102 - val_accuracy: 0.7502\nEpoch 2/10\n169/582 [=======>......................] - ETA: 18s - loss: 0.4561 - accuracy: 0.7898\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n201/582 [=========>....................] - ETA: 16s - loss: 0.4553 - accuracy: 0.7886\n\nWarning: unknown JFIF revision number 0.00\n\n\n213/582 [=========>....................] - ETA: 16s - loss: 0.4548 - accuracy: 0.7893\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n283/582 [=============>................] - ETA: 13s - loss: 0.4483 - accuracy: 0.7911\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n492/582 [========================>.....] - ETA: 3s - loss: 0.4446 - accuracy: 0.7943\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n506/582 [=========================>....] - ETA: 3s - loss: 0.4450 - accuracy: 0.7947\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n516/582 [=========================>....] - ETA: 2s - loss: 0.4445 - accuracy: 0.7951\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n542/582 [==========================>...] - ETA: 1s - loss: 0.4437 - accuracy: 0.7953\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n548/582 [===========================>..] - ETA: 1s - loss: 0.4433 - accuracy: 0.7952\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n580/582 [============================>.] - ETA: 0s - loss: 0.4425 - accuracy: 0.7956\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 28s 47ms/step - loss: 0.4422 - accuracy: 0.7958 - val_loss: 0.5503 - val_accuracy: 0.7386\nEpoch 3/10\n169/582 [=======>......................] - ETA: 18s - loss: 0.3937 - accuracy: 0.8229\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n201/582 [=========>....................] - ETA: 16s - loss: 0.3927 - accuracy: 0.8232\n\nWarning: unknown JFIF revision number 0.00\n\n\n213/582 [=========>....................] - ETA: 16s - loss: 0.3927 - accuracy: 0.8234\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n283/582 [=============>................] - ETA: 13s - loss: 0.3870 - accuracy: 0.8266\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n492/582 [========================>.....] - ETA: 3s - loss: 0.3836 - accuracy: 0.8281\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n506/582 [=========================>....] - ETA: 3s - loss: 0.3843 - accuracy: 0.8278\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n516/582 [=========================>....] - ETA: 2s - loss: 0.3836 - accuracy: 0.8281\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n543/582 [==========================>...] - ETA: 1s - loss: 0.3820 - accuracy: 0.8288\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n549/582 [===========================>..] - ETA: 1s - loss: 0.3814 - accuracy: 0.8292\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n581/582 [============================>.] - ETA: 0s - loss: 0.3800 - accuracy: 0.8289\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 28s 47ms/step - loss: 0.3799 - accuracy: 0.8290 - val_loss: 0.4954 - val_accuracy: 0.7674\nEpoch 4/10\n169/582 [=======>......................] - ETA: 18s - loss: 0.3449 - accuracy: 0.8460\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n201/582 [=========>....................] - ETA: 16s - loss: 0.3404 - accuracy: 0.8469\n\nWarning: unknown JFIF revision number 0.00\n\n\n213/582 [=========>....................] - ETA: 16s - loss: 0.3395 - accuracy: 0.8480\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n283/582 [=============>................] - ETA: 12s - loss: 0.3357 - accuracy: 0.8520\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n492/582 [========================>.....] - ETA: 3s - loss: 0.3270 - accuracy: 0.8581\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n506/582 [=========================>....] - ETA: 3s - loss: 0.3273 - accuracy: 0.8581\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n516/582 [=========================>....] - ETA: 2s - loss: 0.3260 - accuracy: 0.8586\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n542/582 [==========================>...] - ETA: 1s - loss: 0.3256 - accuracy: 0.8590\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n550/582 [===========================>..] - ETA: 1s - loss: 0.3252 - accuracy: 0.8593\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n580/582 [============================>.] - ETA: 0s - loss: 0.3244 - accuracy: 0.8602\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 28s 47ms/step - loss: 0.3244 - accuracy: 0.8602 - val_loss: 0.4858 - val_accuracy: 0.7825\nEpoch 5/10\n170/582 [=======>......................] - ETA: 18s - loss: 0.2913 - accuracy: 0.8765\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n202/582 [=========>....................] - ETA: 16s - loss: 0.2866 - accuracy: 0.8790\n\nWarning: unknown JFIF revision number 0.00\n\n\n212/582 [=========>....................] - ETA: 16s - loss: 0.2868 - accuracy: 0.8791\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n284/582 [=============>................] - ETA: 12s - loss: 0.2804 - accuracy: 0.8825\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n493/582 [========================>.....] - ETA: 3s - loss: 0.2756 - accuracy: 0.8869\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n505/582 [=========================>....] - ETA: 3s - loss: 0.2740 - accuracy: 0.8876\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n515/582 [=========================>....] - ETA: 2s - loss: 0.2733 - accuracy: 0.8877\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n543/582 [==========================>...] - ETA: 1s - loss: 0.2732 - accuracy: 0.8886\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n549/582 [===========================>..] - ETA: 1s - loss: 0.2727 - accuracy: 0.8889\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n581/582 [============================>.] - ETA: 0s - loss: 0.2720 - accuracy: 0.8886\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 28s 46ms/step - loss: 0.2721 - accuracy: 0.8885 - val_loss: 0.4933 - val_accuracy: 0.7919\nEpoch 6/10\n169/582 [=======>......................] - ETA: 18s - loss: 0.2373 - accuracy: 0.9051\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n201/582 [=========>....................] - ETA: 16s - loss: 0.2335 - accuracy: 0.9083\n\nWarning: unknown JFIF revision number 0.00\n\n\n211/582 [=========>....................] - ETA: 16s - loss: 0.2331 - accuracy: 0.9083\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n283/582 [=============>................] - ETA: 13s - loss: 0.2268 - accuracy: 0.9110\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n493/582 [========================>.....] - ETA: 3s - loss: 0.2216 - accuracy: 0.9123\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n505/582 [=========================>....] - ETA: 3s - loss: 0.2209 - accuracy: 0.9127\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n516/582 [=========================>....] - ETA: 2s - loss: 0.2196 - accuracy: 0.9133\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n542/582 [==========================>...] - ETA: 1s - loss: 0.2178 - accuracy: 0.9147\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n548/582 [===========================>..] - ETA: 1s - loss: 0.2171 - accuracy: 0.9150\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n580/582 [============================>.] - ETA: 0s - loss: 0.2163 - accuracy: 0.9152\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 29s 47ms/step - loss: 0.2162 - accuracy: 0.9153 - val_loss: 0.6168 - val_accuracy: 0.7601\nEpoch 7/10\n169/582 [=======>......................] - ETA: 18s - loss: 0.1858 - accuracy: 0.9310\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n201/582 [=========>....................] - ETA: 16s - loss: 0.1836 - accuracy: 0.9331\n\nWarning: unknown JFIF revision number 0.00\n\n\n213/582 [=========>....................] - ETA: 16s - loss: 0.1820 - accuracy: 0.9341\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n283/582 [=============>................] - ETA: 13s - loss: 0.1783 - accuracy: 0.9361\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n493/582 [========================>.....] - ETA: 3s - loss: 0.1724 - accuracy: 0.9365\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n505/582 [=========================>....] - ETA: 3s - loss: 0.1717 - accuracy: 0.9369\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n515/582 [=========================>....] - ETA: 2s - loss: 0.1709 - accuracy: 0.9374\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n543/582 [==========================>...] - ETA: 1s - loss: 0.1699 - accuracy: 0.9378\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n549/582 [===========================>..] - ETA: 1s - loss: 0.1698 - accuracy: 0.9378\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n581/582 [============================>.] - ETA: 0s - loss: 0.1678 - accuracy: 0.9382\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 28s 47ms/step - loss: 0.1677 - accuracy: 0.9382 - val_loss: 0.6220 - val_accuracy: 0.7627\nEpoch 8/10\n170/582 [=======>......................] - ETA: 18s - loss: 0.1322 - accuracy: 0.9537\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n202/582 [=========>....................] - ETA: 16s - loss: 0.1317 - accuracy: 0.9547\n\nWarning: unknown JFIF revision number 0.00\n\n\n212/582 [=========>....................] - ETA: 16s - loss: 0.1293 - accuracy: 0.9558\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n284/582 [=============>................] - ETA: 13s - loss: 0.1267 - accuracy: 0.9558\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n493/582 [========================>.....] - ETA: 3s - loss: 0.1241 - accuracy: 0.9564\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n505/582 [=========================>....] - ETA: 3s - loss: 0.1237 - accuracy: 0.9566\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n515/582 [=========================>....] - ETA: 2s - loss: 0.1235 - accuracy: 0.9567\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n542/582 [==========================>...] - ETA: 1s - loss: 0.1223 - accuracy: 0.9574\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n550/582 [===========================>..] - ETA: 1s - loss: 0.1219 - accuracy: 0.9577\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n580/582 [============================>.] - ETA: 0s - loss: 0.1210 - accuracy: 0.9580\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 28s 47ms/step - loss: 0.1209 - accuracy: 0.9581 - val_loss: 0.6818 - val_accuracy: 0.7623\nEpoch 9/10\n170/582 [=======>......................] - ETA: 18s - loss: 0.0973 - accuracy: 0.9688\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n202/582 [=========>....................] - ETA: 16s - loss: 0.0932 - accuracy: 0.9711\n\nWarning: unknown JFIF revision number 0.00\n\n\n212/582 [=========>....................] - ETA: 16s - loss: 0.0942 - accuracy: 0.9704\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n284/582 [=============>................] - ETA: 13s - loss: 0.0915 - accuracy: 0.9712\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n492/582 [========================>.....] - ETA: 3s - loss: 0.0893 - accuracy: 0.9715\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n506/582 [=========================>....] - ETA: 3s - loss: 0.0888 - accuracy: 0.9719\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n516/582 [=========================>....] - ETA: 2s - loss: 0.0883 - accuracy: 0.9721\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n542/582 [==========================>...] - ETA: 1s - loss: 0.0880 - accuracy: 0.9722\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n550/582 [===========================>..] - ETA: 1s - loss: 0.0874 - accuracy: 0.9725\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n580/582 [============================>.] - ETA: 0s - loss: 0.0875 - accuracy: 0.9725\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 28s 47ms/step - loss: 0.0874 - accuracy: 0.9725 - val_loss: 0.6500 - val_accuracy: 0.7863\nEpoch 10/10\n170/582 [=======>......................] - ETA: 18s - loss: 0.0692 - accuracy: 0.9783\n\nCorrupt JPEG data: 99 extraneous bytes before marker 0xd9\n\n\n202/582 [=========>....................] - ETA: 17s - loss: 0.0681 - accuracy: 0.9785\n\nWarning: unknown JFIF revision number 0.00\n\n\n212/582 [=========>....................] - ETA: 16s - loss: 0.0674 - accuracy: 0.9788\n\nCorrupt JPEG data: 396 extraneous bytes before marker 0xd9\n\n\n284/582 [=============>................] - ETA: 13s - loss: 0.0648 - accuracy: 0.9798\n\nCorrupt JPEG data: 65 extraneous bytes before marker 0xd9\n\n\n493/582 [========================>.....] - ETA: 3s - loss: 0.0626 - accuracy: 0.9816\n\nCorrupt JPEG data: 2226 extraneous bytes before marker 0xd9\n\n\n505/582 [=========================>....] - ETA: 3s - loss: 0.0624 - accuracy: 0.9817\n\nCorrupt JPEG data: 128 extraneous bytes before marker 0xd9\n\n\n515/582 [=========================>....] - ETA: 2s - loss: 0.0621 - accuracy: 0.9820\n\nCorrupt JPEG data: 239 extraneous bytes before marker 0xd9\n\n\n543/582 [==========================>...] - ETA: 1s - loss: 0.0610 - accuracy: 0.9826\n\nCorrupt JPEG data: 1153 extraneous bytes before marker 0xd9\n\n\n549/582 [===========================>..] - ETA: 1s - loss: 0.0615 - accuracy: 0.9825\n\nCorrupt JPEG data: 228 extraneous bytes before marker 0xd9\n\n\n581/582 [============================>.] - ETA: 0s - loss: 0.0614 - accuracy: 0.9827\n\nCorrupt JPEG data: 162 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 252 extraneous bytes before marker 0xd9\nCorrupt JPEG data: 214 extraneous bytes before marker 0xd9\n\n\n582/582 [==============================] - 29s 47ms/step - loss: 0.0613 - accuracy: 0.9827 - val_loss: 0.6904 - val_accuracy: 0.7889</code></pre></div>\n<p>ë‹¤ìŒì€ í•™ìŠµì‹œí‚¨ ëª¨ë¸ì— ëŒ€í•œ ê·¸ë˜í”„ ë³´ê³ ì´ë‹¤</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> image_batch<span class=\"token punctuation\">,</span> label_batch <span class=\"token keyword\">in</span> test_batches<span class=\"token punctuation\">.</span>take<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    images <span class=\"token operator\">=</span> image_batch\n    labels <span class=\"token operator\">=</span> label_batch\n    predictions <span class=\"token operator\">=</span> model<span class=\"token punctuation\">.</span>predict<span class=\"token punctuation\">(</span>image_batch<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">pass</span>\n\npredictions</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">array([[9.9999702e-01, 2.9417115e-06],\n       [8.3842850e-01, 1.6157144e-01],\n       [7.4218982e-01, 2.5781012e-01],\n       [9.9970847e-01, 2.9155653e-04],\n       [9.9640131e-01, 3.5986665e-03],\n       [7.8427315e-02, 9.2157269e-01],\n       [1.8649189e-02, 9.8135078e-01],\n       [9.1933328e-01, 8.0666728e-02],\n       [9.4125561e-02, 9.0587437e-01],\n       [7.8091651e-02, 9.2190832e-01],\n       [1.1057696e-01, 8.8942307e-01],\n       [9.2630666e-01, 7.3693395e-02],\n       [9.9996006e-01, 3.9985713e-05],\n       [4.6824862e-05, 9.9995315e-01],\n       [9.9207205e-01, 7.9279514e-03],\n       [9.9890709e-01, 1.0929310e-03],\n       [3.1051392e-02, 9.6894866e-01],\n       [5.8752208e-09, 1.0000000e+00],\n       [8.3172768e-01, 1.6827232e-01],\n       [9.9952376e-01, 4.7630019e-04],\n       [7.9531687e-01, 2.0468311e-01],\n       [9.9072027e-01, 9.2797335e-03],\n       [9.9999344e-01, 6.5057743e-06],\n       [9.1565454e-01, 8.4345400e-02],\n       [9.9570221e-01, 4.2977203e-03],\n       [1.0600092e-02, 9.8939985e-01],\n       [9.9997663e-01, 2.3377719e-05],\n       [1.0107538e-01, 8.9892459e-01],\n       [9.9934202e-01, 6.5792818e-04],\n       [9.9927968e-01, 7.2028313e-04],\n       [9.9999619e-01, 3.7975171e-06],\n       [2.8957015e-01, 7.1042985e-01]], dtype=float32)</code></pre></div>\n<p>ì´ê²ƒì´ ë°”ë¡œ ìš°ë¦¬ì˜ ì •í™•ë„ì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\npredictions <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmax<span class=\"token punctuation\">(</span>predictions<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\npredictions</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">array([0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0,\n       0, 0, 0, 1, 0, 1, 0, 0, 0, 1])</code></pre></div>\n<p>ì´ì œ 32ì¥ì˜ image ì™€ 32ê°œì˜ label , 32ê°œì˜ prediction ì„ ì–»ì—ˆë‹¤\nìµœì¢… í™•ì¸ì„ í•´ë³´ì</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span> <span class=\"token number\">12</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> idx<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> prediction<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">8</span><span class=\"token punctuation\">,</span> idx<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    image <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>image <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n    correct <span class=\"token operator\">=</span> label <span class=\"token operator\">==</span> prediction\n    title <span class=\"token operator\">=</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'real: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>label<span class=\"token punctuation\">}</span></span><span class=\"token string\"> / pred :</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>prediction<span class=\"token punctuation\">}</span></span><span class=\"token string\">\\n </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>correct<span class=\"token punctuation\">}</span></span><span class=\"token string\">!'</span></span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> correct<span class=\"token punctuation\">:</span>\n        plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'color'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span>title<span class=\"token punctuation\">,</span> fontdict<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">'color'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'blue'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>axis<span class=\"token punctuation\">(</span><span class=\"token string\">'off'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 59.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAAD10lEQVQozwHMAzP8AHt+llZbXIBmh4aHNreNhmuldGpKSx8VSGoxKmxJOzQ3YmGAZYF9j1FwbX5CbWyGbipGQzheU1NhdG1wWFVfaTtmZ3xxZF1iOL+HhVq/dmlmAG9va/SAfnn/a2Zeq4Z5Zf+di3nUhnZo0IZ5bf9oY1yqiYJ4/6ihl+Wdnp6/mZCM/2hRSapweWH/aXp29lxjW69zcmL/cGVbqpx4VPiZcUv/AG1iVpyKhH+vLyQXbGZON7dkVECHv7mqhcnCu7iRk5FsdXFzsH94cpKijH56ZFNav1AgHWxzZk6pWWZonV1oa29oZmPGbmVSbG1PJp9GOyO2AM6tpk/WsK9co5OFMWgtH2FqMxlDfXybQUJDb2BTVFIymZmxXMbH3kkTDBQ8JChGZBwpNTOHgjxXtZE5T0E3RjUyLE9na219M////1GOjJ5dALKhm/Kqkor/q6OaqE0+Lv9eVUjSpJmXzm9oav96enmoh4eA/7e3s+OFhX+9nJmS/3NvV6iUiRH/o3kY80k/N60fIBz/UlRQqKCioPUyNzn/AOfUz6TCo5y21L2ucY15Zr+ek4eOm4aGi19UXsGLhItxY2FiuEhEQZqgoKSA4uLqyOXoxnGBcgCxZ1QBpXByXnVVVU3PNC8ucSQkJqcvMDq/AEgrKUhaMzNVZW1eLLi2yViFhYk9el5TO3FSWVm0sKktkKTHVHaInEMoFhg2NCY+XFFDQC5fWHhQlpGqSQ4QHzEAAAxfHB8uL4WGoEtaXHVVADIrI+41LSX/WF5MpZKSff9vcV3OZ1E2ykExGv+Cc16leHhq/5eflN9ORDW6Vk9B/2JcT6WQhn//hnZp7319d6lraWj/Ky0spF9jW/FtcWf/AD80Kq1MQTfAT1M9eGlqS8lZVz2Wc1tFk11MOsunjXF4gHpswpWUh6J6dWaHcnFp03h5d3jb0sm6kG1ercrKw3va4ePaSEtReFZYUK9oamHJAEA/WURdXolRZGZfKqN+aFW3qJI6VFhpOMS63FXLzdQreoGsUKqz0D8yGBM0MxwsWEtDRixXQ1tNOiA2Rmtmbi6XkLRar7LOLK5/b0ilblZRADEzMuVpbG//f3hqn76yif+dk2/HMC8pw1ROSv+trK6fbGxr/4iMjtdIOy2zTjsm/zkrGp9ubWr4TlBW535pXaS7q5H/wK+fn5iMe+m5r57/AH5sW8iBd2nfXlU+i5R9VulzWjeue3h3q2VfYeuVlqCLoKiw4Jqgp7xodnqdXmhm9CQjIYujn5XYiISDyWckMY+IWkz8lGlai4iEb8uklXrpdIjI2btfkaMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/ec1ce97527379951f010a8c71cac03f3/37523/output_42_0.png\"\n        srcset=\"/static/ec1ce97527379951f010a8c71cac03f3/e9ff0/output_42_0.png 180w,\n/static/ec1ce97527379951f010a8c71cac03f3/f21e7/output_42_0.png 360w,\n/static/ec1ce97527379951f010a8c71cac03f3/37523/output_42_0.png 720w,\n/static/ec1ce97527379951f010a8c71cac03f3/302a4/output_42_0.png 1080w,\n/static/ec1ce97527379951f010a8c71cac03f3/07a9c/output_42_0.png 1440w,\n/static/ec1ce97527379951f010a8c71cac03f3/fbae3/output_42_0.png 2260w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">count <span class=\"token operator\">=</span> <span class=\"token number\">0</span>   <span class=\"token comment\"># ì •ë‹µì„ ë§ì¶˜ ê°œìˆ˜</span>\n<span class=\"token keyword\">for</span> image<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">,</span> prediction <span class=\"token keyword\">in</span> <span class=\"token builtin\">zip</span><span class=\"token punctuation\">(</span>images<span class=\"token punctuation\">,</span> labels<span class=\"token punctuation\">,</span> predictions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    correct <span class=\"token operator\">=</span> label <span class=\"token operator\">==</span> prediction\n    <span class=\"token keyword\">if</span> correct<span class=\"token punctuation\">:</span>\n        count <span class=\"token operator\">=</span> count <span class=\"token operator\">+</span> <span class=\"token number\">1</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>count <span class=\"token operator\">/</span> <span class=\"token number\">32</span> <span class=\"token operator\">*</span> <span class=\"token number\">100</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">71.875</code></pre></div>\n<p>ì¤‘ê°„ì— ë“¤ì–´ê°€ìˆëŠ” ë”¥ëŸ¬ë‹ ëª¨ë¸ì´ ë‹¨ìˆœí•œ êµ¬ì¡°ì´ê¸° ë•Œë¬¸ì—<br>\nì¢‹ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ê³  ìˆì§€ëŠ” ì•Šë‹¤.</p>\n<p>ë‹¤ë§Œ ì¤‘ê°„ì˜ ëª¨ë¸êµ¬ì¡°ë¥¼ ë³€ê²½í•œë‹¤ë©´ ë” ì¢‹ì€ ê²°ê³¼ë¥¼<br>\nëŒì–´ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EA%B0%95%EC%95%84%EC%A7%80--%EA%B3%A0%EC%96%91%EC%9D%B4-%EB%B6%84%EB%A5%98-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%A8-%EC%A0%9C%EC%9E%91-\">ê°•ì•„ì§€ &#x26; ê³ ì–‘ì´ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ì œì‘ !</a></p>\n<ul>\n<li><a href=\"#content\">Content</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#1-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EC%B2%98%EB%A6%AC\">1. ë°ì´í„° ì „ì²˜ë¦¬</a></p>\n</li>\n<li>\n<p><a href=\"#2-%EB%AA%A8%EB%8D%B8-%EC%83%9D%EC%84%B1-%EB%B0%8F-%ED%95%99%EC%8A%B5\">2 ëª¨ë¸ ìƒì„± ë° í•™ìŠµ</a></p>\n</li>\n</ul>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"></code></pre></div>","excerpt":"ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ ğŸš¶â€â™‚ï¸: ì‚¬ì§„ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ë§›ë³´ê¸° ê°•ì•„ì§€ & ê³ ì–‘ì´ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ì œì‘ ! Content ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (Tensor Flow) ë°ì´í„° ì „ì²˜ë¦¬ ëª¨ë¸ ìƒì„± (ìì²´ ìƒì„± ëª¨ë¸) í•™ìŠµ ë° í‰ê°€ ì‹œì‘í•˜ê¸°ì— ì•ì„œ, ì´ë²ˆ ê²Œì‹œê¸€ì€ ì „ì²´ì ì¸ ì¸ê³µì§€ëŠ¥ ì ìš©ì— ëŒ€í•œ ë§¥ë½ì„ ì„¤ëª…í•˜ê¸° ìœ„í•œ ê¸€ì…ë‹ˆë‹¤. ì•„ì£¼ ê°„ë‹¨í•œ Deep Learning Layer ëª‡ ì¢…ë¥˜ë¥¼ ì´ìš©í–ˆìŠµë‹ˆë‹¤. tensor flow ì—ì„œëŠ” ë‹¤ì–‘í•œ ë°ì´í„°ì…‹ì„ ì´ë¯¸ ì œê³µí•˜ê³  ìˆë‹¤. ê°•ì•„ì§€ê³ ì–‘ì´, ìŒì„±, ì´ë¯¸ì§€, í…ìŠ¤íŠ¸ ë°ì´í„°ì…‹ ë³´ìœ í•˜ê³  ìˆìœ¼ë‹ˆ ì„¸ë¶€ ë‚´ìš© í™•ì¸í•´ë³´ê³  ì‹¶ìŒ í•´ë³´ê¸° tensor flow link â€œWARNING:absl:1738 images were corrupted and were skippedâ€ë¼ëŠ” ê²½ê³ ê°€ ë‚˜íƒ€ë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìš°ì„  ë¬´ì‹œí•˜ì‹œë©´ ë©ë‹ˆë‹¤. 1738 ì¥ì˜ ì‚¬ì§„ì€ ì“¸ ìˆ˜ ì—†ë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. ì´ëŸ° ê²ƒë“¤ì€ tf ì‚¬ì´íŠ¸ ë°ì´í„°ì…‹ ì„¤ëª…ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤ PNG 1738ì´ currupted ë˜ì–´ìˆë‹¤ ë˜ì–´ìˆì ¸? ê·¸ë¦¬â€¦","frontmatter":{"date":"April 21, 2022","title":"ì¸ê³µì§€ëŠ¥ ê¸°ì´ˆ ì‚¬ì§„ ë¶„ë¥˜ í”„ë¡œê·¸ë¨ ë§›ë³´ê¸°","categories":"beginner","author":"í•˜ì„±ë¯¼","emoji":"ğŸ˜"},"fields":{"slug":"/DML_AI1/"}},"next":{"id":"6f2cd6e3-4d52-59b8-8a55-7fe83eb9f0c7","html":"<h1 id=\"span-stylebackground-color-fff5b1ì„ë² ë”©ì´ë€span\" style=\"position:relative;\"><a href=\"#span-stylebackground-color-fff5b1%EC%9E%84%EB%B2%A0%EB%94%A9%EC%9D%B4%EB%9E%80span\" aria-label=\"span stylebackground color fff5b1ì„ë² ë”©ì´ë€span permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><span style='background-color: #fff5b1'>ì„ë² ë”©ì´ë€..?</span></h1>\n<p>ë‹¨ì–´ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ì ì–´ë„ 1ì°¨ì›ì—ì„œëŠ” ì•ˆëœë‹¤ (ì˜ë¯¸ê°€ ë‹´ê¸°ê¸°ì—” ì‘ë‹¤)</p>\n<p>ê·¸ë˜ì„œ ë²¡í„°ì˜ <strong>íŠ¹ì • ì°¨ì›ì„ ì§ì ‘</strong> ë§Œë“¤ì–´ ì˜ë¯¸ë¥¼ ì§ì ‘ mapping í•´ì•¼ í•˜ê³ ,<br>\nì´ë¥¼ í¬ì†Œ í‘œí˜„ (Sparse Representation) ì´ë¼ê³  í•œë‹¤.</p>\n<hr>\n<p>ë°˜ë©´ì— ê·¸ëƒ¥ ì°¨ì›ì€ ì¼ì •í•˜ê²Œ 256ì°¨ì› ì´ë ‡ê²Œ ì •í•´ë†“ê³ </p>\n<p>ìœ ì‚¬í•œ ë§¥ë½ì—ì„œ ìì£¼ ë‚˜ì˜¤ëŠ” ë‹¨ì–´ë“¤ì€ ì˜ë¯¸ê°€ ë¹„ìŠ·í•˜ë‹¤ê³  íŒë‹¨í•˜ëŠ” ë°©ì‹ì„\në¶„í¬ ê°€ì„¤ (distribution hypothesis) ì´ë¼ê³  í•œë‹¤. ê·¸ë¦¬ê³  ì´ ê°€ì„¤ì„ í†µí•´ ë¶„ì‚°í‘œí˜„ (distribution Representation) ì´ë¼ê³  í•œë‹¤.</p>\n<p>ë§¥ë½ì´ë¼ í•¨ì€ ë‹¨ì–´ ì¢Œìš°ì— í•¨ê»˜ ìœ„ì¹˜í•˜ëŠ” ë‹¨ì–´ë¥¼ ì˜ë¯¸í•œë‹¤.</p>\n<hr>\n<p>ë¶„ì‚°í‘œí˜„ ì€ í¬ì†Œí‘œí˜„ ê³¼ ë‹¬ë¦¬ ë‹¨ì–´ ê°„ ìœ ì‚¬ë„ë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤.</p>\n<p>embedding ë ˆì´ì–´ë¼ëŠ” ê²ƒì€</p>\n<p>ì´ ë‹¨ì–´ì˜ ë¶„ì‚°í‘œí˜„ì„ êµ¬í˜„í•˜ê¸° ìœ„í•œ ë ˆì´ì–´!!!!!!!!!!!!!!!!!!!!!!</p>\n<p>ìš°ë¦¬ê°€ ë‹¨ì–´ë¥¼ n ê°œ ì“¸ê±°ì•¼~ kì°¨ì›ìœ¼ë¡œ êµ¬í˜„í•´ì¡°~ í•˜ë©´</p>\n<p>ì»´í“¨í„°ê°€ n x k í˜•íƒœì˜ ë¶„ì‚°í‘œí˜„ ì‚¬ì „ì„ ë§Œë“ ë‹¤.</p>\n<p>ì´ê²Œ weihght ì´ ë˜ëŠ” ê±°ê³  íŒŒë¼ë¯¸í„°ê°€ ëœë‹¤.</p>\n<hr>\n<p>ì´ ì„ë² ë”©ì„ í›ˆë ¨ì‹œí‚¤ê¸° ìœ„í•´</p>\n<p>word2vec , FastText, Glove, ELMo ë“±ì´ ìˆëŠ” ê±°ì„ ë°©ë²•ë“¤ì´</p>\n<hr>\n<h2 id=\"ì„ë² ë”©-ë ˆì´ì–´ëŠ”-ì»´í“¨í„°ê°€-ì•Œì•„ë¨¹ëŠ”-ë‹¨ì–´ì‚¬ì „ì´ë‹¤\" style=\"position:relative;\"><a href=\"#%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EB%8A%94-%EC%BB%B4%ED%93%A8%ED%84%B0%EA%B0%80-%EC%95%8C%EC%95%84%EB%A8%B9%EB%8A%94-%EB%8B%A8%EC%96%B4%EC%82%AC%EC%A0%84%EC%9D%B4%EB%8B%A4\" aria-label=\"ì„ë² ë”© ë ˆì´ì–´ëŠ” ì»´í“¨í„°ê°€ ì•Œì•„ë¨¹ëŠ” ë‹¨ì–´ì‚¬ì „ì´ë‹¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì„ë² ë”© ë ˆì´ì–´ëŠ” ì»´í“¨í„°ê°€ ì•Œì•„ë¨¹ëŠ” ë‹¨ì–´ì‚¬ì „ì´ë‹¤.</h2>\n<p>weight ì€</p>\n<ol>\n<li>ë‹¨ì–´ì˜ ê°œìˆ˜</li>\n<li>ì„ë² ë”© ì‚¬ì´ì¦ˆ</li>\n</ol>\n<p>ë¡œ ì •ì˜ëœë‹¤.</p>\n<p>ì„ë² ë”© ë ˆì´ì–´ëŠ” input ë°ì´í„°ë¥¼ ë¶„ì‚° ë°ì´í„°ë¡œ ì—°ê²°í•´ì£¼ë‹ˆ LUT ë£©ì—… í…Œì´ë¸”<br>\nì´ë¼ê³ ë„ í•œë‹¤.</p>\n<p>ê·¸ê²ƒì€ ì›-í•« ì¸ì½”ë”© ì´ë¼ê³ ë„ í•˜ëŠ”ë°</p>\n<hr>\n<p>ì›í•« ì¸ì½”ë”© ìì²´ëŠ” sparse í‘œí˜„ì´ì§€ë§Œ</p>\n<p>embedding ì´ë‘ í•¨ê»˜ ê²°í•©í•˜ì—¬ ì“°ì´ë©´ ìœ ìš©í•˜ë‹¤.</p>\n<p>ê° ë‹¨ì–´ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ Linear ì—°ì‚° ì„ í†µí•´ ì°¨ì›ê°’ì„ ë§Œë“¤ì–´ë‚¸ë‹¤!!!</p>\n<p>ì˜ˆë¥¼ ë“¤ì–´</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 287px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.777777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABJ0AAASdAHeZh94AAAAjUlEQVQI142NSQ6FMAxDORDQBRWlhZYOdJAQCMH9z+Kv5AR/8RTLdpLuOA4QrTXknJlaK3s0Syl/5aSJzhiDYRjwPA/meca6rriuC33fc5lKQgh83wcpJZZlwfu+vHOeJ0IIGMcR931j2zZ0WmsuUkBaKcWaPCrs+45pmhBj5GP0NKXEuXOOodx7D2stfhmHaHQ1aP1BAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/976040ccf895245ecd1bba60556db4fd/480fd/1.png\"\n        srcset=\"/static/976040ccf895245ecd1bba60556db4fd/e9ff0/1.png 180w,\n/static/976040ccf895245ecd1bba60556db4fd/480fd/1.png 287w\"\n        sizes=\"(max-width: 287px) 100vw, 287px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>8ì°¨ì›ì˜ ì›í•« ì¸ì½”ë”©ì´ ìˆë‹¤ê³  í•´ë³´ì</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 306px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 82.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABJ0AAASdAHeZh94AAACA0lEQVQ4y1XUV26CQQwEYA6EkIDQS0jonSSkQB5y/1Ns9Fkyggdrl7U9nrHNXxkOh+Xl5aXMZrPy/PxcBoNBORwOxftisSjr9bo8PT2VRqNxs2az+fD7/r0iablclvP5XObzeWm32+V4PEaB9/f3uLdarVKv1yOBuSuSwO5ZtAKs2+0GGJDv7++y3++DtZP1er3wMQR+f3/L29tbKLlcLhFLUTCcTqeRMJlMwrHZbG4Br6+v0QaV+/3+rSViVqtVKNtutxHLguFoNIogTgAkfn19ldPpFGwxqtVqcSoO6PPzs3x8fMRdj8fjcYETDCEDxNCjRKYFEshUWYxE74p7d0dC3gNDlVVykuNOCrbX6zWk8gHZ7XYxQAoowTQlB8OUrG9OYBhIZNiaoAQqgN/7nJjymf5DD4GZmh5h8ff3F6yq1eptC7K3TmvFxJIegCqboP64k4YFcCDMFiiqOMth5A67U3hjCFCQKgIE/vz8BAuMyeEDrsf6hiW5ftvVXK9g6AeTZBiq5TS9YdjpdEIF2bl/LO+3HmazOZieYCjIvwGAoVDiTol/iD7zMz3UqgDM7b9fizSFJPNrSxZOMCr4tUDuw1CyR/qR0gEJdJKdXyUg4pJx5gRgTjd7k3+7/NJgA5BJysX2zo8dDD5nJavnx0HFXAdv7vy+SPeDsyrJUH+BUfoPcWxfmb0L+yUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/0f1db7efd568945b6793d92387ce9a0e/98b92/2.png\"\n        srcset=\"/static/0f1db7efd568945b6793d92387ce9a0e/e9ff0/2.png 180w,\n/static/0f1db7efd568945b6793d92387ce9a0e/98b92/2.png 306w\"\n        sizes=\"(max-width: 306px) 100vw, 306px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ì´ëŸ° ê°€ì¤‘ì¹˜ ë¥¼ ê°€ì§„ ë ˆì´ì–´ê°€ ìˆë‹¤ê³  ì¹˜ë©´\nì € ìœ„ì˜ 1 0 0 0 0 0 0 0 ì— ê° í•˜ë‚˜ì˜  [ _ _ ] ê°€ ë“¤ì–´ê°€ê²Œ ë˜ê³ ,</p>\n<p>ê·¸ ê²°ê³¼ê°’ìœ¼ë¡œ [_ _ ] ì˜ í˜•íƒœ 1 ê°œê°€ ë‚˜ì˜¤ê² ì§€ (ì›í•«ì¸ì½”ë”©ì˜ í–‰ì´ 1ì´ë‹ˆê¹Œ)</p>\n<p>ê·¸ëŸ¼ ì›í•« ì¸ì½”ë”©ì´</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 311px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 90.55555555555556%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAABJ0AAASdAHeZh94AAABtUlEQVQ4y33UR3LDMBBEUd1IOYvK+f73geuhqmnSsr2gEDTz0ROAwXa7Lc/ns+x2uzIej8v1ei3L5bKO0+m03G63Mp/Py/F4LJvNphwOh7Jarcp+v68+5vf7vTRNU/0H6/W6bgADXC6XFgiUNRAbIGAwc/851LwCh8NhdbIxmUwqPKfOZrPyeDwq+Hw+VyClRDiAD1sRtgr9nE6nVqH5YrGoAMCso4wjIHsqKYygChyNRjW8KKQopwIacwCAA4ApTT5fr9e3QkAnMKYQHEBeALPuFiVKEzJb+z0gg+QwhZI7ioVFGZuAwaJQFL2QhQNKYXJJGYX2gTk7iKNRRMkh217IgJQAAAKkysLhRBnAbyHz7SmkAkDIyV2UdhvbXpQC+j4auwvsAhgk5BQlwJ8K+fYUgrzf7wqUYAq0ApAwoxyk2+Bpcr4tMI3NEJBRQqQQxBrEAQmTyuylA3qNHYUSHIVAxlQ1d/tfhYBRKDRzjsbu1eNonbyB+nQA34+iUEJhGjuPQq5iwksOFefPqwfCMcnPk5Q+THGiOA2efLJJ0WpR5CIPKoeEkWeLE4h196YA5LVJW30B2hRjj0mVs9kAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/fc04f86827c4c59964a4496cc71898b4/ffa0f/3.png\"\n        srcset=\"/static/fc04f86827c4c59964a4496cc71898b4/e9ff0/3.png 180w,\n/static/fc04f86827c4c59964a4496cc71898b4/ffa0f/3.png 311w\"\n        sizes=\"(max-width: 311px) 100vw, 311px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>ì´ë ‡ê²Œ 10 ê°œ ìˆìœ¼ë©´<br>\n10ê°œì— ëŒ€í•œ [_ _ ] ê°’ì´ ë‚˜ì˜¬ ê²ƒì´ë‹¤. ê·¸ëŸ¼ ê·¸ê²ƒì´<br>\në°”ë¡œ ìœ ì‚¬ë„ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë²¡í„°ê°’ì´ ë  ìˆ˜ ìˆë‹¤.</p>\n<hr>\n<p>ë‹¤ì‹œ ë§í•´ì„œ ì„ë² ë”© ë ˆì´ì–´ë€</p>\n<ol>\n<li>ë‹¨ì–´ë“¤ì„ ì›í•« ì¸ì½”ë”© í•œë‹¤.</li>\n<li>ì„ í˜•ë³€í™˜(ë ˆì´ì–´ ì”Œìš°ê¸°) ë¥¼ í•œë‹¤.</li>\n<li>ê° ë‹¨ì–´ë“¤ì„ {index : ì„ í˜•ë³€í™˜ê°’ } ìœ¼ë¡œ ì €ì¥</li>\n</ol>\n<p>ì„ í•´ì£¼ëŠ” ë ˆì´ì–´ ì¸ ê²ƒ!!!!!!</p>\n<p>ë³´ì—¬ì£¼ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n\nsome_words <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>constant<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">57</span><span class=\"token punctuation\">,</span> <span class=\"token number\">35</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># 3ë²ˆ ë‹¨ì–´ / 57ë²ˆ ë‹¨ì–´ / 35ë²ˆ ë‹¨ì–´ë¡œ ì´ë£¨ì–´ì§„ í•œ ë¬¸ì¥ì…ë‹ˆë‹¤.</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Embeddingì„ ì§„í–‰í•  ë¬¸ì¥:\"</span><span class=\"token punctuation\">,</span> some_words<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\nembedding_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Embedding<span class=\"token punctuation\">(</span>input_dim<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> output_dim<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ì´ 64ê°œì˜ ë‹¨ì–´ë¥¼ í¬í•¨í•œ Embedding ë ˆì´ì–´ë¥¼ ì„ ì–¸í•  ê²ƒì´ê³ ,</span>\n<span class=\"token comment\"># ê° ë‹¨ì–´ëŠ” 100ì°¨ì›ìœ¼ë¡œ ë¶„ì‚° í‘œí˜„ í•  ê²ƒì…ë‹ˆë‹¤.</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Embeddingëœ ë¬¸ì¥:\"</span><span class=\"token punctuation\">,</span> embedding_layer<span class=\"token punctuation\">(</span>some_words<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Embedding Layerì˜ Weight í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> embedding_layer<span class=\"token punctuation\">.</span>weights<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Embeddingì„ ì§„í–‰í•  ë¬¸ì¥: (1, 3)\nEmbeddingëœ ë¬¸ì¥: (1, 3, 100)\nEmbedding Layerì˜ Weight í˜•íƒœ: (64, 100)</code></pre></div>\n<h4 id=\"ê·¼ë°-ì„ë² ë”©-ë ˆì´ì–´ëŠ”-ë¯¸ë¶„ì„-í• ìˆ˜-ì—†ëŠ”-ì• ë¼-ì–´ë–¤-ì—°ì‚°-ê²°ê³¼ë¥¼\" style=\"position:relative;\"><a href=\"#%EA%B7%BC%EB%8D%B0-%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EB%8A%94-%EB%AF%B8%EB%B6%84%EC%9D%84-%ED%95%A0%EC%88%98-%EC%97%86%EB%8A%94-%EC%95%A0%EB%9D%BC-%EC%96%B4%EB%96%A4-%EC%97%B0%EC%82%B0-%EA%B2%B0%EA%B3%BC%EB%A5%BC\" aria-label=\"ê·¼ë° ì„ë² ë”© ë ˆì´ì–´ëŠ” ë¯¸ë¶„ì„ í• ìˆ˜ ì—†ëŠ” ì• ë¼ ì–´ë–¤ ì—°ì‚° ê²°ê³¼ë¥¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê·¼ë° ì„ë² ë”© ë ˆì´ì–´ëŠ” ë¯¸ë¶„ì„ í• ìˆ˜ ì—†ëŠ” ì• ë¼ ì–´ë–¤ ì—°ì‚° ê²°ê³¼ë¥¼</h4>\n<h4 id=\"ì„ë² ë”©-ë ˆì´ì–´ì—-ì ìœ¼ë©´-ì•ˆëœë‹¤ë„¤\" style=\"position:relative;\"><a href=\"#%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EC%97%90-%EC%A0%81%EC%9C%BC%EB%A9%B4-%EC%95%88%EB%90%9C%EB%8B%A4%EB%84%A4\" aria-label=\"ì„ë² ë”© ë ˆì´ì–´ì— ì ìœ¼ë©´ ì•ˆëœë‹¤ë„¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì„ë² ë”© ë ˆì´ì–´ì— ì ìœ¼ë©´ ì•ˆëœë‹¤ë„¤</h4>\n<h2 id=\"ê·¸ëŸ°-ì„ë² ë”©-ë ˆì´ì–´ì™€-í•¨ê»˜-ì“°ëŠ”-ë¬¸ì¥-íŠ¹í™”-ë ˆì´ì–´\" style=\"position:relative;\"><a href=\"#%EA%B7%B8%EB%9F%B0-%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EC%99%80-%ED%95%A8%EA%BB%98-%EC%93%B0%EB%8A%94-%EB%AC%B8%EC%9E%A5-%ED%8A%B9%ED%99%94-%EB%A0%88%EC%9D%B4%EC%96%B4\" aria-label=\"ê·¸ëŸ° ì„ë² ë”© ë ˆì´ì–´ì™€ í•¨ê»˜ ì“°ëŠ” ë¬¸ì¥ íŠ¹í™” ë ˆì´ì–´ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ê·¸ëŸ° ì„ë² ë”© ë ˆì´ì–´ì™€ í•¨ê»˜ ì“°ëŠ” ë¬¸ì¥ íŠ¹í™” ë ˆì´ì–´</h2>\n<h1 id=\"recurrent-layer\" style=\"position:relative;\"><a href=\"#recurrent-layer\" aria-label=\"recurrent layer permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recurrent layer</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABJ0AAASdAHeZh94AAABjklEQVQ4y5VUS0+EMBjk//8Fr3rw4ElPmmjUPZio8RFX1/jCFVZ26YPS0sJCGUPVFRWMO8kktE3nm37fBK+ua7TZYEYF9i8CnI5eMZ/PHU1RoSxLFEXh1g1+3m3ooQX7ITh+pVjfHWHv7AVCCKRCgKkSEUnBOQMhFFVVLUTb8N6V7TeH2uS48WcYR+zXhU987v/psC3atf8fekon8CeXIDxcCGij8BgOEc4esSy8p+AaO8crGD0PYOvKcTK7w8HFGob+nuuhlBKUUvi+D5pMwDiBUhkk55BxjDRN3XlDb0rHGJxv4Cm8XFRJZIyTqy3c+kduqg211u6iKTJkWrp1VZbIpYTRGnmeI1Oq1cP6e7NtXqCu7PJPXjQUXwOx1iJjFLlSyw+lK9giivCwtYmXwWFv3noddmUrCQIM11bh72y7PvW57Ax287w2m2OjFOL7OyRh4FrRhy7XHmUUjHNQxsA5R5IIUM4glHJSrsiHo/Z3r8Ouyu5noDUIIYimU6QyhTEGMSEuk018Kms7Bd8AaahDWzAmluoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/17aa24ec4bd035038c60ced1da695ffa/37523/4.png\"\n        srcset=\"/static/17aa24ec4bd035038c60ced1da695ffa/e9ff0/4.png 180w,\n/static/17aa24ec4bd035038c60ced1da695ffa/f21e7/4.png 360w,\n/static/17aa24ec4bd035038c60ced1da695ffa/37523/4.png 720w,\n/static/17aa24ec4bd035038c60ced1da695ffa/aa08e/4.png 967w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>ë”¥ëŸ¬ë‹ì—ì„œ ì‹œí€€ìŠ¤ ë°ì´í„°ëŠ” ìˆœì°¨ì ì¸ íŠ¹ì„±ì„ ê¼­ ì§€ë‹Œë‹¤.</li>\n</ul>\n<p>ì´ëŸ° ìˆœì°¨ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë ˆì´ì–´ê°€ recurrent layer</p>\n<p>RNN ì€ ë‹¨ í•˜ë‚˜ì˜ Weight ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ í•œë‹¤.</p>\n<p>ë‹¤ìŒì€ RNN ì˜ ì˜ˆì‹œì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sentence <span class=\"token operator\">=</span> <span class=\"token string\">\"What time is it ?\"</span>\ndic <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"is\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"it\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"What\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"time\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"?\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">4</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"RNNì— ì…ë ¥í•  ë¬¸ì¥:\"</span><span class=\"token punctuation\">,</span> sentence<span class=\"token punctuation\">)</span>\n\nsentence_tensor <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>constant<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>dic<span class=\"token punctuation\">[</span>word<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> word <span class=\"token keyword\">in</span> sentence<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Embeddingì„ ìœ„í•´ ë‹¨ì–´ ë§¤í•‘:\"</span><span class=\"token punctuation\">,</span> sentence_tensor<span class=\"token punctuation\">.</span>numpy<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ì…ë ¥ ë¬¸ì¥ ë°ì´í„° í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> sentence_tensor<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n\nembedding_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Embedding<span class=\"token punctuation\">(</span>input_dim<span class=\"token operator\">=</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>dic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> output_dim<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nemb_out <span class=\"token operator\">=</span> embedding_layer<span class=\"token punctuation\">(</span>sentence_tensor<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nEmbedding ê²°ê³¼:\"</span><span class=\"token punctuation\">,</span> emb_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Embedding Layerì˜ Weight í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> embedding_layer<span class=\"token punctuation\">.</span>weights<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n\nrnn_seq_layer <span class=\"token operator\">=</span> \\\ntf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>SimpleRNN<span class=\"token punctuation\">(</span>units<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> return_sequences<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> use_bias<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nrnn_seq_out <span class=\"token operator\">=</span> rnn_seq_layer<span class=\"token punctuation\">(</span>emb_out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nRNN ê²°ê³¼ (ëª¨ë“  Step Output):\"</span><span class=\"token punctuation\">,</span> rnn_seq_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Simple RNN Layerì˜ Weight í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> rnn_seq_layer<span class=\"token punctuation\">.</span>weights<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n\nrnn_fin_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>SimpleRNN<span class=\"token punctuation\">(</span>units<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> use_bias<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nrnn_fin_out <span class=\"token operator\">=</span> rnn_fin_layer<span class=\"token punctuation\">(</span>emb_out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nRNN ê²°ê³¼ (ìµœì¢… Step Output):\"</span><span class=\"token punctuation\">,</span> rnn_fin_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Simple RNN Layerì˜ Weight í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> rnn_fin_layer<span class=\"token punctuation\">.</span>weights<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">RNNì— ì…ë ¥í•  ë¬¸ì¥: What time is it ?\nEmbeddingì„ ìœ„í•´ ë‹¨ì–´ ë§¤í•‘: [[2 3 0 1 4]]\nì…ë ¥ ë¬¸ì¥ ë°ì´í„° í˜•íƒœ: (1, 5)\n\nEmbedding ê²°ê³¼: (1, 5, 100)\nEmbedding Layerì˜ Weight í˜•íƒœ: (5, 100)\n\nRNN ê²°ê³¼ (ëª¨ë“  Step Output): (1, 5, 64)\nRNN Layerì˜ Weight í˜•íƒœ: (100, 64)\n\nRNN ê²°ê³¼ (ìµœì¢… Step Output): (1, 64)\nRNN Layerì˜ Weight í˜•íƒœ: (100, 64)</code></pre></div>\n<p>ì–´ë–¤ ë¬¸ì¥ì´ ê¸ì •ì¸ì§€ ë¶€ì •ì¸ì§€ ë‚˜ëˆ„ê¸° ìœ„í•´ì„œë¼ë©´ ë¬¸ì¥ì„ ëª¨ë‘ ì½ì€ í›„,<br>\nìµœì¢… Stepì˜ Outputë§Œ í™•ì¸í•´ë„ íŒë‹¨ì´ ê°€ëŠ¥í•˜ë‹¤.</p>\n<p>í•˜ì§€ë§Œ ë¬¸ì¥ì„ ìƒì„±í•˜ëŠ” ê²½ìš°ë¼ë©´<br>\nì´ì „ ë‹¨ì–´ë¥¼ ì…ë ¥ìœ¼ë¡œ ë°›ì•„ ìƒì„±ëœ<br>\nëª¨ë“  ë‹¤ìŒ ë‹¨ì–´, ì¦‰ ëª¨ë“  Stepì— ëŒ€í•œ Outputì´ í•„ìš”í•˜ë‹¤.</p>\n<p>ëª¨ë“  step ì˜ output ì€ <code class=\"language-text\"> return_sequences=True</code> ë¡œ ì¡°ì ˆ ê°€ëŠ¥í•˜ë‹¤</p>\n<p>ìœ„ì˜ ê²°ê³¼ë¥¼ ë³´ë©´ ê²°êµ­ ë§ˆì§€ë§‰ì— ë‚¨ëŠ” Weight ì€ (100, 64)ë¡œ ë˜‘ê°™ì€ ê°’ì„ ê°€ì§„ë‹¤.</p>\n<h4 id=\"ìœ„ì˜-ì½”ë“œëŠ”-ì•„ë˜ì˜-lstm-ì‚¬ìš©-ì½”ë“œì™€-ë™ì¼í•˜ë‹¤\" style=\"position:relative;\"><a href=\"#%EC%9C%84%EC%9D%98-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%95%84%EB%9E%98%EC%9D%98-lstm-%EC%82%AC%EC%9A%A9-%EC%BD%94%EB%93%9C%EC%99%80-%EB%8F%99%EC%9D%BC%ED%95%98%EB%8B%A4\" aria-label=\"ìœ„ì˜ ì½”ë“œëŠ” ì•„ë˜ì˜ lstm ì‚¬ìš© ì½”ë“œì™€ ë™ì¼í•˜ë‹¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìœ„ì˜ ì½”ë“œëŠ” ì•„ë˜ì˜ LSTM ì‚¬ìš© ì½”ë“œì™€ ë™ì¼í•˜ë‹¤</h4>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">lstm_seq_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>LSTM<span class=\"token punctuation\">(</span>units<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> return_sequences<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span> use_bias<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nlstm_seq_out <span class=\"token operator\">=</span> lstm_seq_layer<span class=\"token punctuation\">(</span>emb_out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nLSTM ê²°ê³¼ (ëª¨ë“  Step Output):\"</span><span class=\"token punctuation\">,</span> lstm_seq_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"LSTM Layerì˜ Weight í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> lstm_seq_layer<span class=\"token punctuation\">.</span>weights<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n\nlstm_fin_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>LSTM<span class=\"token punctuation\">(</span>units<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> use_bias<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">)</span>\nlstm_fin_out <span class=\"token operator\">=</span> lstm_fin_layer<span class=\"token punctuation\">(</span>emb_out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\nLSTM ê²°ê³¼ (ìµœì¢… Step Output):\"</span><span class=\"token punctuation\">,</span> lstm_fin_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"LSTM Layerì˜ Weight í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> lstm_fin_layer<span class=\"token punctuation\">.</span>weights<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">WARNING:tensorflow:Layer lstm will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.\n\nLSTM ê²°ê³¼ (ëª¨ë“  Step Output): (1, 5, 64)\nLSTM Layerì˜ Weight í˜•íƒœ: (100, 256)\nWARNING:tensorflow:Layer lstm_1 will not use cuDNN kernels since it doesn't meet the criteria. It will use a generic GPU kernel as fallback when running on GPU.\n\nLSTM ê²°ê³¼ (ìµœì¢… Step Output): (1, 64)\nLSTM Layerì˜ Weight í˜•íƒœ: (100, 256)</code></pre></div>\n<p>ì ê¹ì ê¹ LSTM ì´ ë­”ë° ê°‘ìê¸° ë‚˜ì™€..?</p>\n<h1 id=\"recuurent-layer---lstm\" style=\"position:relative;\"><a href=\"#recuurent-layer---lstm\" aria-label=\"recuurent layer   lstm permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Recuurent layer - LSTM</h1>\n<p>; Long short Term memory</p>\n<p>ì–˜ë„ RNN ë ˆì´ì–´ì˜ ì¼ì¢…ì´ë‹¤.</p>\n<hr>\n<p>ë”¥ëŸ¬ë‹ì€ back propagation ìœ¼ë¡œ ê°€ì¤‘ì¹˜ì˜ ë¯¸ë¶„ì„ êµ¬í•œ ë‹¤ìŒ ì—…ë°ì´íŠ¸í•œë‹¤.</p>\n<p>ê°€ì¤‘ì¹˜ë¥¼ ì—…ë°ì´íŠ¸ í•˜ëŠ” RNN ì˜ íŠ¹ì„±ìƒ, input ì´ ê¸¸ìˆ˜ë¡ ì´ˆê¸° ë‹¨ì–´ì˜ ë¯¸ë¶„ê°’ì´<br>\në§¤ìš° ì‘ì•„ì§€ê±°ë‚˜ ì»¤ì§€ëŠ” í˜„ìƒì´ ë°œìƒí•œë‹¤.</p>\n<p>ì´ í˜„ìƒì„ ê¸°ìš¸ê¸° ì†Œì‹¤ (vanishing) í˜¹ì€ í¬í™” (exploding) ì´ë¼ê³  í•œë‹¤.</p>\n<p>LSTM ì€ ì¼ë°˜ RNNë³´ë‹¤ 4ë°° í° ê°€ì¤‘ì¹˜ ê°’ì„ ê°€ì§„ë‹¤.<br>\nìœ„ë¥¼ ë³´ë©´ RNN =(100,64) , LSTM = (100,256) ì¸ê±°ë¥¼ ë³´ë©´ ëœë‹¤.</p>\n<p>í•˜ì§€ë§Œ ë‹¨ìˆœíˆ weight ê°€ 4ë°° â€˜ë§ì€â€™ ê²Œ ì•„ë‹ˆë¼ 4ë²  â€˜ë‹¤ì–‘í•œâ€™ ê²ƒì´ë‹¤.</p>\n<p>ê° weight ëŠ” <code class=\"language-text\">Gate</code> ë¼ëŠ” êµ¬ì¡°ì— í¬í•¨ë˜ì–´ ê¸°ì–µí•  ì •ë³´, ì „ë‹¬í•  ì •ë³´ë¥¼ ê²°ì •í•œë‹¤.</p>\n<p>LSTM ì—ëŠ” <code class=\"language-text\">Cell state</code> ë¥¼ í†µí•´ì„œ ê¸´ ë¬¸ì¥ì˜ ì•ë¶€ë¶„ë„ ì†ì‹¤ ì—†ì´ ì €ì¥í•´ì¤€ë‹¤.<br>\nì•ì„œ ì–¸ê¸‰í•œ Gate ê°€ Cell state ì— ì •ë³´ë¥¼ ì¶”ê°€/ì‚­ì œ í•œë‹¤.</p>\n<hr>\n<h3 id=\"ìì„¸í•œ-ì„¤ëª…\" style=\"position:relative;\"><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%84%A4%EB%AA%85\" aria-label=\"ìì„¸í•œ ì„¤ëª… permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìì„¸í•œ ì„¤ëª…</h3>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABuklEQVQoz41T2U7bUBDN/38EP1DxQFWplLZIkARsbGeBFESTOC2CgEli+/ou3n3QTApqSlp6peOZsUfHZ5bbEkJgdHmFdqeL/mCI9skpbMdlv9fvwz5zMTi/wNFxGyeWBcfz+Pvt3Rx06qbB76dVliXCKEIQBFgsl0ikxCoMkSQJlFKIhYBUiuM4jhmUr7RmgqZpNtDCf5yqLre+b36p2yCkR1mUEMUjFsUMQepjkf9gPGYzBNkUD2aKNDeo6/qVoq0K5/dz2FdfcGi/g3f7Fe3BHjqj97D8fXSvP8CefoLldaC1ebOa1rPs8aKPz71dXEc2dj/u4PK+i5/pEJPIgS89ZLXivDRNGcYYSCmRZRmDYhrwC+FN8g2Du0M4/gGOh3uYRDZ86WKaePBVD6ZKOC/PcybUWvPQKCZCiglMmJcpbuQI38UpfO1ilroYCwu+cjBRDsbiDKF54B6+WfKzo8sYslpC1yFUtWLLfr2CaeKNyf5zKFVVcS/WJRgoaaDZaobR6TpWeqvC5s/FpiTqBTWVLEEbDakk+2Sp2bTYWZ4zAYkoimJjD1+V/NelrqqXqdItIn/9I7WV8AkqA5dZu1PQRAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/7407f12fa125bfc200e45f2922c3e77a/37523/5.png\"\n        srcset=\"/static/7407f12fa125bfc200e45f2922c3e77a/e9ff0/5.png 180w,\n/static/7407f12fa125bfc200e45f2922c3e77a/f21e7/5.png 360w,\n/static/7407f12fa125bfc200e45f2922c3e77a/37523/5.png 720w,\n/static/7407f12fa125bfc200e45f2922c3e77a/5b481/5.png 846w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"ì•„ë˜ì˜-ê·¸ë¦¼ì€-í•˜ë‚˜ì˜-í™œì„±í•¨ìˆ˜ë¥¼-ì§€ë‹Œ-ê¸°ë³¸-rnn-ì´ë‹¤\" style=\"position:relative;\"><a href=\"#%EC%95%84%EB%9E%98%EC%9D%98-%EA%B7%B8%EB%A6%BC%EC%9D%80-%ED%95%98%EB%82%98%EC%9D%98-%ED%99%9C%EC%84%B1%ED%95%A8%EC%88%98%EB%A5%BC-%EC%A7%80%EB%8B%8C-%EA%B8%B0%EB%B3%B8-rnn-%EC%9D%B4%EB%8B%A4\" aria-label=\"ì•„ë˜ì˜ ê·¸ë¦¼ì€ í•˜ë‚˜ì˜ í™œì„±í•¨ìˆ˜ë¥¼ ì§€ë‹Œ ê¸°ë³¸ rnn ì´ë‹¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì•„ë˜ì˜ ê·¸ë¦¼ì€ í•˜ë‚˜ì˜ í™œì„±í•¨ìˆ˜ë¥¼ ì§€ë‹Œ ê¸°ë³¸ RNN ì´ë‹¤.</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABJ0AAASdAHeZh94AAABnUlEQVQoz2WS226bUBBF+f9fqdQ+9SFWL0qkpsFJsImb4GADxsEQMObO4WpWVZw2abul0Uh7NGse9ki81XBqy6mBawSv3ou/W/uslA3/qiprbiYLhuOANAwDTVfTdBVVIzjSYZomRV6MpF9+01YM9ETxgaetM0JEU1C1groViLpgra9GX8qrGCNVsMs7nPqeTaFiZArbYI3mXqNH11i5ihbIqLsL5rrM9vCImd+yFYtxz8xnmMmcQxQiJWKPWd6gJ1M+z95jV3MsoWD5SzRfZu6ec7X8wMyeoEWXaM4tRrDA6VWu1mfIxgSnW2BmCvvQPwFXuYyeysjm2Qg3yimh2PHD+8631Ue+qu9YZzJ2p+CVa7zCwBBTZs4X7rxz7GaGVSh0fYtUtyV2eM9zabGvbbzCHBeS4oDlPhBUG3xhj/NdviKtQ/aJw1OyxBcWz6WJk+p4mUXf90hbL+RSNU6BHl+Ta9qOT9MHuo7/0r5QHnGD9K/P+C0pFxVBnL0BNcRJRBTHaKZNnCSkaULy0rM0Rbe2uL5PVVWnO8Pwp34CjpFXKhO+FB8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/efb88d54d6e244dde8264612aedfae4e/37523/6.png\"\n        srcset=\"/static/efb88d54d6e244dde8264612aedfae4e/e9ff0/6.png 180w,\n/static/efb88d54d6e244dde8264612aedfae4e/f21e7/6.png 360w,\n/static/efb88d54d6e244dde8264612aedfae4e/37523/6.png 720w,\n/static/efb88d54d6e244dde8264612aedfae4e/d2a60/6.png 807w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h2 id=\"ì´ì™€-ë‹¬ë¦¬-lstm-ì€-í•œ-ë ˆì´ì–´ì˜-4-ê°€ì§€-ê°€ì¤‘ì¹˜-ì¡´ì¬\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EC%99%80-%EB%8B%AC%EB%A6%AC-lstm-%EC%9D%80-%ED%95%9C-%EB%A0%88%EC%9D%B4%EC%96%B4%EC%9D%98-4-%EA%B0%80%EC%A7%80-%EA%B0%80%EC%A4%91%EC%B9%98-%EC%A1%B4%EC%9E%AC\" aria-label=\"ì´ì™€ ë‹¬ë¦¬ lstm ì€ í•œ ë ˆì´ì–´ì˜ 4 ê°€ì§€ ê°€ì¤‘ì¹˜ ì¡´ì¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì´ì™€ ë‹¬ë¦¬ LSTM ì€ í•œ ë ˆì´ì–´ì˜ 4 ê°€ì§€ ê°€ì¤‘ì¹˜ ì¡´ì¬</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABJ0AAASdAHeZh94AAACSUlEQVQ4y2WT2XLaQBBF+f8/yFOqksfk0YmzFcTEjgOOgYDNKjFCG6sEQhubOKkZFjtOV3VNT8/tO92aqxwvbOmHaNWBivf7vXJpabyid2+QZdk/+N1uR/dOsErWap+TBTK53WxVYjb26NR1FWfZE+E63dCsdA/5XcZO+nanzhvlFqv0SDiOBhhBAzfp4ERtRFDH8Fo4U4E+q2L4DwivTn/+h4ZRZuhZDJYPOHEHN+1iR21V7wezA+Fg+YixrnAnvvI4vUYkv9G9GrXOLb/0S26aHyhrX8iX3lP8fUF/3ESPy7S8n5T0zxhplV5QZuw5sD8SiuSOm+5H7s1v9JM7+n6dplGmUHnN5dUrflTe8L32juv6J0yvixaVqNkFrjsXGGmF7qKEF4yPIy/7iEVdjSzbN8NHLL9HW6tR04s07bJyMa/TtmqYroYZNBRW1lhhEzNoMvMnhw5vGzpBmB6ebH90oKE7DL3wpQjomiNaYnSAZ/8dkxPulGS15sS43qwJlwFNzUBYDlG4JAgW+L5PHEf0DIt2f8A+27Fnf5aWlJNcc/DU3El7z7V2ks7L/ElOp/UU57IjUGoxy3ZnwGGfnePtdnsmfu4nojAMnzpcBi5W/y1D+4rThXPbZhUESMrxeEy1WmU2m6nRi8Wi2ssL5/M5hUKBfD5/+IZypNHQxRx0ME2dOE5I0xRDCEbDoQJNJhNFKm2xWGDbNq7rqs43mw1CCOXnX08S2LbLdOqd29c0DcdxVBeWZalYWpIkRFGkMJJQWhzH51f+C2xa1dRk9vPYAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/2d8c740ce607bdb9f8c58d091eca361f/37523/7.png\"\n        srcset=\"/static/2d8c740ce607bdb9f8c58d091eca361f/e9ff0/7.png 180w,\n/static/2d8c740ce607bdb9f8c58d091eca361f/f21e7/7.png 360w,\n/static/2d8c740ce607bdb9f8c58d091eca361f/37523/7.png 720w,\n/static/2d8c740ce607bdb9f8c58d091eca361f/42d54/7.png 858w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>LSTM ì´ ê°€ì§„ ê°€ì¥ í° íŠ¹ì§•ì€ ìƒë‹¨ì— ê°€ë¡œë¡œ ê·¸ì–´ì§„ Cell ctate ì´ë‹¤.</p>\n<p>ì–˜ëŠ” ì»¨ë² ì´ì–´ ë²¨íŠ¸ì²˜ëŸ¼ ì‘ì€ ì„ í˜•ë³€í™˜ì„ ì•„ì£¼ ì¡°ê¸ˆì”© í•˜ë©´ì„œ ì •ë³´ê°€ ë‚˜ì•„ê°„ë‹¤.</p>\n<p>LSTM ì€ ì´ ëŠ¥ë ¥ì„ gate ë¼ê³  ë¶ˆë¦¬ëŠ” êµ¬ì¡°ë¡œ ì¡°ê¸ˆì”© ë³€í˜•ì‹œí‚¨ë‹¤.</p>\n<p>Gate = ì‹œê·¸ëª¨ì´ë“œ ì™€ pointwise ê³±ì…ˆìœ¼ë¡œ ì´ë£¨ì–´ì§„ ì •ë³´ì „ë‹¬ ë°©ë²•</p>\n<p>ì‹œê·¸ëª¨ì´ë“œì˜ output ì€ 0ê³¼ 1ë¡œë§Œ ì´ë£¨ì–´ì ¸ ìˆì–´ ë³´ë‚¼ ì •ë³´ì™€ ë§‰ì„ ì •ë³´ë¥¼ ê³ ë¥¸ë‹¤</p>\n<p>LSTM ì€ 3ê°œì˜ gate ê°’ì„ ê°€ì§€ê³  ìˆë‹¤. ì´ 3ê°œë¡œ CELL STATE ì— ë³´ë‚¼ ê°’ì„ ì œì–´í•œë‹¤.</p>\n<p>3ê°œì˜ GATE ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>\n<ol>\n<li>forgat gate layer</li>\n</ol>\n<p>cell state ì—ì„œ ì§€ìš¸ ê°’ ì„ ì •</p>\n<ol start=\"2\">\n<li>input gate layer</li>\n</ol>\n<p>ìƒˆë¡œìš´ cell state ë¥¼ ê¸°ì¡´ cell state ì— ë°˜ì˜í•  ì •ë„ë¥¼ ì„ ì •</p>\n<ul>\n<li>(ì—¬ê¸°ì„œ ì›ë˜ ë³¸ì—°ì˜ ê°€ì¤‘ì¹˜ë¥¼ í†µí•´ ì´ì „ 1,2ë²ˆì—ì„œ ì •í•œ ì¼ í•´ì¤Œ)</li>\n</ul>\n<ol start=\"3\">\n<li>output gate layer</li>\n</ol>\n<p>cell state ë¡œ í•„í„°ëœ output ë°°ì¶œ</p>\n<hr>\n<p>1ë²ˆ , 2ë²ˆ, - ë²ˆ, 4ë²ˆ ì´ë ‡ê²Œ ì´ 4ë²ˆì˜ ë ˆì´ì–´ í™œë™ìœ¼ë¡œ LSTM ì€ ì‘ë™í•œë‹¤.</p>\n<hr>\n<p>ì´ ì™¸ì—ë„ ë­</p>\n<p>ì—¿ë³´ê¸° LSTM,, GRU,,,</p>\n<p>BIRNN ë“± ë­ ì´ê²ƒì €ê²ƒ ë§ë‹¤\nì•„ë˜ ì½”ë“œëŠ” ì–‘ë°©í–¥(Bidirectional) RNN ì½”ë“œì„</p>\n<p>ì–‘ë°©í–¥ì´ë¼ì„œ ê°€ì¤‘ì¹˜ê°€ ë‘ë°°ì„ ì• ë’¤ì—ì„œ ê°€ì•¼ë˜ë‹ˆê¹Œ</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n\nsentence <span class=\"token operator\">=</span> <span class=\"token string\">\"What time is it ?\"</span>\ndic <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"is\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"it\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"What\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"time\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"?\"</span><span class=\"token punctuation\">:</span> <span class=\"token number\">4</span>\n<span class=\"token punctuation\">}</span>\n\nsentence_tensor <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>constant<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>dic<span class=\"token punctuation\">[</span>word<span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> word <span class=\"token keyword\">in</span> sentence<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nembedding_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Embedding<span class=\"token punctuation\">(</span>input_dim<span class=\"token operator\">=</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>dic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> output_dim<span class=\"token operator\">=</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nemb_out <span class=\"token operator\">=</span> embedding_layer<span class=\"token punctuation\">(</span>sentence_tensor<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"ì…ë ¥ ë¬¸ì¥ ë°ì´í„° í˜•íƒœ:\"</span><span class=\"token punctuation\">,</span> emb_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n\nbi_rnn <span class=\"token operator\">=</span> \\\ntf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Bidirectional<span class=\"token punctuation\">(</span>\n    tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>SimpleRNN<span class=\"token punctuation\">(</span>units<span class=\"token operator\">=</span><span class=\"token number\">64</span><span class=\"token punctuation\">,</span> use_bias<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> return_sequences<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span>\nbi_out <span class=\"token operator\">=</span> bi_rnn<span class=\"token punctuation\">(</span>emb_out<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bidirectional RNN ê²°ê³¼ (ìµœì¢… Step Output):\"</span><span class=\"token punctuation\">,</span> bi_out<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ì…ë ¥ ë¬¸ì¥ ë°ì´í„° í˜•íƒœ: (1, 5, 100)\nBidirectional RNN ê²°ê³¼ (ìµœì¢… Step Output): (1, 5, 128)</code></pre></div>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EB%8A%94-%EC%BB%B4%ED%93%A8%ED%84%B0%EA%B0%80-%EC%95%8C%EC%95%84%EB%A8%B9%EB%8A%94-%EB%8B%A8%EC%96%B4%EC%82%AC%EC%A0%84%EC%9D%B4%EB%8B%A4\">ì„ë² ë”© ë ˆì´ì–´ëŠ” ì»´í“¨í„°ê°€ ì•Œì•„ë¨¹ëŠ” ë‹¨ì–´ì‚¬ì „ì´ë‹¤.</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%EA%B7%BC%EB%8D%B0-%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EB%8A%94-%EB%AF%B8%EB%B6%84%EC%9D%84-%ED%95%A0%EC%88%98-%EC%97%86%EB%8A%94-%EC%95%A0%EB%9D%BC-%EC%96%B4%EB%96%A4-%EC%97%B0%EC%82%B0-%EA%B2%B0%EA%B3%BC%EB%A5%BC\">ê·¼ë° ì„ë² ë”© ë ˆì´ì–´ëŠ” ë¯¸ë¶„ì„ í• ìˆ˜ ì—†ëŠ” ì• ë¼ ì–´ë–¤ ì—°ì‚° ê²°ê³¼ë¥¼</a></li>\n<li><a href=\"#%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EC%97%90-%EC%A0%81%EC%9C%BC%EB%A9%B4-%EC%95%88%EB%90%9C%EB%8B%A4%EB%84%A4\">ì„ë² ë”© ë ˆì´ì–´ì— ì ìœ¼ë©´ ì•ˆëœë‹¤ë„¤</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B7%B8%EB%9F%B0-%EC%9E%84%EB%B2%A0%EB%94%A9-%EB%A0%88%EC%9D%B4%EC%96%B4%EC%99%80-%ED%95%A8%EA%BB%98-%EC%93%B0%EB%8A%94-%EB%AC%B8%EC%9E%A5-%ED%8A%B9%ED%99%94-%EB%A0%88%EC%9D%B4%EC%96%B4\">ê·¸ëŸ° ì„ë² ë”© ë ˆì´ì–´ì™€ í•¨ê»˜ ì“°ëŠ” ë¬¸ì¥ íŠ¹í™” ë ˆì´ì–´</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#%EC%9C%84%EC%9D%98-%EC%BD%94%EB%93%9C%EB%8A%94-%EC%95%84%EB%9E%98%EC%9D%98-lstm-%EC%82%AC%EC%9A%A9-%EC%BD%94%EB%93%9C%EC%99%80-%EB%8F%99%EC%9D%BC%ED%95%98%EB%8B%A4\">ìœ„ì˜ ì½”ë“œëŠ” ì•„ë˜ì˜ LSTM ì‚¬ìš© ì½”ë“œì™€ ë™ì¼í•˜ë‹¤</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9E%90%EC%84%B8%ED%95%9C-%EC%84%A4%EB%AA%85\">ìì„¸í•œ ì„¤ëª…</a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%95%84%EB%9E%98%EC%9D%98-%EA%B7%B8%EB%A6%BC%EC%9D%80-%ED%95%98%EB%82%98%EC%9D%98-%ED%99%9C%EC%84%B1%ED%95%A8%EC%88%98%EB%A5%BC-%EC%A7%80%EB%8B%8C-%EA%B8%B0%EB%B3%B8-rnn-%EC%9D%B4%EB%8B%A4\">ì•„ë˜ì˜ ê·¸ë¦¼ì€ í•˜ë‚˜ì˜ í™œì„±í•¨ìˆ˜ë¥¼ ì§€ë‹Œ ê¸°ë³¸ RNN ì´ë‹¤.</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%9D%B4%EC%99%80-%EB%8B%AC%EB%A6%AC-lstm-%EC%9D%80-%ED%95%9C-%EB%A0%88%EC%9D%B4%EC%96%B4%EC%9D%98-4-%EA%B0%80%EC%A7%80-%EA%B0%80%EC%A4%91%EC%B9%98-%EC%A1%B4%EC%9E%AC\">ì´ì™€ ë‹¬ë¦¬ LSTM ì€ í•œ ë ˆì´ì–´ì˜ 4 ê°€ì§€ ê°€ì¤‘ì¹˜ ì¡´ì¬</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"April 21, 2022","title":"ì„ë² ë”©ì´ë€","categories":"NLP","author":"í•˜ì„±ë¯¼","emoji":"ğŸ˜"},"fields":{"slug":"/NLP_4/"}},"prev":{"id":"594039ec-3322-5302-b54c-d19ecd03dc20","html":"<h1 id=\"span-stylebackground-color-fff5b1ë”¥ëŸ¬ë‹ëª¨ë¸-vgg-16--ï¸span\" style=\"position:relative;\"><a href=\"#span-stylebackground-color-fff5b1%EB%94%A5%EB%9F%AC%EB%8B%9D%EB%AA%A8%EB%8D%B8-vgg-16--%EF%B8%8Fspan\" aria-label=\"span stylebackground color fff5b1ë”¥ëŸ¬ë‹ëª¨ë¸ vgg 16  ï¸span permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><span style='background-color: #fff5b1'>ë”¥ëŸ¬ë‹ëª¨ë¸ VGG-16  ğŸš¶ğŸ½â€â™‚ï¸</span></h1>\n<p>ì˜¤ëŠ˜ êµ¬í˜„í•œ ëª¨ë¸ì€ VGG-16 ì´ë‹¤.</p>\n<h2 id=\"ëª©ì°¨\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%EC%B0%A8\" aria-label=\"ëª©ì°¨ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ëª©ì°¨</h2>\n<ol>\n<li>ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</li>\n<li>VGG-16 ìƒì„±</li>\n<li>ë³¸ì¸ì˜ ê³¼ì—…ì— ë§ê²Œ VGG-16 ê°œì„ </li>\n</ol>\n<p>ì´ ëª¨ë¸ì€ ë¯¸êµ­ì—ì„œ ì§„í–‰í•œ ì´ë¯¸ì§€ ì¸ì‹ ëŒ€íšŒ ILSVRC ì—ì„œ<br>\n2014ë…„ ì¤€ìš°ìŠ¹ì„ í•œ ëª¨ë¸ì´ë‹¤! (ë¬¼ë¡  ì§€ê¸ˆì€ ë” ì¢‹ì€ê²Œ ë§ì´ ìˆë‹¤)</p>\n<p>í•˜ì§€ë§Œ ê³„ì† ë°œì „ë˜ëŠ” Deep Learning ëª¨ë¸ì„ ì´í•´í•˜ê¸° ìœ„í•´ì„ <br>\nê¸°ë³¸ì ì¸ êµ¬ì¡°ë¥¼ ê°–ì¶˜ VGG-16 ì˜ ëª¨ë¸ ì´í•´ê°€ í•„ìš”í•˜ë‹¤.</p>\n<p>ë³¸ ê²Œì‹œê¸€ì—ì„œëŠ” VGG-16 ë¥¼ Tensorflow ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ë¶ˆëŸ¬ì™€<br>\nì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì œì‹œí•œë‹¤.</p>\n<p>ëª¨ë¸ ì‚¬ìš©ì—ëŠ” tensorflow ì‹¤ìŠµ ë°ì´í„°ì¸\n<code class=\"language-text\">cats vs dogs</code> ë¥¼ ì‚¬ìš©í–ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> tensorflow <span class=\"token keyword\">as</span> tf\n<span class=\"token keyword\">import</span> tensorflow_datasets <span class=\"token keyword\">as</span> tfds\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token operator\">%</span>matplotlib inline\n<span class=\"token operator\">%</span>config InlineBackend<span class=\"token punctuation\">.</span>figure_format <span class=\"token operator\">=</span> <span class=\"token string\">'retina'</span>\n\n\n\n<span class=\"token punctuation\">(</span>raw_train<span class=\"token punctuation\">,</span> raw_validation<span class=\"token punctuation\">,</span> raw_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> metadata <span class=\"token operator\">=</span> tfds<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'cats_vs_dogs'</span><span class=\"token punctuation\">,</span>\n    split<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token string\">'train[:80%]'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'train[80%:90%]'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'train[90%:]'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    with_info<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n    as_supervised<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\nIMG_SIZE <span class=\"token operator\">=</span> <span class=\"token number\">160</span> <span class=\"token comment\"># ë¦¬ì‚¬ì´ì§•í•  ì´ë¯¸ì§€ì˜ í¬ê¸°</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">format_example</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    image <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>cast<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> tf<span class=\"token punctuation\">.</span>float32<span class=\"token punctuation\">)</span>  <span class=\"token comment\"># image=float(image)ê°™ì€ íƒ€ì…ìºìŠ¤íŒ…ì˜  í…ì„œí”Œë¡œìš° ë²„ì „ì…ë‹ˆë‹¤.</span>\n    image <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>image<span class=\"token operator\">/</span><span class=\"token number\">127.5</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span> <span class=\"token comment\"># í”½ì…€ê°’ì˜ scale ìˆ˜ì •</span>\n    image <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>image<span class=\"token punctuation\">.</span>resize<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>IMG_SIZE<span class=\"token punctuation\">,</span> IMG_SIZE<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> image<span class=\"token punctuation\">,</span> label\n\ntrain <span class=\"token operator\">=</span> raw_train<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>format_example<span class=\"token punctuation\">)</span>\nvalidation <span class=\"token operator\">=</span> raw_validation<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>format_example<span class=\"token punctuation\">)</span>\ntest <span class=\"token operator\">=</span> raw_test<span class=\"token punctuation\">.</span><span class=\"token builtin\">map</span><span class=\"token punctuation\">(</span>format_example<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\u001b[1mDownloading and preparing dataset 786.68 MiB (download: 786.68 MiB, generated: Unknown size, total: 786.68 MiB) to /aiffel/tensorflow_datasets/cats_vs_dogs/4.0.0...\u001b[0m\n\n\n\nDl Completed...: 0 url [00:00, ? url/s]\n\n\n\nDl Size...: 0 MiB [00:00, ? MiB/s]\n\n\n\nGenerating splits...:   0%|          | 0/1 [00:00&lt;?, ? splits/s]\n\n\n\nGenerating train examples...:   0%|          | 0/23262 [00:00&lt;?, ? examples/s]\n\n\nWARNING:absl:1738 images were corrupted and were skipped\n\n\n\nShuffling cats_vs_dogs-train.tfrecord...:   0%|          | 0/23262 [00:00&lt;?, ? examples/s]\n\n\n\u001b[1mDataset cats_vs_dogs downloaded and prepared to /aiffel/tensorflow_datasets/cats_vs_dogs/4.0.0. Subsequent calls will reuse this data.\u001b[0m</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">plt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\nget_label_name <span class=\"token operator\">=</span> metadata<span class=\"token punctuation\">.</span>features<span class=\"token punctuation\">[</span><span class=\"token string\">'label'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>int2str\n\n<span class=\"token keyword\">for</span> idx<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> label<span class=\"token punctuation\">)</span> <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>train<span class=\"token punctuation\">.</span>take<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span><span class=\"token punctuation\">,</span> idx<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    image <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>image <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">2</span>\n    plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string-interpolation\"><span class=\"token string\">f'label </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>label<span class=\"token punctuation\">}</span></span><span class=\"token string\">: </span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>get_label_name<span class=\"token punctuation\">(</span>label<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>axis<span class=\"token punctuation\">(</span><span class=\"token string\">'off'</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABYlAAAWJQFJUiTwAAADNUlEQVQozwEqA9X8AFVQQz6LiGA8iYpjLaqATg9FOB5BLzYROS4uETd1hUwNboNbOLayrzyCiIw9NT09D11FEC1aSiFAXUsbO2dNDRdmZWghR0RBQVdRTzx/fX0uAGdgVf6smnL/uKV8xI1tS2pkSCr/OzQe9l8/IexxgURcioJW6ryGYveWe2j/NjUyZyIZA8toVy/8eWY//29dN4SNiIWhfHhz/29rZ/aVk5PkAF5VS/88Jx7/d2VMyW5vN25kQCP/ayoh/l09IPJgcTtgiHde8p1/b/+Nblf/hndsaxgdIdJPRjj/f3Zp/3FnV4kuLSimGx8Z/zM2Lf1yZFXrAHZnVf9hVTb/ZFtC1WZoNHRiPyX/fzQd/1NFHv9ueklllaKC/3iFaP+PkIL/xsK7cVJELN10Xz3/l4l3/2deUpFmYV2vendz/5GJhP+WiID4AFtURmpUWkFrQkc8UlBPJy48MBxsXDwgZ2lYL2NsdU8oj6N8Ymh/P2d2gWhryMa4LH1SD1WDYitpdmA4blpOMjjPxcJEw7m1brSsqmeqoqFhAP/60AD///cA28a0AElFKAD/4HcA//+xAKeMTgBFTj4A///lAP//kgDb3rYApqefANafTQD//9UA48OPAHRrVQD/+dkA////AP///wDEuKcAALOPdsLovqfCyJR/lkQ4OkxZUEbGbGVavDo2N7EhJTRBZGZtsqOMdr6Xh3m/aHKGSjo0MJqvrq7BW1lWxz4+QWNHRTh4Xlg8yVBJLLxCPSerAJ9/a/+PeW3/uJCB04RsTnSef1D/n4ts/4tzUP8vLTBlbniF/cazoP+oloT/ZHCAcW1nZNyUiYb/Z2Jf/0xLS5BbVTOvT0s0/1tUOP9IQir3AJqQg/94dW//t6uey6OXgW+5nm3/sZNl/52JbPVDRlJganiO9KGbmP+IgXz/X2lxbGVcVtN3bWj/cGtl/19cWYo4NCGofn53/2xtZ/9IQi/tAK+gjuWqoJLmy72nsHl+gGChjnHprZNq3oSGgtReZm1UeX+P032Dit+AhYjlgoWHXVxVT7d1cGnke3Rs7HFqY3hBQjaRmpqV7cvIw91GQTHOUnqDylKzWK4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"png\"\n        title=\"png\"\n        src=\"/static/1271a3703b5b224b0557b0d74541dd9c/37523/output_2_0.png\"\n        srcset=\"/static/1271a3703b5b224b0557b0d74541dd9c/e9ff0/output_2_0.png 180w,\n/static/1271a3703b5b224b0557b0d74541dd9c/f21e7/output_2_0.png 360w,\n/static/1271a3703b5b224b0557b0d74541dd9c/37523/output_2_0.png 720w,\n/static/1271a3703b5b224b0557b0d74541dd9c/302a4/output_2_0.png 1080w,\n/static/1271a3703b5b224b0557b0d74541dd9c/ee3fb/output_2_0.png 1144w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<h3 id=\"vgg-16-ë¶ˆëŸ¬ì˜¤ê¸°\" style=\"position:relative;\"><a href=\"#vgg-16-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\" aria-label=\"vgg 16 ë¶ˆëŸ¬ì˜¤ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VGG 16 ë¶ˆëŸ¬ì˜¤ê¸°</h3>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">feature_batch <span class=\"token operator\">=</span> base_model<span class=\"token punctuation\">(</span>image_batch<span class=\"token punctuation\">)</span>\nfeature_batch<span class=\"token punctuation\">.</span>shape</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">TensorShape([32, 5, 5, 512])</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">base_model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model: \"vgg16\"\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\ninput_1 (InputLayer)         [(None, 160, 160, 3)]     0         \n_________________________________________________________________\nblock1_conv1 (Conv2D)        (None, 160, 160, 64)      1792      \n_________________________________________________________________\nblock1_conv2 (Conv2D)        (None, 160, 160, 64)      36928     \n_________________________________________________________________\nblock1_pool (MaxPooling2D)   (None, 80, 80, 64)        0         \n_________________________________________________________________\nblock2_conv1 (Conv2D)        (None, 80, 80, 128)       73856     \n_________________________________________________________________\nblock2_conv2 (Conv2D)        (None, 80, 80, 128)       147584    \n_________________________________________________________________\nblock2_pool (MaxPooling2D)   (None, 40, 40, 128)       0         \n_________________________________________________________________\nblock3_conv1 (Conv2D)        (None, 40, 40, 256)       295168    \n_________________________________________________________________\nblock3_conv2 (Conv2D)        (None, 40, 40, 256)       590080    \n_________________________________________________________________\nblock3_conv3 (Conv2D)        (None, 40, 40, 256)       590080    \n_________________________________________________________________\nblock3_pool (MaxPooling2D)   (None, 20, 20, 256)       0         \n_________________________________________________________________\nblock4_conv1 (Conv2D)        (None, 20, 20, 512)       1180160   \n_________________________________________________________________\nblock4_conv2 (Conv2D)        (None, 20, 20, 512)       2359808   \n_________________________________________________________________\nblock4_conv3 (Conv2D)        (None, 20, 20, 512)       2359808   \n_________________________________________________________________\nblock4_pool (MaxPooling2D)   (None, 10, 10, 512)       0         \n_________________________________________________________________\nblock5_conv1 (Conv2D)        (None, 10, 10, 512)       2359808   \n_________________________________________________________________\nblock5_conv2 (Conv2D)        (None, 10, 10, 512)       2359808   \n_________________________________________________________________\nblock5_conv3 (Conv2D)        (None, 10, 10, 512)       2359808   \n_________________________________________________________________\nblock5_pool (MaxPooling2D)   (None, 5, 5, 512)         0         \n=================================================================\nTotal params: 14,714,688\nTrainable params: 14,714,688\nNon-trainable params: 0\n_________________________________________________________________</code></pre></div>\n<p>18ì¸µìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤.</p>\n<p>í•´ë‹¹ ì‚¬ì´íŠ¸ì—ì„œ ì „ë¬¸ì ì¸ ë‚´ìš©ì„ ë‹¤ë£¬ë‹¤.</p>\n<p><a href=\"https://neurohive.io/en/popular-networks/vgg16/\">ìì„¸í•œ ë‚´ìš©ì„ ë³´ì‹œë ¤ë©´</a></p>\n<p>ì´ ëª¨ë¸ì€ í•´ë‹¹ ê·¸ë¦¼ì„ êµ¬í˜„í•˜ê³  ìˆë‹¤.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 565px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 62.22222222222222%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABuElEQVQoz52Sz2sTQRzF9w8RwZungp68efMP8FgPgheh/4Jn/QcEoSIowYOtpb0IHryp/4ERTZO02R8m7e5kszvZndnZbPKRGdtQYirUBw+WZebNe9/v88qypNKKUSyYyClRGJBNJlRVhcVisbgSPXtpvljwZPs9h/1j0vGYc1xVbCm48+kLjzcf4R92KIoCmWUopf7PYW+YsvX0GR933jqBcRTS63bJZb4UXcX55XXwPnz9zN2Hm/w88qE2jIKAcRTR7XQIBgNSIUjTFCkldV0j85wsy1yS+Xzu/jVN42i/vdZBi437D+gdBzTFFDEcIuOY0WhEJQThYIDv+0zC0D1w1O9TCkFezTjNC6IkJc6nyCx1D3mt/V1ubtzmx/c2GOMEsyQmEQJTFGil/kQ/c2HJWdx1ob3ddwdcv3aDdvsbKMWvIKDS2tm/OKfKGFclS6U1xpi1S/Oev3jFrTv38IPIubAzWleb/OSUJI6JogiRJGit1wu+fLPH9us9pjLDmPrSqsiyJAxDR7uky2rldfsBclogROK2tnpg6XbeoLVyo/hXP72L8VYPWlgB68ZGnM1mf/VwVfA3ueuPgaIpqCoAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"VGG\" title=\"VGG\" src=\"/static/70208de06e060390432303c3020768e8/07eba/VGG.png\" srcset=\"/static/70208de06e060390432303c3020768e8/e9ff0/VGG.png 180w,\n/static/70208de06e060390432303c3020768e8/f21e7/VGG.png 360w,\n/static/70208de06e060390432303c3020768e8/07eba/VGG.png 565w\" sizes=\"(max-width: 565px) 100vw, 565px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n    </span>\n<p>ê·¸ë¦¼ì˜ ì„¸ ë²ˆì§¸ íŒŒë€ìƒìë¥¼ ë³´ë©´ fully nected ë¼ê³  ë˜ì–´ìˆëŠ”ë°,<br>\nfully connected layer ì˜ ì˜¤íƒ€ì´ë‹¤. ìˆœë°©í–¥ ì‹ ê²½ë§ì„ ì˜ë¯¸í•œë‹¤.</p>\n<p>18ì¸µìœ¼ë¡œ êµ¬ì„±ë˜ì–´ìˆìœ¼ë‚˜ VGG-16 ì¸ ì´ìœ ëŠ”<br>\nconvolution layer ì™€ fully connected layer ë§Œ í¬í•¨í–ˆê¸° ë•Œë¬¸ì´ë‹¤.<br>\nì´ ë‘ ê°œì˜ ì´ í•©ì€ 16ê°œì´ë‹¤.</p>\n<p>í˜„ì¬ íŒŒì´ì¬ì— ë¶ˆëŸ¬ì˜¨ ëª¨ë¸ ìƒì—ëŠ”\në§ˆì§€ë§‰ maxfooling ê¹Œì§€ë§Œ êµ¬í˜„ë˜ì–´ìˆë‹¤.</p>\n<p>ë•Œë¬¸ì— ë§ˆì§€ë§‰ ë„¤ ê°œì˜ ì¸µì„ ì§ì ‘ ë„ì…í•´ë³´ê¸°ë¡œ í•˜ì!</p>\n<h3 id=\"vgg-16-ê°œì„ \" style=\"position:relative;\"><a href=\"#vgg-16-%EA%B0%9C%EC%84%A0\" aria-label=\"vgg 16 ê°œì„  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>VGG-16 ê°œì„ </h3>\n<hr>\n<p>ë§ˆì§€ë§‰ layer ê¹Œì§€ ì œê³µí•´ì£¼ì§€ ì•ŠëŠ” ì´ìœ ëŠ”<br>\nìš°ë¦¬ê°€ ì…ë ¥í•˜ëŠ” input ë°ì´í„°ì— ë”°ë¼ output ë°ì´í„°ë„<br>\në‹¬ë¼ì§€ê¸° ë•Œë¬¸ì´ë‹¤.</p>\n<p>ë§ˆì§€ë§‰ layer ì¸ Dense layer (Fully connected layer) ì— ë„£ì–´ì£¼ê¸° ìœ„í•´ì„œëŠ” input data ë¥¼ Flatten ì‹œí‚¨ í›„ ì…ë ¥í•˜ì—¬ì•¼ í•œë‹¤.</p>\n<p>ìš°ë¦¬ shape ëŠ” 32,5,5,512 ë¼ì„œ ì´ê±° í•œì¤„ë¡œ ë§Œë“¤ì–´ì¤„ê±´ë°</p>\n<p>ì•„ë˜ëŠ” Flattenì˜ ì˜ˆì‹œì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\nimage <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n                  <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nflattened_image <span class=\"token operator\">=</span> image<span class=\"token punctuation\">.</span>flatten<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Original image:\\n\"</span><span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Original image shape:\"</span><span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Flattened image:\\n\"</span><span class=\"token punctuation\">,</span> flattened_image<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Flattened image shape:\"</span><span class=\"token punctuation\">,</span> flattened_image<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Original image:\n [[1 2]\n [3 4]]\nOriginal image shape: (2, 2)\n\nFlattened image:\n [1 2 3 4]\nFlattened image shape: (4,)</code></pre></div>\n<p>ì´ì²˜ëŸ¼ ì°¨ì›ì´ ì¡´ì¬í•˜ëŠ” ë°°ì—´ë°ì´í„°ë¥¼ í•œ ì¤„ë¡œ<br>\nì´ì–´ì¤€ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"></code></pre></div>\n<p>ì•„ ê·¼ë° ì´ê±° ë§ê³  ë” ì¢‹ì€ê²Œ ìˆë°</p>\n<p>ê·¸ê²Œ ë°”ë¡œ Global Average Pooling</p>\n<p>3ì°¨ì›ì˜ tensor ê°€ ìˆì„ë•Œ (ì˜ˆë¥¼ ë“¤ì–´, ê°€ë¡œ, ì„¸ë¡œ, ì±„ë„)<br>\nê²¹ê²¹ì´ ìŒ“ì—¬ìˆëŠ” 2ì°¨ì› ë°°ì—´ì˜ í‰ê· ì„ êµ¬í•œ í›„ í•˜ë‚˜ë¡œ ì¶•ì†Œí•˜ëŠ” ë°©ë²•</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">global_average_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>GlobalAveragePooling2D<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># global Average ì‚¬ìš©</span>\n\nfeature_batch_average <span class=\"token operator\">=</span> global_average_layer<span class=\"token punctuation\">(</span>feature_batch<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#ë§Œë“  glo aver ë¥¼ ì´ì–´ ë¶™ì´ê¸°</span>\n\ndense_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">512</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'relu'</span><span class=\"token punctuation\">)</span>\nprediction_layer <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>layers<span class=\"token punctuation\">.</span>Dense<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> activation<span class=\"token operator\">=</span><span class=\"token string\">'softmax'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># feature_batch_averagê°€ dense_layerë¥¼ ê±°ì¹œ ê²°ê³¼ê°€ ë‹¤ì‹œ prediction_layerë¥¼ ê±°ì¹˜ê²Œ ë˜ë©´</span>\nprediction_batch <span class=\"token operator\">=</span> prediction_layer<span class=\"token punctuation\">(</span>dense_layer<span class=\"token punctuation\">(</span>feature_batch_average<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>  \n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>prediction_batch<span class=\"token punctuation\">.</span>shape<span class=\"token punctuation\">)</span>\n<span class=\"token comment\"># ì‚¬ìš©</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">(32, 2)</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">base_model<span class=\"token punctuation\">.</span>trainable <span class=\"token operator\">=</span> <span class=\"token boolean\">False</span>\n\nmodel <span class=\"token operator\">=</span> tf<span class=\"token punctuation\">.</span>keras<span class=\"token punctuation\">.</span>Sequential<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  base_model<span class=\"token punctuation\">,</span>\n  global_average_layer<span class=\"token punctuation\">,</span>\n  dense_layer<span class=\"token punctuation\">,</span>\n  prediction_layer\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>ì´ê²Œ ìµœì¢… ëª¨ë¸ì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">model<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Model: \"sequential\"\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nvgg16 (Functional)           (None, 5, 5, 512)         14714688  \n_________________________________________________________________\nglobal_average_pooling2d (Gl (None, 512)               0         \n_________________________________________________________________\ndense (Dense)                (None, 512)               262656    \n_________________________________________________________________\ndense_1 (Dense)              (None, 2)                 1026      \n=================================================================\nTotal params: 14,978,370\nTrainable params: 263,682\nNon-trainable params: 14,714,688\n_________________________________________________________________</code></pre></div>\n<p>VGG16 ëª¨ë¸ ë°‘ìœ¼ë¡œ Flatten(Global_average), Dense ë ˆì´ì–´ 2ê°œê°€<br>\në“¤ì–´ê°”ë‹¤.</p>\n<p>ëª¨ë¸ì˜ ì‚¬ìš©ì€ ë‹¤ìŒ ê²Œì‹œê¸€ì— ì´ì–´ì„œ ì“°ë„ë¡ í•œë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%AA%A9%EC%B0%A8\">ëª©ì°¨</a></p>\n<ul>\n<li><a href=\"#vgg-16-%EB%B6%88%EB%9F%AC%EC%98%A4%EA%B8%B0\">VGG 16 ë¶ˆëŸ¬ì˜¤ê¸°</a></li>\n<li><a href=\"#vgg-16-%EA%B0%9C%EC%84%A0\">VGG-16 ê°œì„ </a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"></code></pre></div>","frontmatter":{"date":"April 21, 2022","title":"VGG16","categories":"beginner","author":"í•˜ì„±ë¯¼","emoji":"ğŸ˜"},"fields":{"slug":"/DML_AI2/"}},"site":{"siteMetadata":{"siteUrl":"https://xman227.github.io","comments":{"utterances":{"repo":"xman227/blog_comments"}}}}},"pageContext":{"slug":"/DML_AI1/","nextSlug":"/NLP_4/","prevSlug":"/DML_AI2/"}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}